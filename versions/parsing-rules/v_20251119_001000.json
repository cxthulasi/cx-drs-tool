{
  "version_id": "v_20251119_001000",
  "timestamp": "2025-11-19T00:10:00.990118",
  "service": "parsing-rules",
  "version_type": "pre_migration",
  "teama": {
    "count": 29,
    "resources": [
      {
        "id": "e737f5e8-0a1c-11ec-a5ad-0616c20b31c7",
        "name": "Quota",
        "description": "",
        "creator": "",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [],
        "order": 1
      },
      {
        "id": "112d9369-8f75-49fc-94c5-da61ff8a506e",
        "name": "k8s Opentelemetry parsing",
        "description": "k8s Opentelemetry extension pack",
        "creator": "k8s Opentelemetry extension pack",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "8ba370e3-03d9-4528-bea7-134ae386e01e",
            "rules": [
              {
                "id": "ed13cf5a-b549-4c9b-b4fe-74fe3a608da3",
                "name": "Stringify logRecord",
                "description": "",
                "sourceField": "text.logRecord",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.logRecord_tmp",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "8749660b-00c1-458d-8dfb-7eeb303e1db7",
            "rules": [
              {
                "id": "eb9196fa-8f19-42f5-8e53-f1ba75eb4e41",
                "name": "Parse json logRecord_tmp",
                "description": "",
                "sourceField": "text.logRecord_tmp",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "51402b0b-61b2-4d77-a6c4-476db8170369",
            "rules": [
              {
                "id": "fd17caf7-4b44-4e55-acef-538d8b30ebea",
                "name": "Parse json body",
                "description": "",
                "sourceField": "text.body",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "915720b2-1fde-49f8-a072-7f736c892373",
            "rules": [
              {
                "id": "7fd42cfb-4a19-4977-89b5-fd6c5e0030f1",
                "name": "map deprecatedLastTimestamp, eventTime as datetime fields",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"${1}_custom_timestamp\":\"",
                    "rule": "\"(deprecatedLastTimestamp|eventTime)\":\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 4
          },
          {
            "id": "02101fa9-050f-4a2c-b1d7-25b40cabc47b",
            "rules": [
              {
                "id": "5cc1ee04-89ca-4379-9d67-9614e37a4752",
                "name": "fix mapping exception for infra collector empty f:annotations",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "${1}\"f:workflow\":{",
                    "rule": "(\"f:annotations\":\\{.*?)\"\\.\":\\{"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 5
          },
          {
            "id": "52189e89-523e-4c24-bebc-24f27e743dd6",
            "rules": [
              {
                "id": "8fdc45c7-fcd2-4fdf-b29f-73ab7198ded6",
                "name": "Parse common logs from k8s containers",
                "description": "This rule parses containers: kube-apiserver, kube-controller-manager, kube-proxy, kube-scheduler, storage-provisioner.",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"message\":\"$message\"",
                    "rule": "\"body\":\"(?P<level>[A-Z])(?P<timestamp>\\d{4} \\d{2}:\\d{2}:\\d{2}\\.\\d+)\\s*1 (?P<caller>[^\\]]+)\\] (?P<message>(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "e2925d4e-cd35-459f-8328-12707cb87347",
                "name": "Replace body with kvPairs when body is a kv pairs message starts with time",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"kvPairs\":\"${1}\"",
                    "rule": "\"body\":\"(time=\\\\\"(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 2
              },
              {
                "id": "d3256c21-d934-44a5-bc02-b57853dd2777",
                "name": "Replace body with kvPairs when body is a kv pairs message starts with ts",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"kvPairs\":\"${1}\"",
                    "rule": "\"body\":\"(ts=\\d{4}(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 3
              },
              {
                "id": "6ff41fc9-31c8-46ea-a5e7-07df165f3698",
                "name": "Replace body with kvPairs when body is a kv pairs message starts with level",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"kvPairs\":\"${1}\"",
                    "rule": "\"body\":\"(level=(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 4
              }
            ],
            "enabled": true,
            "order": 6
          },
          {
            "id": "2761a409-7094-40ab-8d29-d9a761c81fd5",
            "rules": [
              {
                "id": "98229397-5786-4df1-8deb-69292906f8bf",
                "name": "Extract msg from kvPairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "extractParameters": {
                    "rule": "msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 7
          },
          {
            "id": "4e2691aa-4e52-45da-b864-884823eb001e",
            "rules": [
              {
                "id": "1d11794c-a644-41ee-ac28-fab1d042c391",
                "name": "Remove msg from kvPairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\s+msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 8
          },
          {
            "id": "1664839f-9700-4ff6-81e4-ac466928ec5b",
            "rules": [
              {
                "id": "aa7423ee-a171-4351-9c94-dfb6ce0b4453",
                "name": "Extract query from kvPairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "extractParameters": {
                    "rule": "query=\\\\\"(?P<query>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "94e20021-2d1f-4cf4-ad9b-556db1e0bc2a",
                "name": "Extract query from kvPairs when kvPairs also had msg in it along with query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "extractParameters": {
                    "rule": "query=\\\\\\\\\\\\\"(?P<query>(?:\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                  }
                },
                "enabled": true,
                "order": 2
              }
            ],
            "enabled": true,
            "order": 9
          },
          {
            "id": "b25a40d6-eede-4ba9-875c-aafb823e772d",
            "rules": [
              {
                "id": "f98aaca8-1a4e-417d-9668-90b52d20ec1e",
                "name": "remove query from kvPairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\s+query=\\\\\"(?P<query>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "7c6cd3f2-0038-4a99-bc3e-7d7a1701dad7",
                "name": "remove query from kvPairs when kvPairs also had msg in it along with query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\s+query=\\\\\\\\\\\\\"(?P<query>(?:\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                  }
                },
                "enabled": true,
                "order": 2
              }
            ],
            "enabled": true,
            "order": 10
          },
          {
            "id": "33e71d9d-6544-41c5-8ea5-15fa8d97c69b",
            "rules": [
              {
                "id": "b6e4020a-4627-4663-bddb-665c13ef8e8c",
                "name": "prepare all the rest of the fields in a kvPairs field that had both msg and query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                    "rule": "([\\w\\.\\-\\_]+)=\\\\{7}\"((?:\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\+\"|[^\"])+)\\\\{7}\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "222c2bd6-d019-479f-bd7f-163027a9b8bb",
                "name": "prepare all the rest of the fields in a kvPairs field that had either msg or query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                    "rule": "([\\w\\.\\-\\_]+)=\\\\{3}\"((?:\\\\\\\\\\\\\\\\+\"|[^\"])+)\\\\{3}\""
                  }
                },
                "enabled": true,
                "order": 2
              }
            ],
            "enabled": true,
            "order": 11
          },
          {
            "id": "c97a1d2d-b9dd-4fcc-bd04-92ddd037cbbf",
            "rules": [
              {
                "id": "874ce9cc-bf25-4858-a386-cf27baeb5f0e",
                "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had both msg and query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\\\{15,}\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "52fd8152-efd0-44f7-900c-a447c493fc77",
                "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had either msg or query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\\\{7,}\""
                  }
                },
                "enabled": true,
                "order": 2
              },
              {
                "id": "bf76fb29-2e1f-42c0-93a1-d11fadfd702f",
                "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had no msg or query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\\\{3,}\""
                  }
                },
                "enabled": true,
                "order": 3
              }
            ],
            "enabled": true,
            "order": 12
          },
          {
            "id": "59691c94-e052-47c2-b716-33dcb89f55fe",
            "rules": [
              {
                "id": "35ec5934-1870-43a6-89e6-9c51d63cdf1b",
                "name": "Replace all remaining occurrences of double quotes with their corresponding backslash with \u00a7",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7",
                    "rule": "\\\\+\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 13
          },
          {
            "id": "651ff79a-64e8-4680-a916-be00129df0ec",
            "rules": [
              {
                "id": "e2c089e0-c81e-4abf-a146-5c690fe9aa20",
                "name": "wrap the keys of the key/val pairs with \u00a7 wrapping the value with \u00a7",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                    "rule": "([\\w\\.\\-]+)=\\xA7([^\\xA7]*)\\xA7"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 14
          },
          {
            "id": "50c1fa6d-a687-445e-9b63-9ff52b52ede2",
            "rules": [
              {
                "id": "763305ae-52a7-46ec-866e-d732e2cc7e45",
                "name": "Adding to the rest of key/val pairs \u00a7 before and after the keys and values",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                    "rule": "([\\w\\.\\-\\_]+)=((?:$|[^ ])*)(?: |$)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 15
          },
          {
            "id": "853d63be-2de7-4cad-b127-5d5b6fc61a6a",
            "rules": [
              {
                "id": "f9a8c026-2b0a-4bb1-8a79-9a7ceb62f524",
                "name": "Adding commas between key/val pairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "${1}:${2},",
                    "rule": "(\\xA7[^\\xA7]*\\xA7):(\\xA7[^\\xA7]*\\xA7)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 16
          },
          {
            "id": "50f4b0f0-e05c-44ff-aee5-5c9a94e37beb",
            "rules": [
              {
                "id": "403e0f23-1013-41b7-89a6-124c18912fc6",
                "name": "Remove last comma before jsonizing kvPairs field",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "{$1}",
                    "rule": "(.*),"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 17
          },
          {
            "id": "17236cfa-4e51-4fc8-a3a3-6092eb94a3b0",
            "rules": [
              {
                "id": "54eb86a6-56a3-40c8-899c-6a0d3f4a7b41",
                "name": "Replacing \u00a7 with \" to jsonize kvPairs in order to get a valid JSON",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\"",
                    "rule": "\\xA7"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 18
          },
          {
            "id": "6bba4176-892d-42ad-83bd-25dea268cf2a",
            "rules": [
              {
                "id": "4625b97a-929f-4225-a0e6-77f00f44fdbf",
                "name": "reformat kvPairs field back to an escaped JSON string format",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.kvPairs_tmp",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 19
          },
          {
            "id": "0d5e18b1-a0b1-492f-8130-b05d73a7fb4e",
            "rules": [
              {
                "id": "b8a83da7-11c7-46fa-8650-c92220c0393b",
                "name": "Parse kvPairs_tmp as JSON to root",
                "description": "",
                "sourceField": "text.kvPairs_tmp",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 20
          }
        ],
        "order": 1
      },
      {
        "id": "12d0fb20-4438-49b6-9a9e-899118e5c265",
        "name": "Db Snapshot Made Public (Security)",
        "description": "",
        "creator": "AWS-Application",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "4f532743-e80a-477d-bbab-1d4633342140",
            "rules": [
              {
                "id": "63f70a7f-82ae-433a-b104-79e0811112b0",
                "name": "DB snapshot made public ",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"db_snapshot_made_public\":\"true\"$1",
                    "rule": "\"dBSnapshotAttributes\"\\s*:\\s*\\[\\s*\\{\\s*\"attributeName\"\\s*:\\s*\"restore\"\\s*,\\s*\"attributeValues\"\\s*:\\s*\\[\\s*\"all\"\\s*\\]\\s*\\}\\s*\\]"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 2
      },
      {
        "id": "96d7435f-5f5b-4bd7-9013-b0e83d310f8d",
        "name": "Data Normalization - GitHub (Security)",
        "description": "",
        "creator": "GitHub",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "b508a6cf-6f64-486e-8ae3-315d133742ad",
            "rules": [
              {
                "id": "27bef87f-7266-4da8-9856-ab30693f6219",
                "name": "Event Name",
                "description": "",
                "sourceField": "text.github.action",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<event_name>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "aad4fbde-b198-40e7-8363-8aeb8baabeb8",
            "rules": [
              {
                "id": "431f0754-cba7-469e-9a30-4a58d1948183",
                "name": "User Name",
                "description": "",
                "sourceField": "text.github.sender.login",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<username>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "40c57f75-7d62-4c7b-98d2-8b5b803d281a",
            "rules": [
              {
                "id": "8680fb42-19c9-45d8-8988-18e324657dba",
                "name": "Source",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$1\"source\":\"GitHub\",\"service\":\"GitHub\",$2",
                    "rule": "(.*\"cx_security\":{)(.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          }
        ],
        "order": 3
      },
      {
        "id": "c25a06b5-aba4-4989-9aa4-a49ca242027f",
        "name": "AWS CloudTrail - max fields - stringifying fields (Security)",
        "description": "",
        "creator": "AWS CloudTrail - Security Extension",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "99d20420-8bdc-4a4d-a7f6-cb9c8cfb62a5",
            "rules": [
              {
                "id": "0d200315-1def-4a45-8e26-bfda99e9e4ae",
                "name": "tlsDetails",
                "description": "",
                "sourceField": "text.tlsDetails",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.tlsDetails_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "82ecbf91-29b1-4603-9af6-4d2c7fed2456",
            "rules": [
              {
                "id": "16d13068-1d34-44fb-9018-226ea39a1aa6",
                "name": "resources",
                "description": "",
                "sourceField": "text.resources",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.resources_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "863247cf-62cf-4078-9655-18af6400f220",
            "rules": [
              {
                "id": "fce941cd-c93f-4e11-9750-a3a3b938d294",
                "name": "requestParameters.actions",
                "description": "",
                "sourceField": "text.requestParameters.actions",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.requestParameters.actions_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "2520434e-3397-4481-b49d-6a5d4b80ff17",
            "rules": [
              {
                "id": "41738478-e7d9-477c-9821-da0f4c45366e",
                "name": "requestParameters.conditions",
                "description": "",
                "sourceField": "text.requestParameters.conditions",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.requestParameters.conditions_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 4
          },
          {
            "id": "7df0e9ed-cec0-44c8-aee5-c1c07cb18930",
            "rules": [
              {
                "id": "c2f6e1ca-abe8-4b02-aa64-87eac920eaf6",
                "name": "requestParameters.ipPermissions.items",
                "description": "",
                "sourceField": "text.requestParameters.ipPermissions.items",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.requestParameters.ipPermissions.items_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 5
          },
          {
            "id": "07edb0fb-130c-43e2-a1e3-39f040b1a890",
            "rules": [
              {
                "id": "a522b4f1-9ee6-40dc-becf-e0561a45b391",
                "name": "requestParameters.tags",
                "description": "",
                "sourceField": "text.requestParameters.tags",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.requestParameters.tags_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 6
          },
          {
            "id": "2edf4d4d-981c-43fd-8a0f-11ec824b88cd",
            "rules": [
              {
                "id": "397674ee-7c3e-4326-a9fc-a391ecb13af2",
                "name": "responseElements.policy.tags",
                "description": "",
                "sourceField": "text.responseElements.policy.tags",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.responseElements.policy.tags_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 7
          },
          {
            "id": "4cf263e3-4b85-4073-889b-77d0a79f3d29",
            "rules": [
              {
                "id": "3d5e0fe9-79cd-4f51-b549-5c343c5918aa",
                "name": "responseElements.loadBalancers",
                "description": "",
                "sourceField": "text.responseElements.loadBalancers",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.responseElements.loadBalancers_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 8
          },
          {
            "id": "ef599fa3-0d3b-4e53-aba6-f79d5fd797c0",
            "rules": [
              {
                "id": "a7535151-d2a0-4715-9070-1296e81f3be2",
                "name": "responseElements.rules",
                "description": "",
                "sourceField": "text.responseElements.rules",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.responseElements.rules_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 9
          },
          {
            "id": "aad9936d-493b-4551-88dc-ca7226d433c1",
            "rules": [
              {
                "id": "83b1c2f7-7c56-4795-95b0-1b0afb5d67b3",
                "name": "responseElements.instancesSet.items",
                "description": "",
                "sourceField": "text.responseElements.instancesSet.items",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.responseElements.instancesSet.items_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 10
          },
          {
            "id": "b2bf8220-fde7-4d82-a2a3-85b650478014",
            "rules": [
              {
                "id": "6c776a9e-24aa-4569-90b7-1ac209124d20",
                "name": "responseObject.metadata.managedFields",
                "description": "",
                "sourceField": "text.responseObject.metadata.managedFields",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.responseObject.metadata.managedFields_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 11
          }
        ],
        "order": 4
      },
      {
        "id": "ede3219e-3764-4283-9934-ada6c6c82a9a",
        "name": "Data Normalization - GuardDuty (Security)",
        "description": "",
        "creator": "STAa",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "074157727657"
            }
          },
          {
            "subsystemName": {
              "value": "adservice"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "c488f160-3579-4258-8ab7-d935e4d2ab33",
            "rules": [
              {
                "id": "db4b87db-e26a-4e21-945d-a53a3bd41ac1",
                "name": "Event Name",
                "description": "",
                "sourceField": "text.detail.type",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<event_name>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "cc35257d-38f4-4520-9d69-01b4c9e4774f",
            "rules": [
              {
                "id": "6c74d80d-361f-492b-b312-ef7851da5d6e",
                "name": "Resource",
                "description": "",
                "sourceField": "text.detail.resource.instancedetails.instanceid",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<resource>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "b751dae2-be22-493f-b86b-78e7704f1a4d",
            "rules": [
              {
                "id": "b5354c15-7a0f-424e-be83-371b006ab2f3",
                "name": "Source Host Name",
                "description": "",
                "sourceField": "text.detail.resource.instanceDetails.networkInterfaces.privateDnsName",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<source_hostname>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "b059fc4f-a268-43a7-85df-4af5365ab7bd",
            "rules": [
              {
                "id": "42ee988c-75ca-444d-b644-b00bcc26fa0a",
                "name": "Source IP",
                "description": "",
                "sourceField": "text.detail.resource.instanceDetails.networkInterfaces.privateIpAddress",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<source_ip>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 4
          },
          {
            "id": "138de725-26ae-4492-8f0f-657b2ed2077d",
            "rules": [
              {
                "id": "6bc9d70b-8f90-4a2f-b440-e1d87c9f12cc",
                "name": "Source",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$1\"source\":\"AWS\",\"service\":\"GuardDuty\",$2",
                    "rule": "(.*\"cx_security\":{)(.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 5
          }
        ],
        "order": 5
      },
      {
        "id": "d49d2a27-ea33-48ac-806d-ba39da9638ca",
        "name": "Data Normalization - CrowdStrike (Security).",
        "description": ".",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "app-demo"
            }
          },
          {
            "subsystemName": {
              "value": "audit-logs"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "9cc496eb-29aa-4fc1-b126-6c56077db465",
            "rules": [
              {
                "id": "5a1ac00a-1b7a-4d79-b3a5-ac85d0ddf8f6",
                "name": "Email",
                "description": "",
                "sourceField": "text.event.UserId",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<email>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "e78fa05a-2b6e-41a4-b2d0-12e9e8e81a47",
            "rules": [
              {
                "id": "a285eef0-42ef-4356-9dc5-9ef1068ec5d3",
                "name": "Event Name",
                "description": "",
                "sourceField": "text.metadata.eventType",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<event_name>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "16b6c655-56bd-4176-9d80-5006a9ff274d",
            "rules": [
              {
                "id": "56cec434-51ae-4ad7-91bd-4ed3ed5f2261",
                "name": "Source IP",
                "description": "",
                "sourceField": "text.event.UserIp",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<source_ip>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "c71ce267-4d47-41e2-a660-b7b4002d3c4f",
            "rules": [
              {
                "id": "ca205c89-1e91-4a8f-ace8-d84e76e3e28e",
                "name": "Source",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$1\"source\":\"CrowdStrike\",\"service\":\"CrowdStrike\",$2",
                    "rule": "(.*\"cx_security\":{)(.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 4
          }
        ],
        "order": 6
      },
      {
        "id": "df952abe-a3bf-4edb-80b4-912cdc4717ca",
        "name": "AWS CloudTrail - AMI Made Public (Security)",
        "description": "",
        "creator": "AWS-Application",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "fd1f84e5-5e23-4733-973b-0a664b535431",
            "rules": [
              {
                "id": "94755877-ab19-44e2-b1bb-964d48f0a816",
                "name": "Array converter",
                "description": "creates a new object called \"group_all\" with the value of \"true\" when exists to be detected by the corresponding alert",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"ami_made_public\":\"true\"$1",
                    "rule": "\"launchPermission\"\\s*:\\s*\\{\\s*\"add\"\\s*:\\s*\\{\\s*\"items\"\\s*:\\s*\\[\\s*\\{\\s*\"group\"\\s*:\\s*\"all\"\\s*\\}\\s*\\]\\s*\\}\\s*\\}"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 7
      },
      {
        "id": "f21d9032-3f5c-47bb-a203-a4acb0689402",
        "name": "Data Normalization - CloudTrail (Security)",
        "description": "",
        "creator": "CloudTrail",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "73859a57-623b-48cc-9982-3c234b62ef9a",
            "rules": [
              {
                "id": "f54cb950-27f6-4842-9b35-c31780e51792",
                "name": "Event Name",
                "description": "",
                "sourceField": "text.eventName",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<event_name>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "eeb3b6bf-4f18-4e4a-a90d-3f2b6ac5a32b",
            "rules": [
              {
                "id": "a4a43e9d-d7bb-4b7f-a7dc-345ea1a5655b",
                "name": "Resource",
                "description": "",
                "sourceField": "text.userIdentity.sessionContext.sessionIssuer.arn",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<resource>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "b28cdca3-256f-4c49-9b3a-0555bf70b6ff",
            "rules": [
              {
                "id": "a6832939-6309-42d6-9ed4-4613e334a327",
                "name": "Source IP",
                "description": "",
                "sourceField": "text.sourceIPAddress",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<source_ip>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "0d957598-2693-4dac-b0df-165b2f261332",
            "rules": [
              {
                "id": "f09619a3-73db-4662-939a-c0d5f3515cd2",
                "name": "User Name",
                "description": "",
                "sourceField": "text.userIdentity.sessionContext.sessionIssuer.userName",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<username>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 4
          },
          {
            "id": "6de51c90-927a-494d-9114-8256d635dd15",
            "rules": [
              {
                "id": "a766f7dd-09e2-4565-9e26-856eb11c42f2",
                "name": "Source",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$1\"source\":\"AWS\",\"service\":\"CloudTrail\",$2",
                    "rule": "(.*\"cx_security\":{)(.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 5
          }
        ],
        "order": 8
      },
      {
        "id": "30a59227-6d4a-4962-be76-3041d86f4b14",
        "name": "k8s Opentelemetry parsing",
        "description": "k8s Opentelemetry extension pack",
        "creator": "jasvinder.atwal@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "8b5dbb23-40c8-4ef9-b54f-903e719663a6",
            "rules": [
              {
                "id": "b69b9e71-1100-4c5e-8cca-9d4073221e98",
                "name": "Stringify logRecord",
                "description": "",
                "sourceField": "text.logRecord",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.logRecord_tmp",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "1256bc5f-9fe0-4b18-b353-d28252ffd1c7",
            "rules": [
              {
                "id": "add7d383-4c18-4c6a-8723-29d4b78e1b5f",
                "name": "Parse json logRecord_tmp",
                "description": "",
                "sourceField": "text.logRecord_tmp",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "889d2aac-064b-43d1-b30c-ffdabf48e21b",
            "rules": [
              {
                "id": "e6c97fc3-697a-4814-9d69-1d6d059c13e9",
                "name": "Stringify body",
                "description": "",
                "sourceField": "text.body",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.body_tmp",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "af6193b7-9103-4626-896c-3175c6da7b66",
            "rules": [
              {
                "id": "9f174f1a-b49c-4b7a-8a6a-3c4c7f5b89a9",
                "name": "Parse json body",
                "description": "",
                "sourceField": "text.body",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "9a858fd1-adc9-4340-8a28-d8e0a904ea7b",
                "name": "Parse json body_tmp",
                "description": "",
                "sourceField": "text.body_tmp",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 2
              }
            ],
            "enabled": true,
            "order": 4
          },
          {
            "id": "b12d269e-add8-46e3-835f-f1e5f943c3cc",
            "rules": [
              {
                "id": "98d45a60-1459-49e0-af86-3646e43e4c38",
                "name": "Replacing all dots within field names with underscores",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"${1}_${2}_${3}_${4}_${5}_${6}_${7}_${8}_${9}_${10}\":",
                    "rule": "\"([a-zA-Z\\d\\_]+)\\.([a-zA-Z\\d\\_]+)(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?\":"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 5
          },
          {
            "id": "c22d753e-b811-4f5c-bff5-c5cf9b7afa56",
            "rules": [
              {
                "id": "88aa70a8-6b22-48b4-a3b6-c5da771c53bd",
                "name": "Remove trailing underscores",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"$1\":",
                    "rule": "\"([^\"]+?)\\_+\":"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 6
          },
          {
            "id": "4c9543c0-f8e1-4057-90b1-83394771d426",
            "rules": [
              {
                "id": "604e8a4c-e751-4893-a168-e5e3a1810082",
                "name": "map deprecatedLastTimestamp, eventTime as datetime fields",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"${1}_custom_timestamp\":\"",
                    "rule": "\"(deprecatedLastTimestamp|eventTime)\":\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 7
          },
          {
            "id": "3b2cbe2d-a123-4260-96ea-105f88f4bb25",
            "rules": [
              {
                "id": "c7522f03-5793-4216-8cbd-2540302822bc",
                "name": "fix mapping exception for infra collector empty f:annotations",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "${1}\"f:workflow\":{",
                    "rule": "(\"f:annotations\":\\{.*?)\"\\.\":\\{"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 8
          },
          {
            "id": "04dedcdb-252a-4ae9-adc2-e44e13d777ce",
            "rules": [
              {
                "id": "727f329e-0418-4d83-92f8-b5f2734e11f6",
                "name": "Parse common logs from k8s containers",
                "description": "This rule parses containers: kube-apiserver, kube-controller-manager, kube-proxy, kube-scheduler, storage-provisioner.",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"message\":\"$message\"",
                    "rule": "\"body\":\"(?P<level>[A-Z])(?P<timestamp>\\d{4} \\d{2}:\\d{2}:\\d{2}\\.\\d+)\\s*1 (?P<caller>[^\\]]+)\\] (?P<message>(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "afddb2bc-6575-4c3e-822c-98f4358715a0",
                "name": "Replace body with kvPairs when body is a kv pairs message starts with time",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"kvPairs\":\"${1}\"",
                    "rule": "\"body\":\"(time=\\\\\"(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 2
              },
              {
                "id": "2fea813e-4122-4b51-993c-ee7b58eb331e",
                "name": "Replace body with kvPairs when body is a kv pairs message starts with ts",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"kvPairs\":\"${1}\"",
                    "rule": "\"body\":\"(ts=\\d{4}(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 3
              }
            ],
            "enabled": true,
            "order": 9
          },
          {
            "id": "c69adcef-4544-4af5-8460-9a3f76e977cf",
            "rules": [
              {
                "id": "110a3491-0db4-42f3-915f-8140cf7f51d5",
                "name": "Extract msg from kvPairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "extractParameters": {
                    "rule": "msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 10
          },
          {
            "id": "1649e50d-205e-4068-b8c6-bd7327dda4de",
            "rules": [
              {
                "id": "3ae5b2ce-28e9-4791-924e-fdf765d42313",
                "name": "Remove msg from kvPairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\smsg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 11
          },
          {
            "id": "a1011136-e362-4d2d-9a9a-1125b8ae9556",
            "rules": [
              {
                "id": "e107e61b-4c1d-4f7c-948c-5176c2fa06d1",
                "name": "Jsonizing key/vals when val is enclosed with double quotes",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7$1\u00a7:\u00a7$2\u00a7,",
                    "rule": "([\\w\\.\\-]+)=\\\\\\\\\\\\\"((?:\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 12
          },
          {
            "id": "fddd735b-078d-45fb-9d9f-35df296645a1",
            "rules": [
              {
                "id": "819b2829-bf83-4153-9339-cd8cbb538238",
                "name": "Remove any remaining backslashes followed by double quotes",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\\\+\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 13
          },
          {
            "id": "8c2baded-8910-429f-9d13-fb75dd4837ed",
            "rules": [
              {
                "id": "67a3e305-df9b-44bc-a944-d7b3eb437e25",
                "name": "Jsonizing rest of key/vals",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7$1\u00a7:\u00a7$2\u00a7,",
                    "rule": "([\\w\\.\\-]+)=((?:$|[^ \\xA7])+)?(?: |$)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 14
          },
          {
            "id": "ef20ff44-7f1e-410e-bef6-dd89814d6141",
            "rules": [
              {
                "id": "d1d508c2-2a9c-40a1-95a9-69eca1adf512",
                "name": "Removing last Comma and wrapping with curly brackets",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "{$1}",
                    "rule": "(.*),"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 15
          },
          {
            "id": "1d4a1685-ee80-47fd-b575-3219daaf1b99",
            "rules": [
              {
                "id": "f61115f6-e2ab-4ce3-becf-9fdb3421afdf",
                "name": "Replacing \u00a7 with double quotes in order to get a valid JSON",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\"",
                    "rule": "\\xA7"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 16
          },
          {
            "id": "299d6429-0f7b-4d43-8686-c1dc3d9df1a5",
            "rules": [
              {
                "id": "de4af91d-2003-4d0c-bb0d-de6711f567ea",
                "name": "reformat kvPairs field back to an escaped JSON string format",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.kvPairs_tmp",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 17
          },
          {
            "id": "b829f277-5934-4888-ae7a-73251e3b4a86",
            "rules": [
              {
                "id": "bd396c66-86f7-4b17-8edc-4081d162d3ee",
                "name": "Parse kvPairs_tmp as JSON to root",
                "description": "",
                "sourceField": "text.kvPairs_tmp",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 18
          },
          {
            "id": "bca4d42c-f6ec-41c3-8e3e-43e52714696a",
            "rules": [
              {
                "id": "d3c22c6e-82cf-494a-b49d-2e020c5ad629",
                "name": "Extract json.trace_id ",
                "description": "{\"observedTimeUnixNano\":1744818871177174088,\"resource\":{\"attributes\":{\"k8s_pod_name\":\"frontend-69d989d8dd-tnwxc\",\"k8s_container_restart_count\":\"0\",\"k8s_pod_uid\":\"4fea94df-ac83-45af-ac5d-078a76365c38\",\"k8s_container_name\":\"server\",\"k8s_namespace_name\":\"default\",\"k8s_cluster_name\":\"onlineboutique\",\"cx_otel_integration_name\":\"coralogix-integration-helm\",\"k8s_deployment_name\":\"frontend\",\"k8s_node_name\":\"ip-172-31-14-14.us-east-2.compute.internal\",\"host_name\":\"ip-172-31-14-14.us-east-2.compute.internal\",\"os_type\":\"linux\",\"host_id\":\"i-09f3a61cd39f3ae71\",\"cloud_provider\":\"aws\",\"cloud_platform\":\"aws_ec2\",\"cloud_region\":\"us-east-2\",\"cloud_account_id\":\"074157727657\",\"cloud_availability_zone\":\"us-east-2a\",\"host_image_id\":\"ami-02b2ce7c83227ce13\",\"host_type\":\"t3.large\"}},\"timeUnixNano\":1744818871043095596,\"scope\":{\"attributes\":{}},\"resourceSchemaUrl\":\"https:\\/\\/opentelemetry.io\\/schemas\\/1.6.1\",\"json\":{\"http_req_ip_geoip\":{\"ip\":\"158.46.145.28\",\"ip_ipaddr\":\"158.46.145.28\",\"location_geopoint\":{\"lat\":52.2299,\"lon\":21.0093},\"continent_name\":\"Europe\",\"country_name\":\"Poland\",\"city_name\":\"Warsaw\",\"postal_code\":\"00-510\",\"is_local\":false,\"asn\":{\"number\":\"59729\",\"organization\":\"Green Floid LLC\"}},\"http_req_id\":\"713a8831-2aec-4670-8fb9-7bae628307b8\",\"http_req_ip\":\"158.46.145.28\",\"http_req_method\":\"GET\",\"http_req_path\":\"\\/cart\",\"session\":\"a1548467-f87d-499e-b1cf-78829da93a54\",\"severity\":\"debug\",\"span_id\":\"3e67b3e9962fcd8c\",\"timestamp\":\"2025-04-16T15:54:31.042989207Z\",\"trace_id\":\"4cd3da495f7e8399a941900b950b7bd9\"},\"attributes\":{\"log_file_path\":\"\\/var\\/log\\/pods\\/default_frontend-69d989d8dd-tnwxc_4fea94df-ac83-45af-ac5d-078a76365c38\\/server\\/0.log\",\"log_iostream\":\"stdout\",\"logtag\":\"F\",\"time\":\"2025-04-16T15:54:31.043095596Z\"}}",
                "sourceField": "text",
                "parameters": {
                  "extractParameters": {
                    "rule": "\"json\":\\{.*?\"trace_id\":\"(?P<trace_id>[^\"]+)\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 19
          }
        ],
        "order": 9
      },
      {
        "id": "39c7081f-806b-6849-4e01-c498a9dd2066",
        "name": "AWS status rules",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "subsystemName": {
              "value": "aws-status"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "5c7dd15c-009b-720b-df01-abfbb9a24832",
            "rules": [
              {
                "id": "49c0aff0-2215-8f10-ab5c-0a64c0610044",
                "name": "Replace \"resolved\" messages level to INFO",
                "description": "",
                "sourceField": "text.aws.title",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "severity",
                    "replaceNewVal": "INFO",
                    "rule": "RESOLVED"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 10
      },
      {
        "id": "67ab4a0f-ba0b-45a1-9b69-5d355a0b9e48",
        "name": "Cloudtrail rules",
        "description": "Cloudtrail extension pack",
        "creator": "Cloudtrail extension pack",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "ffa60132-5e4d-4c12-ac79-c2e3232bc3d8",
            "rules": [
              {
                "id": "9f40dfa4-da6d-4f9d-b22d-6b0f94a525f8",
                "name": "Replace Cloudtrail log severity to error if errorMessage exists",
                "description": "",
                "sourceField": "text.errorMessage",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "severity",
                    "replaceNewVal": "ERROR",
                    "rule": ".*"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 11
      },
      {
        "id": "67acd1c6-2ea2-d736-05eb-13f870ba848d",
        "name": "Replace AWS host name with host ip - For metrics correlation",
        "description": "Hey You - Adi Golan here please DO NOT DELETE this rule - Thanks! :)",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "38eb65f3-4f55-cc7c-937c-e8d3c32dc3d5",
            "rules": [
              {
                "id": "cfb3193a-caf3-0fcc-4a72-84b43493482a",
                "name": "replace host with the host ip solely",
                "description": "{\"cloud\":{\"account\":{\"id\":\"074157727657\"},\"availability_zone\":\"us-east-2a\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-0f7afac2798217d04\"},\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"region\":\"us-east-2\",\"service\":{\"name\":\"EC2\"}},\"kubernetes\":{\"container\":{\"id\":\"dd6e99a9c3900e93bf2744fc03925544481e0d8f1a8df84aa1c68f45f888de95\",\"name\":\"server\"},\"deployment\":{\"name\":\"frontend\"},\"namespace\":\"default\",\"namespace_labels\":{\"kubernetes_io/metadata_name\":\"default\"},\"namespace_uid\":\"21a7e2d9-7da6-4a74-97f7-d04a7dbbb77a\",\"node\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"labels\":{\"beta_kubernetes_io/arch\":\"amd64\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"k8s_io/cloud-provider-aws\":\"5ae15d428da2ffa3cd3bbc9149af8ce1\",\"kubernetes_io/arch\":\"amd64\",\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"kubernetes_io/os\":\"linux\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"topology_kubernetes_io/region\":\"us-east-2\",\"topology_kubernetes_io/zone\":\"us-east-2a\"},\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"uid\":\"5a512b89-9f46-416c-874e-9572c0b38ecc\"},\"pod\":{\"ip\":\"172.31.3.40\",\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"69d989d8dd\"},\"name\":\"frontend-69d989d8dd-lbnrg\",\"uid\":\"c19d2ea0-be65-4886-8b4d-df814c967f0b\"},\"replicaset\":{\"name\":\"frontend-69d989d8dd\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2023-08-21T20:32:47.713Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"json\":{\"http_req_ip_geoip\":{\"ip\":\"34.206.39.153\",\"ip_ipaddr\":\"34.206.39.153\",\"location_geopoint\":{\"lat\":39.0469,\"lon\":-77.4903},\"continent_name\":\"North America\",\"country_name\":\"United States\",\"city_name\":\"Ashburn\",\"postal_code\":\"20149\"},\"http_req_id\":\"92313d79-b665-47eb-a0d4-7a08c7dec302\",\"http_req_ip\":\"34.206.39.153\",\"http_req_method\":\"POST\",\"http_req_path\":\"/cart\",\"http_resp_bytes\":0,\"http_resp_status\":302,\"http_resp_took_ms\":4,\"session\":\"097733bc-6386-475e-bfbc-6ada1a96e9be\",\"severity\":\"debug\",\"span_id\":\"4cf425fb8ed181d7\",\"timestamp\":\"2023-08-21T20:32:47.713652989Z\",\"trace_id\":\"f76998ff4a582250107c6a44e35ac47f\"},\"message\":\"request POST /cart completed with status: 302. requestID: 92313d79-b665-47eb-a0d4-7a08c7dec302\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"host\":\"${1}.${2}.${3}.${4}\"",
                    "rule": "\"host\":\"ip\\-(\\d{1,3})\\-(\\d{1,3})\\-(\\d{1,3})\\-(\\d{1,3})\\.[^\"]+\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 12
      },
      {
        "id": "7217894b-bb41-ece3-ea9b-49eb52b88d91",
        "name": "PII - Mask Email addresses",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "statuspage"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "af96e560-b410-3e32-5edf-a9cc13ef523b",
            "rules": [
              {
                "id": "99c9dbfe-309b-cc00-1b8b-21effd8b8fc2",
                "name": "Mask Email addresses",
                "description": "{\"log\":\"Error on adding subscription.\",\"type\":\"we1-prd-portal-slices-product\",\"Msg_obj\":{\"Data\":{\"Arguments\":{\"SubscriptionRequest\":{\"CultureCode\":\"en-US\",\"SubscriberId\":\"test_email@gmail.com\",\"Topics\":[{\"DeliveryChannels\":[{\"Address\":\"test_email@gmail.com\",\"Platform\":\"Email\",\"Source\":\"10003_nibis_email\"}],\"Specification\":{\"CountryId\":\"165\",\"ProductId\":\"15756113\",\"Scale\":\"750\",\"Size\":\"27\"},\"TypeId\":\"BackInStock\"}]}},\"Class\":\"Farfetch.Web.Slices.Product.Infrastructure.CrossCutting.Resilience.Clients.MarketingApi.ResilientSubscriptionsClient\",\"ConnectionId\":\"0HMQQJHR59PJ8\",\"Exception\":{\"ApplicationErrors\":[{\"Code\":\"500\",\"DeveloperMessage\":\"Operation canceled\",\"Exception\":{\"InnerException\":{\"InnerException\":{\"Message\":\"Operation canceled\",\"Type\":\"SocketException\"},\"Message\":\"Unable to read data from the transport connection: Operation canceled.\",\"Source\":\"System.Net.Sockets\",\"Type\":\"IOException\"},\"Message\":\"The operation was canceled.\",\"Source\":\"System.Net.Http\",\"Type\":\"TaskCanceledException\"},\"Message\":\"The operation was canceled.\"}],\"Message\":\"ApplicationErrorException containing a TaskCanceledException was thrown with error code 500.\",\"Source\":\"Farfetch.Framework.API.Client.HttpClient\",\"StackTrace\":\"   at Farfetch.Framework.API.Client.HttpClient.HttpClientConnection.ExecuteAsync(HttpMethod method, Uri uri, Object body, HttpHeader[] headers, CancellationToken cancellationToken)\\n   at Farfetch.Framework.API.Client.HttpClient.HttpClientConnection.PostAsync[TRequestBody](ApiRequest`1 request, CancellationToken cancellationToken)\\n   at Farfetch.MktApi.Client.SDK.Implementations.SubscriptionClient.AddSubscriptionAsync(SubscriptionRequest subscription, CancellationToken cancellationToken)\\n   at Polly.AsyncPolicy.<>c__DisplayClass40_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.CircuitBreaker.AsyncCircuitBreakerPolicy.<>c__DisplayClass8_0`1.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.CircuitBreaker.AsyncCircuitBreakerEngine.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext, ExceptionPredicates shouldHandleExceptionPredicates, ResultPredicates`1 shouldHandleResultPredicates, ICircuitController`1 breakerController)\\n   at Polly.CircuitBreaker.AsyncCircuitBreakerPolicy.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.Wrap.AsyncPolicyWrapEngine.<>c__DisplayClass4_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.AsyncPolicy.<>c__DisplayClass40_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Farfetch.Framework.Resilience.Policies.CustomPolicies.Engines.AsyncOffloadEngine.ExecuteAsync[TResult](Func`3 action, Context context, ConcurrentDictionary`2 circuitBreakerEvents, Boolean continueOnCapturedContext, CancellationToken cancellationToken)\\n   at Farfetch.Framework.Resilience.Policies.CustomPolicies.AsyncOffloadPolicy.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.Wrap.AsyncPolicyWrapEngine.ImplementationAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext, IAsyncPolicy outerPolicy, IAsyncPolicy innerPolicy)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.Wrap.AsyncPolicyWrapEngine.<>c__DisplayClass4_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.AsyncPolicy.<>c__DisplayClass40_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.Timeout.AsyncTimeoutEngine.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Func`2 timeoutProvider, TimeoutStrategy timeoutStrategy, Func`5 onTimeoutAsync, Boolean continueOnCapturedContext)\\n   at Polly.Timeout.AsyncTimeoutEngine.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Func`2 timeoutProvider, TimeoutStrategy timeoutStrategy, Func`5 onTimeoutAsync, Boolean continueOnCapturedContext)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.Wrap.AsyncPolicyWrapEngine.ImplementationAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext, IAsyncPolicy outerPolicy, IAsyncPolicy innerPolicy)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Farfetch.Web.Slices.Product.Infrastructure.CrossCutting.Resilience.Clients.MarketingApi.ResilientSubscriptionsClient.AddSubscriptionAsync(SubscriptionRequest subscription, CancellationToken cancellationToken) in /source/src/Infrastructure.CrossCutting.Resilience/Clients/MarketingApi/ResilientSubscriptionsClient.cs:line 42\",\"Type\":\"ApplicationErrorException\"},\"Headers\":{\"User-Agent\":\"experience-web-gateway/1.0.23139.317\",\"X-Geo-Subfolder\":\"/pt\",\"X-History-Root-Category\":\"women\",\"X-Is-Bot\":\"false\",\"X-Known-Root-Categories\":\"\\\"{\\\\u0022beauty\\\\u0022:141257,\\\\u0022kids\\\\u0022:141260,\\\\u0022men\\\\u0022:141259,\\\\u0022women\\\\u0022:141258}\\\"\",\"X-Subfolder\":\"/pt\",\"X-Tenant-Id\":\"10000\",\"X-User-Agent\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 16_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/20E252 [FBAN/FBIOS;FBDV/iPhone14,2;FBMD/iPhone;FBSN/iOS;FBSV/16.4.1;FBSS/3;FBID/phone;FBLC/pt_PT;FBOP/5]\",\"X-User-Correlation-Id\":\"6fc3fb3e-0a08-4787-af5d-c280bad73b93\",\"x-bct\":\"168885\"},\"LogType\":\"ExternalRequest\",\"Method\":\"AddSubscriptionAsync\",\"ParentId\":\"5a554e25951d7fa3\",\"RawUrl\":\"http://portal-slices-product-we1.customer.net:9059/graphql/\",\"RequestId\":\"0HMQQJHR59PJ8:00000002\",\"RequestPath\":\"/graphql/\",\"Service\":\"marketing-core-api\",\"SpanId\":\"6a837306180d85e8\",\"TraceId\":\"000000000000000036ffd3d2d9abb486\"},\"Message\":\"Error on adding subscription.\"},\"Timestamp\":\"2023-05-22T08:52:07.3771285Z\",\"stream\":\"stdout\",\"host\":\"aks-pstdspot2-26760775-vmss0001zr\",\"@version\":\"1\",\"HostName\":\"portal-slices-product-557d947474-p2rv5\",\"EventSeverity\":\"Warning\",\"kafka_topic\":\"p2_t0_app_log\",\"datacenter\":\"we1\",\"kubernetes_pod_name\":\"portal-slices-product-557d947474-p2rv5\",\"ActId\":\"963f7019-d866-4a20-9aa2-f886616629e6\",\"Thread\":\"21\",\"kubernetes_namespace_name\":\"portal-slices\",\"kubernetes_docker_id\":\"6b9575e2857338d11a0fcfe7b684c05645d655ae2ea0a921385e82ca0a344eb4\",\"_p\":\"F\",\"@timestamp\":\"2023-05-22T08:52:07.377Z\",\"stage\":\"stable\",\"kubernetes_container_hash\":\"artifacts-we1.customer.net/docker-stable/customer/portal-slices-product@sha256:dfe52ca9c25bec6537d5f5ac2cf291c7a2b32b262e162671cc916adfb8208fa5\",\"kubernetes_pod_id\":\"4e69cb06-ac70-413a-ac68-3251dd259e2b\",\"kubernetes_container_name\":\"portal-slices-product\",\"time\":\"2023-05-22T08:52:07.377552964Z\",\"kubernetes_host\":\"aks-pstdspot2-26760775-vmss0001zr\",\"fields\":{\"boundary\":\"slices\",\"clusterName\":\"we1-prd-portal-std-1\",\"dc\":\"we1\",\"environment\":\"prd\",\"fqdn\":\"aks-pstdspot2-26760775-vmss0001zr\",\"full_name\":\"portal-slices-product\",\"minion_id\":\"aks-pstdspot2-26760775-vmss0001zr\",\"name\":\"product\",\"platform\":\"portal\",\"tags\":\"json\",\"tier\":\"0\"},\"kubernetes_container_image\":\"artifacts-we1.customer.net/docker-stable/customer/portal-slices-product:1.0.23139.489\"}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "XXXXXXXXXX@XXXXXXX",
                    "rule": "(?P<email_address>([\\d\\w\\.\\-\\_]+)@([\\d\\w]+)\\.([\\w]+))"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 13
      },
      {
        "id": "de912012-c4f8-4579-9320-c9d0d0d072ed",
        "name": "PII - Block Payment Details",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": false,
        "hidden": false,
        "ruleMatchers": [
          {
            "subsystemName": {
              "value": "paymentservice"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "3cbbda99-fbc9-4cbf-8940-3abdef6b0c24",
            "rules": [
              {
                "id": "24ab80ab-ef84-4543-ab5e-4579a9dde5f6",
                "name": "Block payment invocation log",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "blockParameters": {
                    "keepBlockedLogs": false,
                    "rule": "PaymentService#Charge invoked"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 14
      },
      {
        "id": "55b0b240-efe6-4de3-b7a4-a5efd2f1075e",
        "name": "Parse payment info",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "subsystemName": {
              "value": "paymentservice"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "9ce97be5-1313-4e28-8719-762b125d748d",
            "rules": [
              {
                "id": "c46b3810-e769-4d6a-86a4-49d3a9fd3e56",
                "name": "Parse payment info",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"pay_transaction\":{\"cc\":\"$1\",\"currency\":\"$2\",\"amount\":\"$3\"}",
                    "rule": "\"message\"\\s*:\\s*\"Transaction processed:\\s*(?P<cc>\\w+)\\s*ending\\s*\\d+\\s*Amount:\\s*(?P<currency>[A-Z]+)(?P<amount>[\\d\\.]+)\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 15
      },
      {
        "id": "84ac5e54-d8ad-8ca3-dded-b4e8bc5a2456",
        "name": "Default Subsystem - Demo - Parsing",
        "description": "Hey You - Adi Golan here please DO NOT DELETE this rule - Thanks! :)",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "default"
            }
          },
          {
            "subsystemName": {
              "value": "frontend"
            }
          },
          {
            "subsystemName": {
              "value": "checkoutservice"
            }
          },
          {
            "subsystemName": {
              "value": "recommendationservice"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "46d69314-3bc2-5282-ae83-787b1cc49f10",
            "rules": [
              {
                "id": "27750ee2-fd23-d479-5887-0ec5352dac48",
                "name": "Delete original message",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "removeFieldsParameters": {
                    "fields": [
                      "message"
                    ]
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "dbcfe950-6100-1290-3b9a-1a9637151086",
            "rules": [
              {
                "id": "fc79ee61-7376-45d4-b51c-7e5540fd1e1d",
                "name": "Extract Message from json.message",
                "description": "",
                "sourceField": "text.json.message",
                "parameters": {
                  "extractParameters": {
                    "rule": "(?P<message>.+)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "b4607872-00be-3b34-ec63-1434e0ac7566",
            "rules": [
              {
                "id": "7f476116-f28c-7c85-2cb0-8dcf4bb13b8b",
                "name": "Delete json.message",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "removeFieldsParameters": {
                    "fields": [
                      "json.message"
                    ]
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          }
        ],
        "order": 16
      },
      {
        "id": "8d7f4cd3-34ea-964d-41b3-d96b0aafc2da",
        "name": "Frontend Service Parsing Rules",
        "description": "Created by George P for Demo Flow - Please do not delete",
        "creator": "george.boddey@coralogix.com",
        "enabled": false,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "default"
            }
          },
          {
            "subsystemName": {
              "value": "frontend"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "4d847464-5416-2ba4-c6fd-05e057ba35e8",
            "rules": [
              {
                "id": "c00a0ce5-81b2-33d7-eba0-5ca219e5d0cb",
                "name": "Filter logs where JSON already exists - step 1",
                "description": "{\"product_id_enriched\":{\"product_desc\":\"This lightweight hairdryer has 3 heat and speed settings. It's perfect for travel.\",\"product_name\":\"Hairdryer\",\"price_in_currency\":\"24\",\"product_img\":\"https://www.coralogix-demo.net/static/img/products/hairdryer.jpg\",\"currency\":\"USD\",\"category\":\"hair\"},\"json\":{\"http_req_ip_geoip\":{\"ip\":\"91.214.87.74\",\"ip_ipaddr\":\"91.214.87.74\",\"location_geopoint\":{\"lat\":50.5182,\"lon\":30.8041},\"continent_name\":\"Europe\",\"country_name\":\"Ukraine\",\"city_name\":\"Brovary\",\"postal_code\":\"07400\"},\"http_req_id\":\"eb42c8a5-1a7c-4174-acac-43ba70ede542\",\"http_req_ip\":\"91.214.87.74\",\"http_req_method\":\"GET\",\"http_req_path\":\"/product\",\"http_resp_bytes\":7893,\"http_resp_status\":200,\"http_resp_took_ms\":1180,\"session\":\"141329a7-ee0e-4c36-be93-ec85aca25dce\",\"severity\":\"debug\",\"span_id\":\"2af19aadfd800015\",\"timestamp\":\"2024-01-12T11:13:46.18049654Z\",\"trace_id\":\"ffde5d9a8da0e54d776d385c97e6a114\"},\"@timestamp\":\"2024-01-12T11:13:46.180Z\",\"@version\":\"1\",\"beat\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\"},\"cloud\":{\"account\":{\"id\":\"074157727657\"},\"availability_zone\":\"us-east-2a\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-02084e96d21517df8\"},\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"region\":\"us-east-2\",\"service\":{\"name\":\"EC2\"}},\"cluster_name\":\"cluster.local\",\"host\":\"172.31.4.242\",\"kubernetes\":{\"container\":{\"id\":\"27f46be207970279dbda825cdcea0ed0ef0a724d6ed8c41f33db3b207e845a54\",\"name\":\"server\"},\"deployment\":{\"name\":\"frontend\"},\"namespace\":\"default\",\"namespace_labels\":{\"kubernetes_io/metadata_name\":\"default\"},\"namespace_uid\":\"21a7e2d9-7da6-4a74-97f7-d04a7dbbb77a\",\"node\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"labels\":{\"beta_kubernetes_io/arch\":\"amd64\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"k8s_io/cloud-provider-aws\":\"5ae15d428da2ffa3cd3bbc9149af8ce1\",\"kubernetes_io/arch\":\"amd64\",\"kubernetes_io/hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"kubernetes_io/os\":\"linux\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"topology_kubernetes_io/region\":\"us-east-2\",\"topology_kubernetes_io/zone\":\"us-east-2a\"},\"name\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"uid\":\"c027d669-c71e-443c-b6d3-6be6b5b7e1ca\"},\"pod\":{\"ip\":\"172.31.2.154\",\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"69d989d8dd\"},\"name\":\"frontend-69d989d8dd-msq9g\",\"uid\":\"b0008d6f-730a-43e3-a4f8-b35b1670980d\"},\"replicaset\":{\"name\":\"frontend-69d989d8dd\"}},\"message\":\"request GET /product/2ZYFJ3GM2N completed with status: 200. requestID: eb42c8a5-1a7c-4174-acac-43ba70ede542\",\"product_id\":\"2ZYFJ3GM2N\",\"tags\":[\"beats_input_codec_plain_applied\"]}\n\n{\"json\":{\"http_req_ip_geoip\":{\"ip\":\"147.237.70.107\",\"ip_ipaddr\":\"147.237.70.107\",\"location_geopoint\":{\"lat\":31.5,\"lon\":34.75},\"continent_name\":\"Asia\",\"country_name\":\"Israel\",\"city_name\":null,\"postal_code\":null},\"http_req_id\":\"98b82456-1094-4523-961a-42a7c8b2e0c8\",\"http_req_ip\":\"147.237.70.107\",\"http_req_method\":\"POST\",\"http_req_path\":\"/cart/checkout\",\"session\":\"25b3ccb7-1cb5-4765-8ea6-5db7307c1bd0\",\"severity\":\"debug\",\"span_id\":\"63524cdcf612ccb9\",\"timestamp\":\"2024-01-12T11:13:45.447175815Z\",\"trace_id\":\"e1e43f802a679c21f9d66c42add6ec95\"},\"@timestamp\":\"2024-01-12T11:13:45.448Z\",\"@version\":\"1\",\"beat\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\"},\"cloud\":{\"account\":{\"id\":\"074157727657\"},\"availability_zone\":\"us-east-2a\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-02084e96d21517df8\"},\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"region\":\"us-east-2\",\"service\":{\"name\":\"EC2\"}},\"cluster_name\":\"cluster.local\",\"host\":\"172.31.4.242\",\"kubernetes\":{\"container\":{\"id\":\"27f46be207970279dbda825cdcea0ed0ef0a724d6ed8c41f33db3b207e845a54\",\"name\":\"server\"},\"deployment\":{\"name\":\"frontend\"},\"namespace\":\"default\",\"namespace_labels\":{\"kubernetes_io/metadata_name\":\"default\"},\"namespace_uid\":\"21a7e2d9-7da6-4a74-97f7-d04a7dbbb77a\",\"node\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"labels\":{\"beta_kubernetes_io/arch\":\"amd64\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"k8s_io/cloud-provider-aws\":\"5ae15d428da2ffa3cd3bbc9149af8ce1\",\"kubernetes_io/arch\":\"amd64\",\"kubernetes_io/hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"kubernetes_io/os\":\"linux\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"topology_kubernetes_io/region\":\"us-east-2\",\"topology_kubernetes_io/zone\":\"us-east-2a\"},\"name\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"uid\":\"c027d669-c71e-443c-b6d3-6be6b5b7e1ca\"},\"pod\":{\"ip\":\"172.31.2.154\",\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"69d989d8dd\"},\"name\":\"frontend-69d989d8dd-msq9g\",\"uid\":\"b0008d6f-730a-43e3-a4f8-b35b1670980d\"},\"replicaset\":{\"name\":\"frontend-69d989d8dd\"}},\"message\":\"request POST /cart/checkout started. requestID: 98b82456-1094-4523-961a-42a7c8b2e0c8\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"json1\":{",
                    "rule": "\\\"json\\\"\\:\\{"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "0c3f4a89-3355-af57-ab7d-7a55420f5cdf",
            "rules": [
              {
                "id": "505136dc-3bc2-f5dd-8bde-6929305c0ca4",
                "name": "Filter logs where JSON already exists - step 2",
                "description": "{\"json\":{\"http_req_ip_geoip\":{\"ip\":\"147.237.70.107\",\"ip_ipaddr\":\"147.237.70.107\",\"location_geopoint\":{\"lat\":31.5,\"lon\":34.75},\"continent_name\":\"Asia\",\"country_name\":\"Israel\",\"city_name\":null,\"postal_code\":null},\"http_req_id\":\"98b82456-1094-4523-961a-42a7c8b2e0c8\",\"http_req_ip\":\"147.237.70.107\",\"http_req_method\":\"POST\",\"http_req_path\":\"/cart/checkout\",\"session\":\"25b3ccb7-1cb5-4765-8ea6-5db7307c1bd0\",\"severity\":\"debug\",\"span_id\":\"63524cdcf612ccb9\",\"timestamp\":\"2024-01-12T11:13:45.447175815Z\",\"trace_id\":\"e1e43f802a679c21f9d66c42add6ec95\"},\"@timestamp\":\"2024-01-12T11:13:45.448Z\",\"@version\":\"1\",\"beat\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\"},\"cloud\":{\"account\":{\"id\":\"074157727657\"},\"availability_zone\":\"us-east-2a\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-02084e96d21517df8\"},\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"region\":\"us-east-2\",\"service\":{\"name\":\"EC2\"}},\"cluster_name\":\"cluster.local\",\"host\":\"172.31.4.242\",\"kubernetes\":{\"container\":{\"id\":\"27f46be207970279dbda825cdcea0ed0ef0a724d6ed8c41f33db3b207e845a54\",\"name\":\"server\"},\"deployment\":{\"name\":\"frontend\"},\"namespace\":\"default\",\"namespace_labels\":{\"kubernetes_io/metadata_name\":\"default\"},\"namespace_uid\":\"21a7e2d9-7da6-4a74-97f7-d04a7dbbb77a\",\"node\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"labels\":{\"beta_kubernetes_io/arch\":\"amd64\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"k8s_io/cloud-provider-aws\":\"5ae15d428da2ffa3cd3bbc9149af8ce1\",\"kubernetes_io/arch\":\"amd64\",\"kubernetes_io/hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"kubernetes_io/os\":\"linux\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"topology_kubernetes_io/region\":\"us-east-2\",\"topology_kubernetes_io/zone\":\"us-east-2a\"},\"name\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"uid\":\"c027d669-c71e-443c-b6d3-6be6b5b7e1ca\"},\"pod\":{\"ip\":\"172.31.2.154\",\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"69d989d8dd\"},\"name\":\"frontend-69d989d8dd-msq9g\",\"uid\":\"b0008d6f-730a-43e3-a4f8-b35b1670980d\"},\"replicaset\":{\"name\":\"frontend-69d989d8dd\"}},\"message\":\"request POST /cart/checkout started. requestID: 98b82456-1094-4523-961a-42a7c8b2e0c8\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"json\":{",
                    "rule": "\\\"json1\\\"\\:\\{"
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "c157d082-cb85-3baf-7e9a-c99dc71c318b",
                "name": "Nest fields under JSON if not already nested v1",
                "description": "{\"resource\":{\"attributes\":{\"cloud.account.id\":\"074157727657\",\"cloud.availability_zone\":\"us-east-2c\",\"cloud.platform\":\"aws_ec2\",\"cloud.provider\":\"aws\",\"cloud.region\":\"us-east-2\",\"cx.otel_integration.name\":\"coralogix-integration-helm\",\"host.id\":\"i-0b423258572c23bf6\",\"host.image.id\":\"ami-07b50b966251fda6e\",\"host.name\":\"ip-172-31-43-38.us-east-2.compute.internal\",\"host.type\":\"t3.large\",\"k8s.cluster.name\":\"onlineboutique\",\"k8s.container.name\":\"server\",\"k8s.container.restart_count\":\"0\",\"k8s.deployment.name\":\"frontend\",\"k8s.namespace.name\":\"default\",\"k8s.node.name\":\"ip-172-31-43-38.us-east-2.compute.internal\",\"k8s.pod.name\":\"frontend-69d989d8dd-7qc7q\",\"k8s.pod.uid\":\"144393ed-680f-4ed3-9354-f3e33871b009\",\"os.type\":\"linux\"}},\"resourceSchemaUrl\":\"https://opentelemetry.io/schemas/1.6.1\",\"scope\":{\"attributes\":{}},\"attributes\":{\"log.file.path\":\"/var/log/pods/default_frontend-69d989d8dd-7qc7q_144393ed-680f-4ed3-9354-f3e33871b009/server/0.log\",\"log.iostream\":\"stdout\",\"time\":\"2024-01-05T13:57:43.456577052Z\"},\"observedTimeUnixNano\":1704463063650460200,\"timeUnixNano\":1704463063456577000,\"http_req_id\":\"042f4b7f-1cf2-4946-a4c5-bcfe938580fa\",\"http_req_ip\":\"172.217.18.110\",\"http_req_method\":\"POST\",\"http_req_path\":\"/cart\",\"session\":\"82daafa1-0fe7-443e-b9aa-92063354954c\",\"severity\":\"debug\",\"span_id\":\"3661a7f017c4b32b\",\"timestamp\":\"2024-01-05T13:57:43.456319372Z\",\"trace_id\":\"ece78d03cd5e60160c3a7af539bf13ab\"}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$beginning\"json\":{\"http_req_id\":\"$http_req_id\",\"http_req_ip\":\"$http_req_ip\",\"http_req_method\":\"$http_req_method\",\"http_req_path\":\"$http_req_path\",\"session\":\"$session\",\"severity\":\"$severity\",\"span_id\":\"$span_id\",\"timestamp\":\"$timestamp\",\"trace_id\":\"$trace_id\"}}",
                    "rule": "(?P<beginning>.*)\\\"http_req_id\\\"\\:\\\"(?P<http_req_id>[\\w\\-]+)\\\"\\,\\\"http_req_ip\\\"\\:\\\"(?P<http_req_ip>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\\"\\,\\\"http_req_method\\\"\\:\\\"(?P<http_req_method>[\\w]+)\\\"\\,\\\"http_req_path\\\"\\:\\\"(?P<http_req_path>[\\/\\w]+)\\\"\\,\\\"session\\\"\\:\\\"(?P<session>[\\w\\-]+)\\\"\\,\\\"severity\\\"\\:\\\"(?P<severity>[\\w]+)\\\"\\,\\\"span_id\\\"\\:\\\"(?P<span_id>[\\w]+)\\\"\\,\\\"timestamp\\\"\\:\\\"(?P<timestamp>\\d{4}\\-\\d{2}\\-\\d{2}T\\d{2}\\:\\d{2}\\:\\d{2}\\.\\d{1,10}Z)\\\"\\,\\\"trace_id\\\"\\:\\\"(?P<trace_id>[\\w]+)\\\"\\}"
                  }
                },
                "enabled": true,
                "order": 2
              },
              {
                "id": "94e8c4b7-b110-c404-2842-57ee701c302a",
                "name": "Nest fields under JSON if not already nested v2",
                "description": "{\"resource\":{\"attributes\":{\"cloud.account.id\":\"074157727657\",\"cloud.availability_zone\":\"us-east-2b\",\"cloud.platform\":\"aws_ec2\",\"cloud.provider\":\"aws\",\"cloud.region\":\"us-east-2\",\"cx.otel_integration.name\":\"coralogix-integration-helm\",\"host.id\":\"i-0a5b27e90b547603f\",\"host.image.id\":\"ami-07b50b966251fda6e\",\"host.name\":\"ip-172-31-30-194.us-east-2.compute.internal\",\"host.type\":\"t3.large\",\"k8s.cluster.name\":\"onlineboutique\",\"k8s.container.name\":\"server\",\"k8s.container.restart_count\":\"0\",\"k8s.deployment.name\":\"frontend\",\"k8s.namespace.name\":\"default\",\"k8s.node.name\":\"ip-172-31-30-194.us-east-2.compute.internal\",\"k8s.pod.name\":\"frontend-69d989d8dd-fvxbh\",\"k8s.pod.uid\":\"93174814-bcbd-46ef-803d-423995ae8c20\",\"os.type\":\"linux\"}},\"resourceSchemaUrl\":\"https://opentelemetry.io/schemas/1.6.1\",\"scope\":{\"attributes\":{}},\"attributes\":{\"log.file.path\":\"/var/log/pods/default_frontend-69d989d8dd-fvxbh_93174814-bcbd-46ef-803d-423995ae8c20/server/0.log\",\"log.iostream\":\"stdout\",\"time\":\"2024-01-05T13:57:43.780503549Z\"},\"observedTimeUnixNano\":1704463063948296400,\"timeUnixNano\":1704463063780503600,\"http_req_id\":\"646b6167-9fdc-4057-88e9-c74db871128f\",\"http_req_ip\":\"157.131.72.157\",\"http_req_method\":\"GET\",\"http_req_path\":\"/product/LS4PSXUNUM\",\"http_resp_bytes\":7983,\"http_resp_status\":200,\"http_resp_took_ms\":32,\"session\":\"f8112775-873c-4860-a2fa-780ac9eb40fb\",\"severity\":\"debug\",\"span_id\":\"c93746ea2fa9d733\",\"timestamp\":\"2024-01-05T13:57:43.780204274Z\",\"trace_id\":\"f040cc8be8a9609e7f186675293fe6ff\"}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$beginning\"json\":{\"http_req_id\":\"$http_req_id\",\"http_req_ip\":\"$http_req_ip\",\"http_req_method\":\"$http_req_method\",\"http_req_path\":\"$http_req_path\",\"http_resp_bytes\":\"$http_resp_bytes\",\"http_resp_status\":\"$http_resp_status\",\"http_resp_took_ms\":\"$http_resp_took_ms\",\"session\":\"$session\",\"severity\":\"$severity\",\"span_id\":\"$span_id\",\"timestamp\":\"$timestamp\",\"trace_id\":\"$trace_id\"}}",
                    "rule": "(?P<beginning>.*)\\\"http_req_id\\\"\\:\\\"(?P<http_req_id>[\\w\\-]+)\\\"\\,\\\"http_req_ip\\\"\\:\\\"(?P<http_req_ip>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\\"\\,\\\"http_req_method\\\"\\:\\\"(?P<http_req_method>[\\w]+)\\\"\\,\\\"http_req_path\\\"\\:\\\"(?P<http_req_path>[\\/\\w]+)\\\"\\,\"http_resp_bytes\":(?P<http_resp_bytes>\\d{1,8})\\,\"http_resp_status\":(?P<http_resp_status>\\d{1,3})\\,\"http_resp_took_ms\":(?P<http_resp_took_ms>\\d{1,3})\\,\\\"session\\\"\\:\\\"(?P<session>[\\w\\-]+)\\\"\\,\\\"severity\\\"\\:\\\"(?P<severity>[\\w]+)\\\"\\,\\\"span_id\\\"\\:\\\"(?P<span_id>[\\w]+)\\\"\\,\\\"timestamp\\\"\\:\\\"(?P<timestamp>\\d{4}\\-\\d{2}\\-\\d{2}T\\d{2}\\:\\d{2}\\:\\d{2}\\.\\d{1,10}Z)\\\"\\,\\\"trace_id\\\"\\:\\\"(?P<trace_id>[\\w]+)\\\"\\}"
                  }
                },
                "enabled": true,
                "order": 3
              }
            ],
            "enabled": true,
            "order": 2
          }
        ],
        "order": 17
      },
      {
        "id": "bb978df7-4fa1-caa3-538f-79b2c9b94649",
        "name": "Parse frontend product info",
        "description": "",
        "creator": "george.pickers@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "default"
            }
          },
          {
            "subsystemName": {
              "value": "frontend"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "4d48753e-acca-c7de-2d93-5d359520a270",
            "rules": [
              {
                "id": "03eb3a0c-ea44-3ac3-916a-01a0f225d7f1",
                "name": "Extract product ID",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "extractParameters": {
                    "rule": "(json.*?){.*?http.req.path.*?product.*?(?P<product_id>\\w+)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "1c4917ab-6d59-eb26-79d3-c9ea63497473",
            "rules": [
              {
                "id": "4bee0f11-0635-3c5f-4f84-3f1fa2bf1baf",
                "name": "Delete product id from request path",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$1",
                    "rule": "(json.*?{.*?http.req.path.*?product)(?P<product_id>.*?\\w+)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          }
        ],
        "order": 18
      },
      {
        "id": "7b54fa57-0a45-bf62-02e3-614059d17c78",
        "name": "OB - Error to Message",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "default"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "1257318f-06cb-e356-f9a6-ff79a7950603",
            "rules": [
              {
                "id": "f1a9bb17-5c70-7c6a-5662-b7d7ff10dd69",
                "name": "error -> message",
                "description": "",
                "sourceField": "text.error",
                "parameters": {
                  "extractParameters": {
                    "rule": "(?P<message>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 19
      },
      {
        "id": "822da096-c6e8-4775-9fbc-7558cb4db2d1",
        "name": "Product stats",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "default"
            }
          },
          {
            "subsystemName": {
              "value": "loadgenerator"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "e0f58b1b-8610-463e-ab81-8028c420abff",
            "rules": [
              {
                "id": "6b8ffa2a-5616-442f-934f-ae764a81765d",
                "name": "Parse stats fields",
                "description": "{\"cloud\":{\"machine\":{\"type\":\"t3.large\"},\"availability_zone\":\"us-east-2a\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"provider\":\"aws\",\"instance\":{\"id\":\"i-0f7afac2798217d04\"}},\"kubernetes\":{\"container\":{\"id\":\"f656936403a86d996f50bbd349cb4a1da83678cb9b633af526abe46d8b7556e4\",\"name\":\"main\"},\"pod\":{\"labels\":{\"app\":\"loadgenerator\",\"pod-template-hash\":\"589648f87f\"},\"ip\":\"172.31.4.1\",\"name\":\"loadgenerator-589648f87f-46n6p\"},\"namespace\":\"default\",\"node\":{\"labels\":{\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"topology_kubernetes_io/region\":\"us-east-2\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"topology_kubernetes_io/zone\":\"us-east-2a\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"beta_kubernetes_io/os\":\"linux\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"beta_kubernetes_io/arch\":\"amd64\",\"kubernetes_io/arch\":\"amd64\"},\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"deployment\":{\"name\":\"loadgenerator\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2021-08-26T21:52:06.589Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\" GET /product/1YMWWN1N4O 1181 16(1.35%) | 28 3 1729 15 | 0.10 0.00\",\"tags\":[\"kubernetes\",\"containers\",\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"machine\":{\"type\":\"t3.large\"},\"account\":{\"id\":\"074157727657\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2a\",\"region\":\"us-east-2\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"service\":{\"name\":\"EC2\"},\"instance\":{\"id\":\"i-0f7afac2798217d04\"}},\"kubernetes\":{\"container\":{\"id\":\"f656936403a86d996f50bbd349cb4a1da83678cb9b633af526abe46d8b7556e4\",\"name\":\"main\"},\"pod\":{\"labels\":{\"app\":\"loadgenerator\",\"pod-template-hash\":\"589648f87f\"},\"ip\":\"172.31.4.1\",\"name\":\"loadgenerator-589648f87f-46n6p\"},\"namespace\":\"default\",\"deployment\":{\"name\":\"loadgenerator\"},\"node\":{\"labels\":{\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"topology_kubernetes_io/region\":\"us-east-2\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"topology_kubernetes_io/zone\":\"us-east-2a\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"beta_kubernetes_io/os\":\"linux\",\"kubernetes_io/os\":\"linux\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"beta_kubernetes_io/arch\":\"amd64\",\"kubernetes_io/arch\":\"amd64\"},\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2021-08-26T22:30:12.743Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\" POST /setCurrency 2045 33(1.61%) | 40 5 1890 21 | 0.50 0.00\",\"tags\":[\"kubernetes\",\"containers\",\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"machine\":{\"type\":\"t3.large\"},\"availability_zone\":\"us-east-2a\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"provider\":\"aws\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"region\":\"us-east-2\",\"instance\":{\"id\":\"i-0f7afac2798217d04\"}},\"kubernetes\":{\"container\":{\"id\":\"f656936403a86d996f50bbd349cb4a1da83678cb9b633af526abe46d8b7556e4\",\"name\":\"main\"},\"pod\":{\"labels\":{\"app\":\"loadgenerator\",\"pod-template-hash\":\"589648f87f\"},\"ip\":\"172.31.4.1\",\"name\":\"loadgenerator-589648f87f-46n6p\"},\"namespace\":\"default\",\"deployment\":{\"name\":\"loadgenerator\"},\"node\":{\"labels\":{\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"topology_kubernetes_io/region\":\"us-east-2\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"topology_kubernetes_io/zone\":\"us-east-2a\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"kubernetes_io/os\":\"linux\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"beta_kubernetes_io/arch\":\"amd64\",\"kubernetes_io/arch\":\"amd64\"},\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2021-08-26T23:13:35.546Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\" GET /product/6E92ZMYYFZ 1923 21(1.09%) | 28 3 1671 15 | 0.00 0.00\",\"tags\":[\"kubernetes\",\"containers\",\"beats_input_codec_plain_applied\"]}\n",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "stats\":{\"method\":\"$1\",\"endpoint\":\"$2\",\"product\":\"$3\",\"success\":\"$4\",\"failure\":\"$5\",\"prct_failure\":\"$6\",\"avg\":\"$7\",\"min\":\"$8\",\"max\":\"$9\",\"mid\":\"$10\",\"requests_rate\":\"$11\",\"failures_rate\":\"$12\"}",
                    "rule": "message\"\\s*:\"\\s*(?P<method>\\w+)\\s*(?P<endpoint>[^\\s\\\\]+)(?:\\\\/)?(?P<product_no>\\w*)\\s*(?P<successs>\\d+)\\s*(?P<failure>\\d+)\\((?P<prct_failure>[\\d\\.]+)%\\)\\s*\\|\\s*(?P<avg>\\d+)\\s*(?P<min>\\d+)\\s*(?P<max>\\d+)\\s*(?P<mid>\\d+)\\s*\\|\\s*(?P<requests_rate>[\\d\\.]+)\\s*(?P<failures_rate>[\\d\\.]+)\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 20
      },
      {
        "id": "10aa9467-6c78-9a73-67bc-b61553d3f821",
        "name": "Extract service from cx.metadata",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "074157727657"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "d2bebef5-f34b-68fc-9cf2-bf55743515b9",
            "rules": [
              {
                "id": "3df27922-1dc4-bccd-212d-1fcf132d8e14",
                "name": "Extract faas_name into cx_metadata.service_name",
                "description": "{\"platform_event_type\":\"report\",\"cx_metadata\":{\"cloud_account_id\":\"074157727657\",\"cloud_provider\":\"aws\",\"cloud_region\":\"eu-west-1\",\"faas_execution\":\"e1065026-d775-4bd9-ae53-99032e367c79\",\"faas_id\":\"arn:aws:lambda:eu-west-1:074157727657:function:cll-lambda-python-2:$LATEST\",\"faas_instance_cx_id\":\"2d6b859b1e5ed7e415774a1c17d6cd35\",\"faas_name\":\"cll-lambda-python-2\",\"span_id\":\"a851dc681f9b1358\",\"tags\":{\"project\":\"coralogix-lambda-lab\"},\"trace_id\":\"2194edc1974a58d39628b739c9ba8a6b\"},\"event\":{\"error_type\":null,\"metrics\":{\"billed_duration_ms\":1311,\"duration_ms\":1310.858,\"init_duration_ms\":null,\"max_memory_used_mb\":118,\"memory_size_mb\":128,\"produced_bytes\":0,\"restore_duration_ms\":null},\"request_id\":\"e1065026-d775-4bd9-ae53-99032e367c79\",\"status\":\"success\"}}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$start\"faas_name\":\"$service_name\"$end,\"service\":\"$service_name\"}",
                    "rule": "(?P<start>.*)\"faas_name\":\"(?P<service_name>[^\"]*)\"(?P<end>.*)}"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 21
      },
      {
        "id": "37e3ccfa-0273-22dc-0056-183a4ae33b20",
        "name": "Parse AWS-ELB",
        "description": "Parse logs generated from AWS Classic Load Balancer (ELB)",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "aws-elb"
            }
          },
          {
            "subsystemName": {
              "value": "customers-elb"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "b6f74bd1-dd7a-df19-4a0f-9f889ed5398b",
            "rules": [
              {
                "id": "b0a6808d-3113-ea61-2469-40217c47c1e2",
                "name": "Parse AWS-ELB Logs",
                "description": "{\"message\":\"2022-10-04T15:42:14.780568Z prod 146.225.200.106:443 - -1 -1 -1 504 504 4942 4942 \\\"GET https://learningcatalytics.com:443/questions/856776/item_versions HTTP/1.0\\\" \\\"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/536.2 (KHTML, like Gecko) Chrome/60.0.808.0 Safari/536.2\\\" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2\"}\n\n{\"message\":\"2022-10-04T15:41:58.780568Z prod 86.95.52.184:443 - -1 -1 -1 504 504 5041 5041 \\\"GET https://learningcatalytics.com:443courses/285528/modules HTTP/1.0\\\" \\\"Mozilla/5.0 (Windows 98; Win 9x 4.90; ky-KG; rv:1.9.1.20) Gecko/2020-07-10 09:07:16 Firefox/3.6.3\\\" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2\"}",
                "sourceField": "text",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text",
                    "rule": "message\\\"\\:\\\"(?P<timestamp>\\d{4}\\-\\d{2}\\-[0-9]{2}T\\d{2}\\:\\d{2}\\:\\d{2}\\.\\d+Z)\\s*(?P<elb_name>[\\w\\-]+)\\s*(?P<client_ip>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\:(?P<client_port>\\d+)\\s*(?P<target_ip>(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}|\\-))(\\:(?P<target_port>\\d+))?\\s*(?P<request_processing_time>[\\-\\d\\.]+)\\s*(?P<target_processing_time>[\\-\\d\\.]+)\\s*(?P<response_processing_time>[\\-\\d\\.]+)\\s*(?P<elb_status_code>\\d{3})\\s*(?P<target_status_code>\\d{3})\\s*(?P<received_bytes>\\d+)\\s*(?P<sent_bytes>\\d+)\\s*(\\\\)?\\\"(?P<request_verb>[a-zA-Z]+|-)\\s*(?P<request_uri>[^\\s*]+)\\s*(?P<request_protocol>[^\\\"]+)\\\"\\s*(\\\\)?\\\"(\\s*)?(?P<user_agent>[^\\\"]+)\\\"\\s*(?P<tls_cipher>[\\w\\-]+)\\s*(?P<tls_protocol>[\\w\\.]+)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "c117c09c-0aec-74a0-fa3c-e21b6fa30529",
            "rules": [
              {
                "id": "cae9dcbb-cead-2936-c9a2-ec1b9bff8e18",
                "name": "Extract Timestamp from AWS-ELB Logs",
                "description": "2022-10-04T15:58:34.780568Z",
                "sourceField": "text.timestamp",
                "parameters": {
                  "extractTimestampParameters": {
                    "standard": "FORMAT_STANDARD_STRFTIME_OR_UNSPECIFIED",
                    "format": "%Y-%m-%dT%H:%M:%S.%fZ"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          }
        ],
        "order": 22
      },
      {
        "id": "7defa69e-e8df-3766-f684-8ffec6b20c75",
        "name": "Windows - rename host",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "windows_logs"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "aa31bf20-8b8a-d304-540a-1cbe36f4f734",
            "rules": [
              {
                "id": "44edbba7-a003-ffbe-30c4-ff0b9964ebcb",
                "name": "Rename host",
                "description": "{\"@timestamp\":\"2021-11-02T00:14:26.379Z\",\"event\":{\"code\":4625,\"created\":\"2021-11-02T00:14:27.912Z\",\"outcome\":\"failure\",\"action\":\"Logon\",\"provider\":\"Microsoft-Windows-Security-Auditing\",\"kind\":\"event\"},\"tags\":[\"beats_input_codec_plain_applied\"],\"agent\":{\"ephemeral_id\":\"075c16b2-19a2-41fa-a024-644958b4a4c7\",\"type\":\"winlogbeat\",\"name\":\"EC2AMAZ-CIFBMR8\",\"hostname\":\"EC2AMAZ-CIFBMR8\",\"id\":\"ea08b7e2-c1b6-4031-9ce6-f5c4b04ac45f\",\"version\":\"7.10.1\"},\"message\":\"An account failed to log on.\\n\\nSubject:\\n\\tSecurity ID:\\t\\tS-1-0-0\\n\\tAccount Name:\\t\\t-\\n\\tAccount Domain:\\t\\t-\\n\\tLogon ID:\\t\\t0x0\\n\\nLogon Type:\\t\\t\\t3\\n\\nAccount For Which Logon Failed:\\n\\tSecurity ID:\\t\\tS-1-0-0\\n\\tAccount Name:\\t\\tADMINISTRATOR\\n\\tAccount Domain:\\t\\t\\n\\nFailure Information:\\n\\tFailure Reason:\\t\\tUnknown user name or bad password.\\n\\tStatus:\\t\\t\\t0xC000006D\\n\\tSub Status:\\t\\t0xC000006A\\n\\nProcess Information:\\n\\tCaller Process ID:\\t0x0\\n\\tCaller Process Name:\\t-\\n\\nNetwork Information:\\n\\tWorkstation Name:\\t-\\n\\tSource Network Address:\\t27.72.30.223\\n\\tSource Port:\\t\\t0\\n\\nDetailed Authentication Information:\\n\\tLogon Process:\\t\\tNtLmSsp \\n\\tAuthentication Package:\\tNTLM\\n\\tTransited Services:\\t-\\n\\tPackage Name (NTLM only):\\t-\\n\\tKey Length:\\t\\t0\\n\\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\\n\\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\n\\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\\n\\nThe Process Information fields indicate which account and process on the system requested the logon.\\n\\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\n\\nThe authentication information fields provide detailed information about this specific logon request.\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\",\"@version\":\"1\",\"host\":{\"name\":\"EC2AMAZ-CIFBMR8\"},\"ecs\":{\"version\":\"1.5.0\"},\"winlog\":{\"channel\":\"Security\",\"event_id\":4625,\"process\":{\"pid\":716,\"thread\":{\"id\":4108}},\"opcode\":\"Info\",\"event_data\":{\"SubjectUserName\":\"-\",\"SubStatus\":\"0xc000006a\",\"TransmittedServices\":\"-\",\"SubjectLogonId\":\"0x0\",\"SubjectUserSid\":\"S-1-0-0\",\"Status\":\"0xc000006d\",\"IpPort\":\"0\",\"IpAddress\":\"27.72.30.223\",\"FailureReason\":\"%%2313\",\"ProcessName\":\"-\",\"LmPackageName\":\"-\",\"TargetUserName\":\"ADMINISTRATOR\",\"TargetUserSid\":\"S-1-0-0\",\"ProcessId\":\"0x0\",\"KeyLength\":\"0\",\"LogonProcessName\":\"NtLmSsp \",\"SubjectDomainName\":\"-\",\"AuthenticationPackageName\":\"NTLM\",\"LogonType\":\"3\",\"WorkstationName\":\"-\"},\"keywords\":[\"Audit Failure\"],\"task\":\"Logon\",\"record_id\":16734626,\"provider_name\":\"Microsoft-Windows-Security-Auditing\",\"api\":\"wineventlog\",\"computer_name\":\"EC2AMAZ-CIFBMR8\",\"provider_guid\":\"{54849625-5478-4994-A5BA-3E3B0328C30D}\",\"activity_id\":\"{92522A8E-F43F-0000-B42A-52923FF4D601}\"},\"log\":{\"level\":\"information\"}}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"host_windows\":{",
                    "rule": "\"host\"\\s*:{"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 23
      },
      {
        "id": "f6eb9560-e712-0f07-b7d9-09722609ae39",
        "name": "Parse prometheus-server logs",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "prometheus"
            }
          },
          {
            "subsystemName": {
              "value": "prometheus-server"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "173336a9-dfb4-8286-784a-89288bb5546b",
            "rules": [
              {
                "id": "1b4b6435-317f-9454-f134-315d98f38432",
                "name": "Parse prometheus-server logs #1",
                "description": "{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T22:49:53.600Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T22:49:53.599Z caller=notifier.go:601 component=notifier msg=\\\"Stopping notification manager...\\\"\",\"tags\":[\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"service\":{\"name\":\"EC2\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T22:49:53.600Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T22:49:53.599Z caller=main.go:664 msg=\\\"Scrape discovery manager stopped\\\"\",\"tags\":[\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"deployment\":{\"name\":\"prometheus-server\"},\"namespace\":\"prometheus\"},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T22:49:53.600Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=error ts=2022-08-30T22:49:53.600Z caller=main.go:881 err=\\\"opening storage failed: lock DB directory: resource temporarily unavailable\\\"\",\"tags\":[\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T22:55:03.838Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T22:55:03.838Z caller=repair.go:57 component=tsdb msg=\\\"Found healthy block\\\" mint=1661875200263 maxt=1661882400000 ulid=01GBR2017JBF14WHDTVGHH3HYA\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"component\":\"$component\",\"message\":\"$message\",\"mint\":\"$mint\",\"maxt\":\"$maxt\",\"ulid\":\"$ulid\"",
                    "rule": "\"message\":\"level=(?P<level>[A-z]+) ts=(?P<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]{3}Z) caller=(?P<caller>[^ ]+)(?: component=([^ ]+))? (?:msg|err)=\\\\\"(?P<message>[^\"]+)\\\\\"(?: mint=(?P<mint>[0-9]+) maxt=(?P<maxt>[0-9]+) ulid=(?P<ulid>[0-9A-Z]+))?\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "8d7686a9-c076-8d40-2844-49e9f0074cff",
                "name": "Parse prometheus-server logs #2",
                "description": "{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T23:15:28.719Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T23:15:28.719Z caller=tls_config.go:191 component=web msg=\\\"TLS is disabled.\\\" http2=false\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"component\":\"$component\",\"message\":\"$message\",\"http2\":\"$http2\"",
                    "rule": "\"message\":\"level=(?P<level>[A-z]+) ts=(?P<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]{3}Z) caller=(?P<caller>[^ ]+) component=(?P<component>[^ ]+) msg=\\\\\"(?P<message>[^\"]+)\\\\\" http2=(?P<http2>[a-z]+)\""
                  }
                },
                "enabled": true,
                "order": 2
              },
              {
                "id": "289983f9-a7a8-30a0-92f7-7df4241a5a3c",
                "name": "Parse prometheus-server logs #3",
                "description": "{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T23:15:28.719Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T23:15:28.717Z caller=manager.go:944 component=\\\"rule manager\\\" msg=\\\"Rule manager stopped\\\"\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"component\":\"$component\",\"message\":\"$message\"",
                    "rule": "\"message\":\"level=(?P<level>[A-z]+) ts=(?P<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]{3}Z) caller=(?P<caller>[^ ]+) component=\\\\\"(?P<component>[^\"]+)\\\\\" msg=\\\\\"(?P<message>[^\"]+)\\\\\"\""
                  }
                },
                "enabled": true,
                "order": 3
              },
              {
                "id": "41550745-4c72-7505-061f-026e1d4f2f8a",
                "name": "Parse prometheus-server logs #4",
                "description": "{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"service\":{\"name\":\"EC2\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T23:25:46.815Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T23:25:46.815Z caller=web.go:540 component=web msg=\\\"Start listening for connections\\\" address=0.0.0.0:9090\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"component\":\"$component\",\"message\":\"$message\",\"address\":\"$address\"",
                    "rule": "\"message\":\"level=(?P<level>[A-z]+) ts=(?P<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]{3}Z) caller=(?P<caller>[^ ]+) component=(?P<component>[^ ]+) msg=\\\\\"(?P<message>[^\"]+)\\\\\" address=(?P<address>[0-9\\.:]+)\""
                  }
                },
                "enabled": true,
                "order": 4
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "20a87cf2-33ae-bdb5-a661-956b5f8c9488",
            "rules": [
              {
                "id": "679512df-d5f6-06cc-ab59-f78dd072777b",
                "name": "extract level to Coralogix severity",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "jsonExtractParameters": {
                    "destinationFieldType": "DESTINATION_FIELD_SEVERITY",
                    "rule": "level",
                    "destinationFieldText": null
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "c04951a9-39da-3a71-928c-2caaacbe8a78",
            "rules": [
              {
                "id": "233c177f-6bf7-456a-18b5-38827f6aca0d",
                "name": "remove empty field1",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "",
                    "rule": "\"[^\"]+\":\"\","
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "0c8d0f47-f14d-e2ad-9e4f-e6a7e0831d58",
            "rules": [
              {
                "id": "e88334cd-1ada-16e0-5701-fc3bc9cb62da",
                "name": "remove empty field2",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "",
                    "rule": ",\"[^\"]+\":\"\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 4
          }
        ],
        "order": 24
      },
      {
        "id": "cffff6b6-ae03-422e-9f48-30553ba610f9",
        "name": "Severity Rules",
        "description": "",
        "creator": "george.pickers@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "48e27645-026a-4272-931a-62a48480e502",
            "rules": [
              {
                "id": "087a21d2-152e-0855-9e09-4ed08e1d6560",
                "name": "Extract Severity from AWS-ELB Status Code",
                "description": "{\"client_addr\":\"225.44.33.12\",\"client_port\":\"443\",\"elb\":\"prod\",\"elb_status_code\":\"504\",\"recieved_bytes\":\"4997\",\"request\":\"GET https://learningcatalytics.com:443/list HTTP/1.0\\\\\",\"request_processing_time\":\"-1\",\"response_processing_time\":\"-1\",\"sent_bytes\":\"4997\",\"ssl_cipher\":\"ECDHE-RSA-AES128-GCM-SHA256\",\"ssl_protocol\":\"TLSv1.2\",\"target_addr\":\"-\",\"target_processing_time\":\"-1\",\"target_status_code\":\"504\",\"timestamp\":\"2022-05-25T04:33:47.120274Z\",\"user_agent\":\"Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/2012-01-05 11:36:56 Firefox/3.8\\\\\"}",
                "sourceField": "text",
                "parameters": {
                  "jsonExtractParameters": {
                    "destinationFieldType": "DESTINATION_FIELD_SEVERITY",
                    "rule": "elb_status_code",
                    "destinationFieldText": null
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "0ea250c2-a66b-41c9-be86-c35ee8dcea95",
                "name": "Extract severity from json.http_resp_status",
                "description": "{\"cloud\":{\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2a\",\"service\":{\"name\":\"EC2\"},\"region\":\"us-east-2\",\"account\":{\"id\":\"074157727657\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-0f7afac2798217d04\"}},\"kubernetes\":{\"container\":{\"id\":\"83b5eabd340b092e44f97e6a0add04a45f8b2408daad162d1b1e4ff4901e9312\",\"name\":\"server\"},\"pod\":{\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"b85fc47d4\"},\"ip\":\"172.31.13.168\",\"name\":\"frontend-b85fc47d4-z8vb5\"},\"namespace\":\"default\",\"node\":{\"labels\":{\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"topology_kubernetes_io/region\":\"us-east-2\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"topology_kubernetes_io/zone\":\"us-east-2a\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"kubernetes_io/os\":\"linux\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"beta_kubernetes_io/arch\":\"amd64\",\"kubernetes_io/arch\":\"amd64\"},\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"deployment\":{\"name\":\"frontend\"}},\"cluster_name\":\"cluster.local\",\"inner_json\":{\"severity\":\"debug\",\"timestamp\":\"2021-08-27T23:54:32.487194427Z\",\"http_req_id\":\"231de558-b0d3-40ee-a5e9-674b52e8f987\",\"http_req_method\":\"GET\",\"http_req_path\":\"/cart\",\"http_resp_bytes\":16822,\"http_resp_status\":200,\"http_resp_took_ms\":47,\"message\":\"request complete\",\"session\":\"25740e19-1bcc-4ea4-b5f3-eaacffddbaa1\"},\"@timestamp\":\"2021-08-27T23:54:32.488Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"tags\":[\"kubernetes\",\"containers\",\"beats_input_codec_plain_applied\"]}\n",
                "sourceField": "text",
                "parameters": {
                  "extractParameters": {
                    "rule": "json.*?http_resp_status\\\\\"\\s*:.*?(?P<severity>\\d{3})"
                  }
                },
                "enabled": false,
                "order": 2
              },
              {
                "id": "6d7e162d-1fb8-eac2-f5cf-61f602e7fdcf",
                "name": "Set status 2/3xx logs to INFO",
                "description": "",
                "sourceField": "text.json.http_resp_status",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "severity",
                    "replaceNewVal": "INFO",
                    "rule": "(2|3)\\d\\d"
                  }
                },
                "enabled": false,
                "order": 3
              },
              {
                "id": "d4df788f-e56f-4637-0197-95ddde1245de",
                "name": "Request started/completed -> INFO",
                "description": "",
                "sourceField": "text.message",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "INFO",
                    "rule": ".*?(started|completed).*"
                  }
                },
                "enabled": false,
                "order": 4
              },
              {
                "id": "9a1e6a85-e6dc-64cf-5aae-9e36397a1a32",
                "name": "Extract severity from json.severity",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "jsonExtractParameters": {
                    "destinationFieldType": "DESTINATION_FIELD_SEVERITY",
                    "rule": "json.severity",
                    "destinationFieldText": null
                  }
                },
                "enabled": true,
                "order": 5
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "b84e62bc-af20-3905-fabf-0f010fcdcecc",
            "rules": [
              {
                "id": "478112f5-87e1-e80d-0fcf-955300c04e7d",
                "name": "Extract severity from json.http_resp_status",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "jsonExtractParameters": {
                    "destinationFieldType": "DESTINATION_FIELD_SEVERITY",
                    "rule": "json.http_resp_status",
                    "destinationFieldText": null
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "104883e3-249f-4848-88ab-4597c06b4781",
                "name": "Severity Rule",
                "description": "Look for default severity text",
                "sourceField": "text",
                "parameters": {
                  "extractParameters": {
                    "rule": "\\b(?P<severity>DEBUG|TRACE|INFO|WARN|ERROR|FATAL|EXCEPTION|[Dd]ebug|[Tt]race|[Ii]nfo|[Ww]arn|[Ee]rror|[Ff]atal|[Ee]xception)\\b"
                  }
                },
                "enabled": true,
                "order": 2
              }
            ],
            "enabled": true,
            "order": 2
          }
        ],
        "order": 25
      },
      {
        "id": "c57403ce-b735-391e-44a6-9ba3e13a02ac",
        "name": "kube",
        "description": "Fix odd fields causing parsing to fail",
        "creator": "david.bott+boutique@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "kube-system"
            }
          },
          {
            "subsystemName": {
              "value": "kube-apiserver-audit"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "9cdcd5ed-314c-fc2a-86d7-0953918350bb",
            "rules": [
              {
                "id": "68cff733-3b14-f48e-029e-331154b0e621",
                "name": "Remove field called \".\"",
                "description": "\n{\ntext:{\"stage\":\"ResponseComplete\",\"requestURI\":\"/apis/authorization.k8s.io/v1/subjectaccessreviews\",\"requestObject\":{\"kind\":\"SubjectAccessReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null},\"spec\":{\"resourceAttributes\":{\"verb\":\"get\",\"version\":\"v1\",\"resource\":\"nodes\",\"subresource\":\"metrics\",\"name\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"user\":\"system:serviceaccount:monitoring24:coralogix-opentelemetry-collector\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:monitoring24\",\"system:authenticated\"],\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"coralogix-opentelemetry-collector-8497849d4-9bmvl\"],\"authentication.kubernetes.io/pod-uid\":[\"1bd6c1e0-5d2c-4d85-9a3b-1e3c838e3dc1\"]},\"uid\":\"3772d3fb-8c4e-4af6-be48-924e91cfe7d4\"},\"status\":{\"allowed\":false}},\"auditID\":\"25b68412-42de-4d04-a755-dbe91e10bf98\",\"objectRef\":{\"resource\":\"subjectaccessreviews\",\"apiGroup\":\"authorization.k8s.io\",\"apiVersion\":\"v1\"},\"userAgent\":\"kubelet/v1.21.2 (linux/amd64) kubernetes/3d33787\",\"sourceIPs\":[\"18.118.132.47\"],\"responseStatus\":{\"metadata\":{},\"code\":201},\"responseObject\":{\"kind\":\"SubjectAccessReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null,\"managedFields\":[{\"manager\":\"kubelet\",\"operation\":\"Update\",\"apiVersion\":\"authorization.k8s.io/v1\",\"time\":\"2024-10-10T15:39:56Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:spec\":{\"f:extra\":{\".\":{},\"f:authentication.kubernetes.io/pod-name\":{},\"f:authentication.kubernetes.io/pod-uid\":{}},\"f:groups\":{},\"f:resourceAttributes\":{\".\":{},\"f:name\":{},\"f:resource\":{},\"f:subresource\":{},\"f:verb\":{},\"f:version\":{}},\"f:uid\":{},\"f:user\":{}}}}]},\"spec\":{\"resourceAttributes\":{\"verb\":\"get\",\"version\":\"v1\",\"resource\":\"nodes\",\"subresource\":\"metrics\",\"name\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"user\":\"system:serviceaccount:monitoring24:coralogix-opentelemetry-collector\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:monitoring24\",\"system:authenticated\"],\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"coralogix-opentelemetry-collector-8497849d4-9bmvl\"],\"authentication.kubernetes.io/pod-uid\":[\"1bd6c1e0-5d2c-4d85-9a3b-1e3c838e3dc1\"]},\"uid\":\"3772d3fb-8c4e-4af6-be48-924e91cfe7d4\"},\"status\":{\"allowed\":true,\"reason\":\"RBAC: allowed by ClusterRoleBinding \\\"coralogix-opentelemetry-collector\\\" of ClusterRole \\\"coralogix-opentelemetry-collector\\\" to ServiceAccount \\\"coralogix-opentelemetry-collector/monitoring24\\\"\"}},\"user\":{\"username\":\"system:node:ip-172-31-43-38.us-east-2.compute.internal\",\"uid\":\"aws-iam-authenticator:074157727657:AROARCRBFD6U5I6XD6RHO\",\"groups\":[\"system:bootstrappers\",\"system:nodes\",\"system:authenticated\"],\"extra\":{\"accessKeyId\":[\"ASIARCRBFD6UYC7YIWNE\"],\"arn\":[\"arn:aws:sts::074157727657:assumed-role/eks-nodes/i-0b423258572c23bf6\"],\"canonicalArn\":[\"arn:aws:iam::074157727657:role/eks-nodes\"],\"principalId\":[\"AROARCRBFD6U5I6XD6RHO\"],\"sessionName\":[\"i-0b423258572c23bf6\"],\"sigs.k8s.io/aws-iam-authenticator/principalId\":[\"AROARCRBFD6U5I6XD6RHO\"]}},\"level\":\"RequestResponse\",\"annotations\":{\"authorization.k8s.io/decision\":\"allow\",\"authorization.k8s.io/reason\":\"\"},\"stageTimestamp\":\"2024-10-10T15:39:56.576301Z\",\"requestReceivedTimestamp\":\"2024-10-10T15:39:56.573475Z\",\"verb\":\"create\",\"kind\":\"Event\",\"apiVersion\":\"audit.k8s.io/v1\"}\n}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": " ",
                    "rule": "\\\"\\.\\\"\\:\\{\\}\\,"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "22c2aa15-4652-e3e6-b068-dc4e3be85b81",
            "rules": [
              {
                "id": "545a279a-c687-1d81-ee7b-7b3436eafcc4",
                "name": "Rename status to statusObject",
                "description": "{\ntext:{\"stage\":\"ResponseComplete\",\"requestURI\":\"/apis/authorization.k8s.io/v1/subjectaccessreviews\",\"requestObject\":{\"kind\":\"SubjectAccessReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null},\"spec\":{\"resourceAttributes\":{\"verb\":\"get\",\"version\":\"v1\",\"resource\":\"nodes\",\"subresource\":\"metrics\",\"name\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"user\":\"system:serviceaccount:monitoring24:coralogix-opentelemetry-collector\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:monitoring24\",\"system:authenticated\"],\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"coralogix-opentelemetry-collector-8497849d4-9bmvl\"],\"authentication.kubernetes.io/pod-uid\":[\"1bd6c1e0-5d2c-4d85-9a3b-1e3c838e3dc1\"]},\"uid\":\"3772d3fb-8c4e-4af6-be48-924e91cfe7d4\"},\"status\":{\"allowed\":false}},\"auditID\":\"25b68412-42de-4d04-a755-dbe91e10bf98\",\"objectRef\":{\"resource\":\"subjectaccessreviews\",\"apiGroup\":\"authorization.k8s.io\",\"apiVersion\":\"v1\"},\"userAgent\":\"kubelet/v1.21.2 (linux/amd64) kubernetes/3d33787\",\"sourceIPs\":[\"18.118.132.47\"],\"responseStatus\":{\"metadata\":{},\"code\":201},\"responseObject\":{\"kind\":\"SubjectAccessReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null,\"managedFields\":[{\"manager\":\"kubelet\",\"operation\":\"Update\",\"apiVersion\":\"authorization.k8s.io/v1\",\"time\":\"2024-10-10T15:39:56Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:spec\":{\"f:extra\":{ \"f:authentication.kubernetes.io/pod-name\":{},\"f:authentication.kubernetes.io/pod-uid\":{}},\"f:groups\":{},\"f:resourceAttributes\":{ \"f:name\":{},\"f:resource\":{},\"f:subresource\":{},\"f:verb\":{},\"f:version\":{}},\"f:uid\":{},\"f:user\":{}}}}]},\"spec\":{\"resourceAttributes\":{\"verb\":\"get\",\"version\":\"v1\",\"resource\":\"nodes\",\"subresource\":\"metrics\",\"name\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"user\":\"system:serviceaccount:monitoring24:coralogix-opentelemetry-collector\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:monitoring24\",\"system:authenticated\"],\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"coralogix-opentelemetry-collector-8497849d4-9bmvl\"],\"authentication.kubernetes.io/pod-uid\":[\"1bd6c1e0-5d2c-4d85-9a3b-1e3c838e3dc1\"]},\"uid\":\"3772d3fb-8c4e-4af6-be48-924e91cfe7d4\"},\"status\":{\"allowed\":true,\"reason\":\"RBAC: allowed by ClusterRoleBinding \\\"coralogix-opentelemetry-collector\\\" of ClusterRole \\\"coralogix-opentelemetry-collector\\\" to ServiceAccount \\\"coralogix-opentelemetry-collector/monitoring24\\\"\"}},\"user\":{\"username\":\"system:node:ip-172-31-43-38.us-east-2.compute.internal\",\"uid\":\"aws-iam-authenticator:074157727657:AROARCRBFD6U5I6XD6RHO\",\"groups\":[\"system:bootstrappers\",\"system:nodes\",\"system:authenticated\"],\"extra\":{\"accessKeyId\":[\"ASIARCRBFD6UYC7YIWNE\"],\"arn\":[\"arn:aws:sts::074157727657:assumed-role/eks-nodes/i-0b423258572c23bf6\"],\"canonicalArn\":[\"arn:aws:iam::074157727657:role/eks-nodes\"],\"principalId\":[\"AROARCRBFD6U5I6XD6RHO\"],\"sessionName\":[\"i-0b423258572c23bf6\"],\"sigs.k8s.io/aws-iam-authenticator/principalId\":[\"AROARCRBFD6U5I6XD6RHO\"]}},\"level\":\"RequestResponse\",\"annotations\":{\"authorization.k8s.io/decision\":\"allow\",\"authorization.k8s.io/reason\":\"\"},\"stageTimestamp\":\"2024-10-10T15:39:56.576301Z\",\"requestReceivedTimestamp\":\"2024-10-10T15:39:56.573475Z\",\"verb\":\"create\",\"kind\":\"Event\",\"apiVersion\":\"audit.k8s.io/v1\"}\n}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"statusObject\":{",
                    "rule": "\"status\"\\s*?:\\s*?\\{"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "345e951e-5e2e-51ff-ba31-54718aa693f4",
            "rules": [
              {
                "id": "cfd81619-cdee-4d9a-ab93-17b0ecca07f8",
                "name": "app abuse",
                "description": "There's a field called \"app\" which is just text, and many of type \"app.kubernetes.io/<xxx>\" which are also text, but the dot notation makes it think app is an object. Rename \"app\" since it's rarely there\n\"labels\":{\n\"app\":\"cartservice\",\n\"pod-template-hash\":\"5df6bd977\"\n}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"application\":",
                    "rule": "\"app\"\\s*:"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          }
        ],
        "order": 26
      },
      {
        "id": "524a8f19-9087-4ec6-80eb-53d33d6ffcdb",
        "name": "Extract http method and response code",
        "description": "",
        "creator": "support@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "551ddf0b-02b6-49d1-b9f1-356f0751501f",
            "rules": [
              {
                "id": "d2927918-a159-4e61-a4f8-b34cca3c5b77",
                "name": "method and response",
                "description": "",
                "sourceField": "text.body",
                "parameters": {
                  "extractParameters": {
                    "rule": "\"(?P<method>[A-Z]+) [^\"]+\" (?P<status_code>\\d{3})\n"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 27
      },
      {
        "id": "d4474ce2-ed5d-4662-afea-67ac389f6d9b",
        "name": "ruben rule to remove",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "statuspage"
            }
          },
          {
            "subsystemName": {
              "value": "coralogix-ebpf-profiler"
            }
          },
          {
            "severity": {
              "value": "VALUE_DEBUG_OR_UNSPECIFIED"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "223e39bc-e04b-4926-884d-cc356ff917e3",
            "rules": [
              {
                "id": "677493bd-8471-4ef0-82ce-20fff5d2d85d",
                "name": "aasdasd",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "removeFieldsParameters": {
                    "fields": [
                      "requestParameters.encryptionContext.aws:lambda:FunctionArn"
                    ]
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 28
      }
    ],
    "resource_identifiers": [
      "Quota",
      "k8s Opentelemetry parsing",
      "Db Snapshot Made Public (Security)",
      "Data Normalization - GitHub (Security)",
      "AWS CloudTrail - max fields - stringifying fields (Security)",
      "Data Normalization - GuardDuty (Security)",
      "Data Normalization - CrowdStrike (Security).",
      "AWS CloudTrail - AMI Made Public (Security)",
      "Data Normalization - CloudTrail (Security)",
      "k8s Opentelemetry parsing",
      "AWS status rules",
      "Cloudtrail rules",
      "Replace AWS host name with host ip - For metrics correlation",
      "PII - Mask Email addresses",
      "PII - Block Payment Details",
      "Parse payment info",
      "Default Subsystem - Demo - Parsing",
      "Frontend Service Parsing Rules",
      "Parse frontend product info",
      "OB - Error to Message",
      "Product stats",
      "Extract service from cx.metadata",
      "Parse AWS-ELB",
      "Windows - rename host",
      "Parse prometheus-server logs",
      "Severity Rules",
      "kube",
      "Extract http method and response code",
      "ruben rule to remove"
    ]
  },
  "teamb": {
    "count": 28,
    "resources": [
      {
        "id": "ff8b3f1e-4e2d-4bdd-a452-628157e93957",
        "name": "k8s Opentelemetry parsing",
        "description": "k8s Opentelemetry extension pack",
        "creator": "k8s Opentelemetry extension pack",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "643a2f84-0112-476f-996f-e9447a081907",
            "rules": [
              {
                "id": "1a6c2183-64c6-4535-bb6b-400707e74b7b",
                "name": "Stringify logRecord",
                "description": "",
                "sourceField": "text.logRecord",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.logRecord_tmp",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "43e068ce-00e2-4ae9-86b8-54a918e934fa",
            "rules": [
              {
                "id": "1cb00aef-b1e0-4ba2-b778-9555a1137b64",
                "name": "Parse json logRecord_tmp",
                "description": "",
                "sourceField": "text.logRecord_tmp",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "6daefde9-112f-4816-98c5-6b557a30418f",
            "rules": [
              {
                "id": "f65f1322-45d4-443f-b0a3-40f6c21a15de",
                "name": "Parse json body",
                "description": "",
                "sourceField": "text.body",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "b7f3cf19-f7eb-4b8c-8710-a1edf14cf591",
            "rules": [
              {
                "id": "417353fc-6e72-48d0-aa0b-0ee5b767f3a8",
                "name": "map deprecatedLastTimestamp, eventTime as datetime fields",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"${1}_custom_timestamp\":\"",
                    "rule": "\"(deprecatedLastTimestamp|eventTime)\":\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 4
          },
          {
            "id": "4e6ef1cd-618c-488e-a5d9-b00f557366da",
            "rules": [
              {
                "id": "023c5cba-7852-4f42-b0b0-74f9c43939ef",
                "name": "fix mapping exception for infra collector empty f:annotations",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "${1}\"f:workflow\":{",
                    "rule": "(\"f:annotations\":\\{.*?)\"\\.\":\\{"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 5
          },
          {
            "id": "6fbd1594-719e-4852-aeda-4887da4d8a63",
            "rules": [
              {
                "id": "a2f3877a-cf91-484b-a7dd-7083fc8f7b77",
                "name": "Parse common logs from k8s containers",
                "description": "This rule parses containers: kube-apiserver, kube-controller-manager, kube-proxy, kube-scheduler, storage-provisioner.",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"message\":\"$message\"",
                    "rule": "\"body\":\"(?P<level>[A-Z])(?P<timestamp>\\d{4} \\d{2}:\\d{2}:\\d{2}\\.\\d+)\\s*1 (?P<caller>[^\\]]+)\\] (?P<message>(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "97164db6-86e0-451f-a6ae-e5c77d35f432",
                "name": "Replace body with kvPairs when body is a kv pairs message starts with time",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"kvPairs\":\"${1}\"",
                    "rule": "\"body\":\"(time=\\\\\"(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 2
              },
              {
                "id": "dd0bf319-04f6-48d6-bf7b-eef14ae619fa",
                "name": "Replace body with kvPairs when body is a kv pairs message starts with ts",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"kvPairs\":\"${1}\"",
                    "rule": "\"body\":\"(ts=\\d{4}(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 3
              },
              {
                "id": "4ecdf7b2-cd93-4cd9-b39b-8ad5ead3dc96",
                "name": "Replace body with kvPairs when body is a kv pairs message starts with level",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"kvPairs\":\"${1}\"",
                    "rule": "\"body\":\"(level=(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 4
              }
            ],
            "enabled": true,
            "order": 6
          },
          {
            "id": "132fe921-e086-4411-8edb-7c8c797fad90",
            "rules": [
              {
                "id": "ca7fab9c-9b08-4f5d-9a38-f73817c3fc3d",
                "name": "Extract msg from kvPairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "extractParameters": {
                    "rule": "msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 7
          },
          {
            "id": "8afb44a2-2105-4ab1-a7ef-edb9310c0e8c",
            "rules": [
              {
                "id": "390ff1aa-7fb2-4ee5-b8b8-ad78b53f9d28",
                "name": "Remove msg from kvPairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\s+msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 8
          },
          {
            "id": "4a76b571-e458-4315-aad0-cce4c976ccd4",
            "rules": [
              {
                "id": "84699129-fe31-4072-ba23-aacb6e96ffe5",
                "name": "Extract query from kvPairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "extractParameters": {
                    "rule": "query=\\\\\"(?P<query>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "4f9f5d97-6387-45ec-9774-a312bbcbc738",
                "name": "Extract query from kvPairs when kvPairs also had msg in it along with query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "extractParameters": {
                    "rule": "query=\\\\\\\\\\\\\"(?P<query>(?:\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                  }
                },
                "enabled": true,
                "order": 2
              }
            ],
            "enabled": true,
            "order": 9
          },
          {
            "id": "3489ce2f-75ce-425f-ba1c-1b7386e9e503",
            "rules": [
              {
                "id": "1006697f-c9f5-4b41-9315-e5d9cc1812a8",
                "name": "remove query from kvPairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\s+query=\\\\\"(?P<query>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "2caa93aa-55d0-436b-9c4d-114d3cbeb918",
                "name": "remove query from kvPairs when kvPairs also had msg in it along with query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\s+query=\\\\\\\\\\\\\"(?P<query>(?:\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                  }
                },
                "enabled": true,
                "order": 2
              }
            ],
            "enabled": true,
            "order": 10
          },
          {
            "id": "1d09522e-4847-464e-88a2-0cc4c7c9024b",
            "rules": [
              {
                "id": "00cc8668-64ef-4c56-b14f-628af5b1c0f9",
                "name": "prepare all the rest of the fields in a kvPairs field that had both msg and query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                    "rule": "([\\w\\.\\-\\_]+)=\\\\{7}\"((?:\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\+\"|[^\"])+)\\\\{7}\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "3fd58623-d2f1-496a-a192-15cc4e905ab9",
                "name": "prepare all the rest of the fields in a kvPairs field that had either msg or query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                    "rule": "([\\w\\.\\-\\_]+)=\\\\{3}\"((?:\\\\\\\\\\\\\\\\+\"|[^\"])+)\\\\{3}\""
                  }
                },
                "enabled": true,
                "order": 2
              }
            ],
            "enabled": true,
            "order": 11
          },
          {
            "id": "22d2b45c-bf2b-4994-b649-46d3b7fd2bad",
            "rules": [
              {
                "id": "65858f6f-c458-477d-9f11-070031166c3e",
                "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had both msg and query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\\\{15,}\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "06f71db8-27f9-47ff-ad3e-f43b64148b1c",
                "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had either msg or query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\\\{7,}\""
                  }
                },
                "enabled": true,
                "order": 2
              },
              {
                "id": "97cd460c-3b6b-4b70-9478-75bbd0e313ea",
                "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had no msg or query",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\\\{3,}\""
                  }
                },
                "enabled": true,
                "order": 3
              }
            ],
            "enabled": true,
            "order": 12
          },
          {
            "id": "0515bf38-1b94-4703-8dc5-5661119fd066",
            "rules": [
              {
                "id": "56bf5d24-f8f0-4b91-9ae7-2d3136a8fd56",
                "name": "Replace all remaining occurrences of double quotes with their corresponding backslash with \u00a7",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7",
                    "rule": "\\\\+\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 13
          },
          {
            "id": "d6d4769d-1cac-42dc-9428-4ca4b13e2d97",
            "rules": [
              {
                "id": "3b403665-9c6c-4a4a-b61d-9fa09d64e933",
                "name": "wrap the keys of the key/val pairs with \u00a7 wrapping the value with \u00a7",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                    "rule": "([\\w\\.\\-]+)=\\xA7([^\\xA7]*)\\xA7"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 14
          },
          {
            "id": "ed850c81-6e39-4bf4-8719-586c1dcb4b2d",
            "rules": [
              {
                "id": "9b657cfc-91d9-4609-bae8-947c963e9114",
                "name": "Adding to the rest of key/val pairs \u00a7 before and after the keys and values",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                    "rule": "([\\w\\.\\-\\_]+)=((?:$|[^ ])*)(?: |$)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 15
          },
          {
            "id": "c17f9741-afbf-423d-8d82-a21991acd7db",
            "rules": [
              {
                "id": "bd379f32-12c1-40de-af06-c89e6a429329",
                "name": "Adding commas between key/val pairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "${1}:${2},",
                    "rule": "(\\xA7[^\\xA7]*\\xA7):(\\xA7[^\\xA7]*\\xA7)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 16
          },
          {
            "id": "46bfc6dd-79ae-4df5-be80-deb2afc50046",
            "rules": [
              {
                "id": "36694360-5f33-40b6-8a35-1489de1609bd",
                "name": "Remove last comma before jsonizing kvPairs field",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "{$1}",
                    "rule": "(.*),"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 17
          },
          {
            "id": "1024c05d-c0a3-4b19-acbe-4c4872e1c821",
            "rules": [
              {
                "id": "32ddf2e1-53df-4660-9b35-88ce0dbe2469",
                "name": "Replacing \u00a7 with \" to jsonize kvPairs in order to get a valid JSON",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\"",
                    "rule": "\\xA7"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 18
          },
          {
            "id": "1b3e705e-c9cb-43fb-828c-97dcbacca5bb",
            "rules": [
              {
                "id": "73560043-07cf-4900-b95b-4cecad05a0cd",
                "name": "reformat kvPairs field back to an escaped JSON string format",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.kvPairs_tmp",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 19
          },
          {
            "id": "d2f95f66-650e-4a8f-86fc-b9338b98e933",
            "rules": [
              {
                "id": "f141bb48-c68a-4e55-9b91-69329725a8cc",
                "name": "Parse kvPairs_tmp as JSON to root",
                "description": "",
                "sourceField": "text.kvPairs_tmp",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 20
          }
        ],
        "order": 1
      },
      {
        "id": "60edf077-258f-4c08-9575-07ef7d06ec10",
        "name": "Db Snapshot Made Public (Security)",
        "description": "",
        "creator": "AWS-Application",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "c2c9311b-e64b-403b-a01a-71d28232fefa",
            "rules": [
              {
                "id": "9a6d53ea-7fd1-4162-a708-6ba72157ba73",
                "name": "DB snapshot made public ",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"db_snapshot_made_public\":\"true\"$1",
                    "rule": "\"dBSnapshotAttributes\"\\s*:\\s*\\[\\s*\\{\\s*\"attributeName\"\\s*:\\s*\"restore\"\\s*,\\s*\"attributeValues\"\\s*:\\s*\\[\\s*\"all\"\\s*\\]\\s*\\}\\s*\\]"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 2
      },
      {
        "id": "4ab049cd-a1da-4d02-967f-4c026b8e82f7",
        "name": "Data Normalization - GitHub (Security)",
        "description": "",
        "creator": "GitHub",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "13af9521-a4b2-4e7c-9d21-a0cd026087da",
            "rules": [
              {
                "id": "506501bb-09b5-421a-b0c9-484e76a8acf1",
                "name": "Event Name",
                "description": "",
                "sourceField": "text.github.action",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<event_name>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "19aba216-a882-4241-89a2-3610ff432fa6",
            "rules": [
              {
                "id": "3b9c1d67-67d2-4486-9910-aada52864c40",
                "name": "User Name",
                "description": "",
                "sourceField": "text.github.sender.login",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<username>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "dec9d5a7-5c41-4a53-83c2-368707cd2610",
            "rules": [
              {
                "id": "cbc0d72b-da79-46a5-ab91-415432cda548",
                "name": "Source",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$1\"source\":\"GitHub\",\"service\":\"GitHub\",$2",
                    "rule": "(.*\"cx_security\":{)(.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          }
        ],
        "order": 3
      },
      {
        "id": "e2d2ee06-e76f-493d-bb1c-23a5a8f11785",
        "name": "AWS CloudTrail - max fields - stringifying fields (Security)",
        "description": "",
        "creator": "AWS CloudTrail - Security Extension",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "6ef334bb-1cf6-4476-b42b-f80f03a0298f",
            "rules": [
              {
                "id": "45ca1171-40aa-4abf-814a-e8f1f6a0bbed",
                "name": "tlsDetails",
                "description": "",
                "sourceField": "text.tlsDetails",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.tlsDetails_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "192259b1-2877-4418-9560-3ca07bc7b8cf",
            "rules": [
              {
                "id": "8503e670-8bfd-429e-8a94-5a6b2196b259",
                "name": "resources",
                "description": "",
                "sourceField": "text.resources",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.resources_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "d8c3b87e-3d9d-4387-b50a-e3fbdd884f88",
            "rules": [
              {
                "id": "64a16f60-e782-435c-9143-9bb2a22a7d32",
                "name": "requestParameters.actions",
                "description": "",
                "sourceField": "text.requestParameters.actions",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.requestParameters.actions_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "e7ac50dd-53de-45ad-a789-7534f9ea67c9",
            "rules": [
              {
                "id": "4768a48d-5ac4-4469-b50e-b38d5f39d624",
                "name": "requestParameters.conditions",
                "description": "",
                "sourceField": "text.requestParameters.conditions",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.requestParameters.conditions_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 4
          },
          {
            "id": "d1053aab-9b50-4f90-bd6c-7ee722efdf5b",
            "rules": [
              {
                "id": "3a2f2f6d-716f-4945-a76d-8b0a5a5592a1",
                "name": "requestParameters.ipPermissions.items",
                "description": "",
                "sourceField": "text.requestParameters.ipPermissions.items",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.requestParameters.ipPermissions.items_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 5
          },
          {
            "id": "c1ca4b57-4785-413f-bd5c-c2cd3bbc183d",
            "rules": [
              {
                "id": "6f704404-fc0d-452f-9282-e5aa5e432899",
                "name": "requestParameters.tags",
                "description": "",
                "sourceField": "text.requestParameters.tags",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.requestParameters.tags_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 6
          },
          {
            "id": "d3865383-544b-4fac-81e2-a77207f52900",
            "rules": [
              {
                "id": "77af09ae-2afa-4051-9a68-eff2fbd2787e",
                "name": "responseElements.policy.tags",
                "description": "",
                "sourceField": "text.responseElements.policy.tags",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.responseElements.policy.tags_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 7
          },
          {
            "id": "29abe0b1-7d30-4c8b-8a23-5efc93caebcd",
            "rules": [
              {
                "id": "67b448ae-5d7f-4ac7-93f7-404a5d1d56bf",
                "name": "responseElements.loadBalancers",
                "description": "",
                "sourceField": "text.responseElements.loadBalancers",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.responseElements.loadBalancers_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 8
          },
          {
            "id": "7c9fe3eb-7466-4c05-9bf5-0c0a05b57928",
            "rules": [
              {
                "id": "0cc249f8-9d55-490f-99ba-3e326556278b",
                "name": "responseElements.rules",
                "description": "",
                "sourceField": "text.responseElements.rules",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.responseElements.rules_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 9
          },
          {
            "id": "9f81f838-ba1f-4968-aabe-5f7da5b0262d",
            "rules": [
              {
                "id": "95bc51d2-13f4-4c17-b229-b1d6dcaaa1d7",
                "name": "responseElements.instancesSet.items",
                "description": "",
                "sourceField": "text.responseElements.instancesSet.items",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.responseElements.instancesSet.items_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 10
          },
          {
            "id": "32d4f5dc-7055-47eb-86f3-383145f4a086",
            "rules": [
              {
                "id": "e3624c64-4cf3-4aed-92f3-f76130fbb16a",
                "name": "responseObject.metadata.managedFields",
                "description": "",
                "sourceField": "text.responseObject.metadata.managedFields",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.responseObject.metadata.managedFields_str",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 11
          }
        ],
        "order": 4
      },
      {
        "id": "ad59a8df-08fb-4807-8aa4-28927e2a7837",
        "name": "Data Normalization - GuardDuty (Security)",
        "description": "",
        "creator": "STAa",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "074157727657"
            }
          },
          {
            "subsystemName": {
              "value": "adservice"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "e9de5a47-3651-400e-acb9-c5eeeca2c8f5",
            "rules": [
              {
                "id": "7ff9be7c-c738-4f15-a791-3bc6a8403ef4",
                "name": "Event Name",
                "description": "",
                "sourceField": "text.detail.type",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<event_name>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "fda5839d-4c9c-4b26-84fd-8c6245f840d1",
            "rules": [
              {
                "id": "fcdf4d7c-0ca0-4412-8178-eca82901e5dd",
                "name": "Resource",
                "description": "",
                "sourceField": "text.detail.resource.instancedetails.instanceid",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<resource>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "f2560c3f-2a0d-43c1-9c23-872dd5f1da9c",
            "rules": [
              {
                "id": "3eff1ea1-bc7d-4d18-8314-32c07a4e6d5a",
                "name": "Source Host Name",
                "description": "",
                "sourceField": "text.detail.resource.instanceDetails.networkInterfaces.privateDnsName",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<source_hostname>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "bb03bf79-f720-4704-ab54-99f54ae20707",
            "rules": [
              {
                "id": "b163f8fb-507c-4945-8da7-ef5abccdcdc6",
                "name": "Source IP",
                "description": "",
                "sourceField": "text.detail.resource.instanceDetails.networkInterfaces.privateIpAddress",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<source_ip>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 4
          },
          {
            "id": "8e02accc-b57e-44bd-b963-e087f3c82812",
            "rules": [
              {
                "id": "0c1ad87b-0e38-4755-90c2-09f23779df1f",
                "name": "Source",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$1\"source\":\"AWS\",\"service\":\"GuardDuty\",$2",
                    "rule": "(.*\"cx_security\":{)(.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 5
          }
        ],
        "order": 5
      },
      {
        "id": "8bd4d20e-8f5c-4a27-88f2-af788cd7d807",
        "name": "Data Normalization - CrowdStrike (Security).",
        "description": ".",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "app-demo"
            }
          },
          {
            "subsystemName": {
              "value": "audit-logs"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "1a7e0139-213a-402f-9130-ce17fab30174",
            "rules": [
              {
                "id": "5aacd399-5aec-4b30-a6b4-82d6bffb5455",
                "name": "Email",
                "description": "",
                "sourceField": "text.event.UserId",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<email>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "74cb9ccf-da6b-4111-bad8-2ec528b5d61f",
            "rules": [
              {
                "id": "5088d3a1-cb49-4660-84bf-062d0ebb73e2",
                "name": "Event Name",
                "description": "",
                "sourceField": "text.metadata.eventType",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<event_name>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "c26c43c8-4417-493c-a28b-eade266fdce5",
            "rules": [
              {
                "id": "c9900f3a-44db-4262-875c-568377911ca2",
                "name": "Source IP",
                "description": "",
                "sourceField": "text.event.UserIp",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<source_ip>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "7d8d1645-434a-4a62-90dd-c5a0ab0e347e",
            "rules": [
              {
                "id": "557aedeb-bc51-4aef-93cb-cd71ee08a32c",
                "name": "Source",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$1\"source\":\"CrowdStrike\",\"service\":\"CrowdStrike\",$2",
                    "rule": "(.*\"cx_security\":{)(.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 4
          }
        ],
        "order": 6
      },
      {
        "id": "9bbdc67a-3d08-48d1-860c-93f237c7250c",
        "name": "AWS CloudTrail - AMI Made Public (Security)",
        "description": "",
        "creator": "AWS-Application",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "ef23d15d-f90a-4369-bea0-5bc24bb1536c",
            "rules": [
              {
                "id": "8c2d5a2b-7c59-4ba4-8f57-d6b1b34250a6",
                "name": "Array converter",
                "description": "creates a new object called \"group_all\" with the value of \"true\" when exists to be detected by the corresponding alert",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"ami_made_public\":\"true\"$1",
                    "rule": "\"launchPermission\"\\s*:\\s*\\{\\s*\"add\"\\s*:\\s*\\{\\s*\"items\"\\s*:\\s*\\[\\s*\\{\\s*\"group\"\\s*:\\s*\"all\"\\s*\\}\\s*\\]\\s*\\}\\s*\\}"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 7
      },
      {
        "id": "9f7304d8-077a-4d39-8c11-c1842c765d02",
        "name": "Data Normalization - CloudTrail (Security)",
        "description": "",
        "creator": "CloudTrail",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "247a1849-9d5e-49e7-aec2-2307451234c3",
            "rules": [
              {
                "id": "3ef84db5-bf4c-4b05-b768-6f33c6765786",
                "name": "Event Name",
                "description": "",
                "sourceField": "text.eventName",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<event_name>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "4204e598-941c-40a4-b8bb-717e3654f467",
            "rules": [
              {
                "id": "84885d86-0818-46b0-9d2d-a134bc182f20",
                "name": "Resource",
                "description": "",
                "sourceField": "text.userIdentity.sessionContext.sessionIssuer.arn",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<resource>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "91fd2c9a-d0a5-4730-8e5a-674f73a490d4",
            "rules": [
              {
                "id": "04970d29-b0d7-4f55-8872-71f3ad8f0f1f",
                "name": "Source IP",
                "description": "",
                "sourceField": "text.sourceIPAddress",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<source_ip>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "f8d27811-7387-430a-9a45-568f9d9ff416",
            "rules": [
              {
                "id": "b195d575-1353-4b5b-8f82-1366ed2c207b",
                "name": "User Name",
                "description": "",
                "sourceField": "text.userIdentity.sessionContext.sessionIssuer.userName",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text.cx_security",
                    "rule": "(?P<username>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 4
          },
          {
            "id": "a0320deb-7c43-4bf7-ab30-a3f0f32d0224",
            "rules": [
              {
                "id": "2246c3c1-3b11-4a22-bd94-4e2f0dfa3f89",
                "name": "Source",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$1\"source\":\"AWS\",\"service\":\"CloudTrail\",$2",
                    "rule": "(.*\"cx_security\":{)(.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 5
          }
        ],
        "order": 8
      },
      {
        "id": "12770c3f-7845-4e76-8747-5116bcb0d935",
        "name": "k8s Opentelemetry parsing",
        "description": "k8s Opentelemetry extension pack",
        "creator": "jasvinder.atwal@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "317874d6-c427-4b64-8d32-d1198342cd94",
            "rules": [
              {
                "id": "61552d35-5075-4bb6-bc14-b1bcdfc48d28",
                "name": "Stringify logRecord",
                "description": "",
                "sourceField": "text.logRecord",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.logRecord_tmp",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "d5221fbb-28e8-43d5-b8d1-7a2ade93ca3f",
            "rules": [
              {
                "id": "80a5474d-4713-4959-bdc3-6cf22bc7ae69",
                "name": "Parse json logRecord_tmp",
                "description": "",
                "sourceField": "text.logRecord_tmp",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "81f57881-a20c-45e3-a769-592754741b95",
            "rules": [
              {
                "id": "6d301367-032f-4cd6-aa8b-dc33536db5d1",
                "name": "Stringify body",
                "description": "",
                "sourceField": "text.body",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.body_tmp",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "e092a88f-1d74-4636-9f98-b6e638656362",
            "rules": [
              {
                "id": "f3c7f66a-bcb7-4722-a4e1-055124229b2f",
                "name": "Parse json body",
                "description": "",
                "sourceField": "text.body",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "134c0194-c059-450b-9967-907344aba086",
                "name": "Parse json body_tmp",
                "description": "",
                "sourceField": "text.body_tmp",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 2
              }
            ],
            "enabled": true,
            "order": 4
          },
          {
            "id": "d7a51992-d4dd-4df3-9ba7-e0ed64f7e6e8",
            "rules": [
              {
                "id": "0cc2996d-57ca-4278-92fe-69cadcb1ddeb",
                "name": "Replacing all dots within field names with underscores",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"${1}_${2}_${3}_${4}_${5}_${6}_${7}_${8}_${9}_${10}\":",
                    "rule": "\"([a-zA-Z\\d\\_]+)\\.([a-zA-Z\\d\\_]+)(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?\":"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 5
          },
          {
            "id": "1c915d6b-49b4-4902-aa54-fbb86a3af7a6",
            "rules": [
              {
                "id": "9645be10-ddf1-412a-a58e-31b759afdda7",
                "name": "Remove trailing underscores",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"$1\":",
                    "rule": "\"([^\"]+?)\\_+\":"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 6
          },
          {
            "id": "8344699f-41c6-440e-99d2-4f74adc04fb5",
            "rules": [
              {
                "id": "0c2745aa-1dec-4fa7-9a82-cef63687bea4",
                "name": "map deprecatedLastTimestamp, eventTime as datetime fields",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"${1}_custom_timestamp\":\"",
                    "rule": "\"(deprecatedLastTimestamp|eventTime)\":\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 7
          },
          {
            "id": "ad9475a8-698e-4858-8bc9-846860a5d28b",
            "rules": [
              {
                "id": "12af09f4-0e12-4d91-89d5-000dc69f01f1",
                "name": "fix mapping exception for infra collector empty f:annotations",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "${1}\"f:workflow\":{",
                    "rule": "(\"f:annotations\":\\{.*?)\"\\.\":\\{"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 8
          },
          {
            "id": "a28098df-6da3-4799-93a6-8001a4871760",
            "rules": [
              {
                "id": "85caf4f1-e105-48bc-8ce3-5f63db98dfd7",
                "name": "Parse common logs from k8s containers",
                "description": "This rule parses containers: kube-apiserver, kube-controller-manager, kube-proxy, kube-scheduler, storage-provisioner.",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"message\":\"$message\"",
                    "rule": "\"body\":\"(?P<level>[A-Z])(?P<timestamp>\\d{4} \\d{2}:\\d{2}:\\d{2}\\.\\d+)\\s*1 (?P<caller>[^\\]]+)\\] (?P<message>(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "6a61b5c1-30c5-4a25-8178-1cfe4e49ec79",
                "name": "Replace body with kvPairs when body is a kv pairs message starts with time",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"kvPairs\":\"${1}\"",
                    "rule": "\"body\":\"(time=\\\\\"(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 2
              },
              {
                "id": "75ce7487-9606-4aff-8b99-9a06ecb4e073",
                "name": "Replace body with kvPairs when body is a kv pairs message starts with ts",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"kvPairs\":\"${1}\"",
                    "rule": "\"body\":\"(ts=\\d{4}(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                  }
                },
                "enabled": true,
                "order": 3
              }
            ],
            "enabled": true,
            "order": 9
          },
          {
            "id": "05229bb8-c5c7-4b0c-9906-91f4f061da52",
            "rules": [
              {
                "id": "4d3dcf03-3efa-425b-a6dc-82ef1b065ce6",
                "name": "Extract msg from kvPairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "extractParameters": {
                    "rule": "msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 10
          },
          {
            "id": "ac13d509-4d40-4243-84e9-16c4301a6690",
            "rules": [
              {
                "id": "18bc39a0-e587-484e-9b4a-5c15ad925d1a",
                "name": "Remove msg from kvPairs",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\smsg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 11
          },
          {
            "id": "c4c20d55-9deb-45c2-8e09-713bed203513",
            "rules": [
              {
                "id": "abf88ab5-2c8f-492e-9813-8fb96a8042da",
                "name": "Jsonizing key/vals when val is enclosed with double quotes",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7$1\u00a7:\u00a7$2\u00a7,",
                    "rule": "([\\w\\.\\-]+)=\\\\\\\\\\\\\"((?:\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 12
          },
          {
            "id": "002b6b34-8b17-44a4-a268-58e35c4d6837",
            "rules": [
              {
                "id": "c619e897-c9dc-45bf-969c-1d2fddec5f40",
                "name": "Remove any remaining backslashes followed by double quotes",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "",
                    "rule": "\\\\+\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 13
          },
          {
            "id": "630d1ba5-3f91-4d8d-a985-9ddbfd394d26",
            "rules": [
              {
                "id": "865fc5f0-d753-427c-8a81-449b1e1d717c",
                "name": "Jsonizing rest of key/vals",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\u00a7$1\u00a7:\u00a7$2\u00a7,",
                    "rule": "([\\w\\.\\-]+)=((?:$|[^ \\xA7])+)?(?: |$)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 14
          },
          {
            "id": "3454591c-1249-4162-8a51-73fe9b398bb1",
            "rules": [
              {
                "id": "ad7ec16f-0d33-426f-bbb9-72e6fd16b0d9",
                "name": "Removing last Comma and wrapping with curly brackets",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "{$1}",
                    "rule": "(.*),"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 15
          },
          {
            "id": "dba9e606-2312-467c-ad23-2e7761ac8b72",
            "rules": [
              {
                "id": "86a22ea8-e603-4fbe-9237-23b600d6d313",
                "name": "Replacing \u00a7 with double quotes in order to get a valid JSON",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text.kvPairs",
                    "replaceNewVal": "\"",
                    "rule": "\\xA7"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 16
          },
          {
            "id": "a7c419dd-8d6d-44fa-8c62-f862f7705cf5",
            "rules": [
              {
                "id": "a4acf9aa-4e32-450b-a9c1-dfdb5b498bc9",
                "name": "reformat kvPairs field back to an escaped JSON string format",
                "description": "",
                "sourceField": "text.kvPairs",
                "parameters": {
                  "jsonStringifyParameters": {
                    "destinationField": "text.kvPairs_tmp",
                    "deleteSource": true
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 17
          },
          {
            "id": "c428ceb6-7aab-4550-9650-ef79616b780b",
            "rules": [
              {
                "id": "04534746-4b29-4f55-9497-d0f12e207835",
                "name": "Parse kvPairs_tmp as JSON to root",
                "description": "",
                "sourceField": "text.kvPairs_tmp",
                "parameters": {
                  "jsonParseParameters": {
                    "destinationField": "text",
                    "deleteSource": true,
                    "escapedValue": null,
                    "overrideDest": false
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 18
          },
          {
            "id": "803f2351-6df2-4a95-ab0e-92b1bd0006a1",
            "rules": [
              {
                "id": "9292efaf-14c9-474e-8100-f20ee3cd7bde",
                "name": "Extract json.trace_id ",
                "description": "{\"observedTimeUnixNano\":1744818871177174088,\"resource\":{\"attributes\":{\"k8s_pod_name\":\"frontend-69d989d8dd-tnwxc\",\"k8s_container_restart_count\":\"0\",\"k8s_pod_uid\":\"4fea94df-ac83-45af-ac5d-078a76365c38\",\"k8s_container_name\":\"server\",\"k8s_namespace_name\":\"default\",\"k8s_cluster_name\":\"onlineboutique\",\"cx_otel_integration_name\":\"coralogix-integration-helm\",\"k8s_deployment_name\":\"frontend\",\"k8s_node_name\":\"ip-172-31-14-14.us-east-2.compute.internal\",\"host_name\":\"ip-172-31-14-14.us-east-2.compute.internal\",\"os_type\":\"linux\",\"host_id\":\"i-09f3a61cd39f3ae71\",\"cloud_provider\":\"aws\",\"cloud_platform\":\"aws_ec2\",\"cloud_region\":\"us-east-2\",\"cloud_account_id\":\"074157727657\",\"cloud_availability_zone\":\"us-east-2a\",\"host_image_id\":\"ami-02b2ce7c83227ce13\",\"host_type\":\"t3.large\"}},\"timeUnixNano\":1744818871043095596,\"scope\":{\"attributes\":{}},\"resourceSchemaUrl\":\"https:\\/\\/opentelemetry.io\\/schemas\\/1.6.1\",\"json\":{\"http_req_ip_geoip\":{\"ip\":\"158.46.145.28\",\"ip_ipaddr\":\"158.46.145.28\",\"location_geopoint\":{\"lat\":52.2299,\"lon\":21.0093},\"continent_name\":\"Europe\",\"country_name\":\"Poland\",\"city_name\":\"Warsaw\",\"postal_code\":\"00-510\",\"is_local\":false,\"asn\":{\"number\":\"59729\",\"organization\":\"Green Floid LLC\"}},\"http_req_id\":\"713a8831-2aec-4670-8fb9-7bae628307b8\",\"http_req_ip\":\"158.46.145.28\",\"http_req_method\":\"GET\",\"http_req_path\":\"\\/cart\",\"session\":\"a1548467-f87d-499e-b1cf-78829da93a54\",\"severity\":\"debug\",\"span_id\":\"3e67b3e9962fcd8c\",\"timestamp\":\"2025-04-16T15:54:31.042989207Z\",\"trace_id\":\"4cd3da495f7e8399a941900b950b7bd9\"},\"attributes\":{\"log_file_path\":\"\\/var\\/log\\/pods\\/default_frontend-69d989d8dd-tnwxc_4fea94df-ac83-45af-ac5d-078a76365c38\\/server\\/0.log\",\"log_iostream\":\"stdout\",\"logtag\":\"F\",\"time\":\"2025-04-16T15:54:31.043095596Z\"}}",
                "sourceField": "text",
                "parameters": {
                  "extractParameters": {
                    "rule": "\"json\":\\{.*?\"trace_id\":\"(?P<trace_id>[^\"]+)\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 19
          }
        ],
        "order": 9
      },
      {
        "id": "39600789-e738-4c3f-be97-5aca75b6e974",
        "name": "AWS status rules",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "subsystemName": {
              "value": "aws-status"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "f64661e1-0316-416f-a20d-d54cbca01ce1",
            "rules": [
              {
                "id": "feb0cd0f-b09f-4f87-a62a-f37d4cdb34e0",
                "name": "Replace \"resolved\" messages level to INFO",
                "description": "",
                "sourceField": "text.aws.title",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "severity",
                    "replaceNewVal": "INFO",
                    "rule": "RESOLVED"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 10
      },
      {
        "id": "3bd77a6a-a6d5-4b94-b69c-83e246db856e",
        "name": "Cloudtrail rules",
        "description": "Cloudtrail extension pack",
        "creator": "Cloudtrail extension pack",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "01071fbe-d436-4644-bb5d-a9d0ff82fb11",
            "rules": [
              {
                "id": "73b3e8d6-2b80-4599-ac5c-117eed25c3b9",
                "name": "Replace Cloudtrail log severity to error if errorMessage exists",
                "description": "",
                "sourceField": "text.errorMessage",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "severity",
                    "replaceNewVal": "ERROR",
                    "rule": ".*"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 11
      },
      {
        "id": "eebbb2ee-c31c-4bb9-89d9-1aa491ace3a1",
        "name": "Replace AWS host name with host ip - For metrics correlation",
        "description": "Hey You - Adi Golan here please DO NOT DELETE this rule - Thanks! :)",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "b720a6ad-6cf4-4d79-9868-b587c8dfa6db",
            "rules": [
              {
                "id": "0c65a52e-d552-47c1-b2a4-44152292eb76",
                "name": "replace host with the host ip solely",
                "description": "{\"cloud\":{\"account\":{\"id\":\"074157727657\"},\"availability_zone\":\"us-east-2a\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-0f7afac2798217d04\"},\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"region\":\"us-east-2\",\"service\":{\"name\":\"EC2\"}},\"kubernetes\":{\"container\":{\"id\":\"dd6e99a9c3900e93bf2744fc03925544481e0d8f1a8df84aa1c68f45f888de95\",\"name\":\"server\"},\"deployment\":{\"name\":\"frontend\"},\"namespace\":\"default\",\"namespace_labels\":{\"kubernetes_io/metadata_name\":\"default\"},\"namespace_uid\":\"21a7e2d9-7da6-4a74-97f7-d04a7dbbb77a\",\"node\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"labels\":{\"beta_kubernetes_io/arch\":\"amd64\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"k8s_io/cloud-provider-aws\":\"5ae15d428da2ffa3cd3bbc9149af8ce1\",\"kubernetes_io/arch\":\"amd64\",\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"kubernetes_io/os\":\"linux\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"topology_kubernetes_io/region\":\"us-east-2\",\"topology_kubernetes_io/zone\":\"us-east-2a\"},\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"uid\":\"5a512b89-9f46-416c-874e-9572c0b38ecc\"},\"pod\":{\"ip\":\"172.31.3.40\",\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"69d989d8dd\"},\"name\":\"frontend-69d989d8dd-lbnrg\",\"uid\":\"c19d2ea0-be65-4886-8b4d-df814c967f0b\"},\"replicaset\":{\"name\":\"frontend-69d989d8dd\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2023-08-21T20:32:47.713Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"json\":{\"http_req_ip_geoip\":{\"ip\":\"34.206.39.153\",\"ip_ipaddr\":\"34.206.39.153\",\"location_geopoint\":{\"lat\":39.0469,\"lon\":-77.4903},\"continent_name\":\"North America\",\"country_name\":\"United States\",\"city_name\":\"Ashburn\",\"postal_code\":\"20149\"},\"http_req_id\":\"92313d79-b665-47eb-a0d4-7a08c7dec302\",\"http_req_ip\":\"34.206.39.153\",\"http_req_method\":\"POST\",\"http_req_path\":\"/cart\",\"http_resp_bytes\":0,\"http_resp_status\":302,\"http_resp_took_ms\":4,\"session\":\"097733bc-6386-475e-bfbc-6ada1a96e9be\",\"severity\":\"debug\",\"span_id\":\"4cf425fb8ed181d7\",\"timestamp\":\"2023-08-21T20:32:47.713652989Z\",\"trace_id\":\"f76998ff4a582250107c6a44e35ac47f\"},\"message\":\"request POST /cart completed with status: 302. requestID: 92313d79-b665-47eb-a0d4-7a08c7dec302\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"host\":\"${1}.${2}.${3}.${4}\"",
                    "rule": "\"host\":\"ip\\-(\\d{1,3})\\-(\\d{1,3})\\-(\\d{1,3})\\-(\\d{1,3})\\.[^\"]+\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 12
      },
      {
        "id": "8cf7196b-0b96-43bb-90b4-09f7dfcc903d",
        "name": "PII - Mask Email addresses",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "statuspage"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "639edeed-4916-4e6a-afd0-71bff6e5e7cb",
            "rules": [
              {
                "id": "45d4df1b-d7c7-42d4-819e-ee7488c46521",
                "name": "Mask Email addresses",
                "description": "{\"log\":\"Error on adding subscription.\",\"type\":\"we1-prd-portal-slices-product\",\"Msg_obj\":{\"Data\":{\"Arguments\":{\"SubscriptionRequest\":{\"CultureCode\":\"en-US\",\"SubscriberId\":\"test_email@gmail.com\",\"Topics\":[{\"DeliveryChannels\":[{\"Address\":\"test_email@gmail.com\",\"Platform\":\"Email\",\"Source\":\"10003_nibis_email\"}],\"Specification\":{\"CountryId\":\"165\",\"ProductId\":\"15756113\",\"Scale\":\"750\",\"Size\":\"27\"},\"TypeId\":\"BackInStock\"}]}},\"Class\":\"Farfetch.Web.Slices.Product.Infrastructure.CrossCutting.Resilience.Clients.MarketingApi.ResilientSubscriptionsClient\",\"ConnectionId\":\"0HMQQJHR59PJ8\",\"Exception\":{\"ApplicationErrors\":[{\"Code\":\"500\",\"DeveloperMessage\":\"Operation canceled\",\"Exception\":{\"InnerException\":{\"InnerException\":{\"Message\":\"Operation canceled\",\"Type\":\"SocketException\"},\"Message\":\"Unable to read data from the transport connection: Operation canceled.\",\"Source\":\"System.Net.Sockets\",\"Type\":\"IOException\"},\"Message\":\"The operation was canceled.\",\"Source\":\"System.Net.Http\",\"Type\":\"TaskCanceledException\"},\"Message\":\"The operation was canceled.\"}],\"Message\":\"ApplicationErrorException containing a TaskCanceledException was thrown with error code 500.\",\"Source\":\"Farfetch.Framework.API.Client.HttpClient\",\"StackTrace\":\"   at Farfetch.Framework.API.Client.HttpClient.HttpClientConnection.ExecuteAsync(HttpMethod method, Uri uri, Object body, HttpHeader[] headers, CancellationToken cancellationToken)\\n   at Farfetch.Framework.API.Client.HttpClient.HttpClientConnection.PostAsync[TRequestBody](ApiRequest`1 request, CancellationToken cancellationToken)\\n   at Farfetch.MktApi.Client.SDK.Implementations.SubscriptionClient.AddSubscriptionAsync(SubscriptionRequest subscription, CancellationToken cancellationToken)\\n   at Polly.AsyncPolicy.<>c__DisplayClass40_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.CircuitBreaker.AsyncCircuitBreakerPolicy.<>c__DisplayClass8_0`1.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.CircuitBreaker.AsyncCircuitBreakerEngine.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext, ExceptionPredicates shouldHandleExceptionPredicates, ResultPredicates`1 shouldHandleResultPredicates, ICircuitController`1 breakerController)\\n   at Polly.CircuitBreaker.AsyncCircuitBreakerPolicy.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.Wrap.AsyncPolicyWrapEngine.<>c__DisplayClass4_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.AsyncPolicy.<>c__DisplayClass40_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Farfetch.Framework.Resilience.Policies.CustomPolicies.Engines.AsyncOffloadEngine.ExecuteAsync[TResult](Func`3 action, Context context, ConcurrentDictionary`2 circuitBreakerEvents, Boolean continueOnCapturedContext, CancellationToken cancellationToken)\\n   at Farfetch.Framework.Resilience.Policies.CustomPolicies.AsyncOffloadPolicy.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.Wrap.AsyncPolicyWrapEngine.ImplementationAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext, IAsyncPolicy outerPolicy, IAsyncPolicy innerPolicy)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.Wrap.AsyncPolicyWrapEngine.<>c__DisplayClass4_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.AsyncPolicy.<>c__DisplayClass40_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.Timeout.AsyncTimeoutEngine.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Func`2 timeoutProvider, TimeoutStrategy timeoutStrategy, Func`5 onTimeoutAsync, Boolean continueOnCapturedContext)\\n   at Polly.Timeout.AsyncTimeoutEngine.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Func`2 timeoutProvider, TimeoutStrategy timeoutStrategy, Func`5 onTimeoutAsync, Boolean continueOnCapturedContext)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.Wrap.AsyncPolicyWrapEngine.ImplementationAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext, IAsyncPolicy outerPolicy, IAsyncPolicy innerPolicy)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Farfetch.Web.Slices.Product.Infrastructure.CrossCutting.Resilience.Clients.MarketingApi.ResilientSubscriptionsClient.AddSubscriptionAsync(SubscriptionRequest subscription, CancellationToken cancellationToken) in /source/src/Infrastructure.CrossCutting.Resilience/Clients/MarketingApi/ResilientSubscriptionsClient.cs:line 42\",\"Type\":\"ApplicationErrorException\"},\"Headers\":{\"User-Agent\":\"experience-web-gateway/1.0.23139.317\",\"X-Geo-Subfolder\":\"/pt\",\"X-History-Root-Category\":\"women\",\"X-Is-Bot\":\"false\",\"X-Known-Root-Categories\":\"\\\"{\\\\u0022beauty\\\\u0022:141257,\\\\u0022kids\\\\u0022:141260,\\\\u0022men\\\\u0022:141259,\\\\u0022women\\\\u0022:141258}\\\"\",\"X-Subfolder\":\"/pt\",\"X-Tenant-Id\":\"10000\",\"X-User-Agent\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 16_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/20E252 [FBAN/FBIOS;FBDV/iPhone14,2;FBMD/iPhone;FBSN/iOS;FBSV/16.4.1;FBSS/3;FBID/phone;FBLC/pt_PT;FBOP/5]\",\"X-User-Correlation-Id\":\"6fc3fb3e-0a08-4787-af5d-c280bad73b93\",\"x-bct\":\"168885\"},\"LogType\":\"ExternalRequest\",\"Method\":\"AddSubscriptionAsync\",\"ParentId\":\"5a554e25951d7fa3\",\"RawUrl\":\"http://portal-slices-product-we1.customer.net:9059/graphql/\",\"RequestId\":\"0HMQQJHR59PJ8:00000002\",\"RequestPath\":\"/graphql/\",\"Service\":\"marketing-core-api\",\"SpanId\":\"6a837306180d85e8\",\"TraceId\":\"000000000000000036ffd3d2d9abb486\"},\"Message\":\"Error on adding subscription.\"},\"Timestamp\":\"2023-05-22T08:52:07.3771285Z\",\"stream\":\"stdout\",\"host\":\"aks-pstdspot2-26760775-vmss0001zr\",\"@version\":\"1\",\"HostName\":\"portal-slices-product-557d947474-p2rv5\",\"EventSeverity\":\"Warning\",\"kafka_topic\":\"p2_t0_app_log\",\"datacenter\":\"we1\",\"kubernetes_pod_name\":\"portal-slices-product-557d947474-p2rv5\",\"ActId\":\"963f7019-d866-4a20-9aa2-f886616629e6\",\"Thread\":\"21\",\"kubernetes_namespace_name\":\"portal-slices\",\"kubernetes_docker_id\":\"6b9575e2857338d11a0fcfe7b684c05645d655ae2ea0a921385e82ca0a344eb4\",\"_p\":\"F\",\"@timestamp\":\"2023-05-22T08:52:07.377Z\",\"stage\":\"stable\",\"kubernetes_container_hash\":\"artifacts-we1.customer.net/docker-stable/customer/portal-slices-product@sha256:dfe52ca9c25bec6537d5f5ac2cf291c7a2b32b262e162671cc916adfb8208fa5\",\"kubernetes_pod_id\":\"4e69cb06-ac70-413a-ac68-3251dd259e2b\",\"kubernetes_container_name\":\"portal-slices-product\",\"time\":\"2023-05-22T08:52:07.377552964Z\",\"kubernetes_host\":\"aks-pstdspot2-26760775-vmss0001zr\",\"fields\":{\"boundary\":\"slices\",\"clusterName\":\"we1-prd-portal-std-1\",\"dc\":\"we1\",\"environment\":\"prd\",\"fqdn\":\"aks-pstdspot2-26760775-vmss0001zr\",\"full_name\":\"portal-slices-product\",\"minion_id\":\"aks-pstdspot2-26760775-vmss0001zr\",\"name\":\"product\",\"platform\":\"portal\",\"tags\":\"json\",\"tier\":\"0\"},\"kubernetes_container_image\":\"artifacts-we1.customer.net/docker-stable/customer/portal-slices-product:1.0.23139.489\"}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "XXXXXXXXXX@XXXXXXX",
                    "rule": "(?P<email_address>([\\d\\w\\.\\-\\_]+)@([\\d\\w]+)\\.([\\w]+))"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 13
      },
      {
        "id": "bfeb367d-ba80-4873-9a72-e1b9decef436",
        "name": "PII - Block Payment Details",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": false,
        "hidden": false,
        "ruleMatchers": [
          {
            "subsystemName": {
              "value": "paymentservice"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "e7b11f1d-4bca-4ced-8be6-b89dac2a7da5",
            "rules": [
              {
                "id": "bc7ea0b7-230b-4efa-82d3-0cd3a52be3b6",
                "name": "Block payment invocation log",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "blockParameters": {
                    "keepBlockedLogs": false,
                    "rule": "PaymentService#Charge invoked"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 14
      },
      {
        "id": "6c2a568e-0a0c-4ed9-a696-8f905818ac96",
        "name": "Parse payment info",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "subsystemName": {
              "value": "paymentservice"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "fe3d286b-96f8-4325-9d8a-1ee57a1e8c2e",
            "rules": [
              {
                "id": "81ce29a2-80b7-4af9-bc4f-2aeac3d345d2",
                "name": "Parse payment info",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"pay_transaction\":{\"cc\":\"$1\",\"currency\":\"$2\",\"amount\":\"$3\"}",
                    "rule": "\"message\"\\s*:\\s*\"Transaction processed:\\s*(?P<cc>\\w+)\\s*ending\\s*\\d+\\s*Amount:\\s*(?P<currency>[A-Z]+)(?P<amount>[\\d\\.]+)\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 15
      },
      {
        "id": "f977415c-8ec9-4669-9fe7-cfb716dc9e88",
        "name": "Default Subsystem - Demo - Parsing",
        "description": "Hey You - Adi Golan here please DO NOT DELETE this rule - Thanks! :)",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "default"
            }
          },
          {
            "subsystemName": {
              "value": "frontend"
            }
          },
          {
            "subsystemName": {
              "value": "checkoutservice"
            }
          },
          {
            "subsystemName": {
              "value": "recommendationservice"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "73a679a8-d2ae-4164-98d8-4ba35377ab0d",
            "rules": [
              {
                "id": "e75282ef-090c-482b-8a02-d20ca0830187",
                "name": "Delete original message",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "removeFieldsParameters": {
                    "fields": [
                      "message"
                    ]
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "94834b45-936f-4f81-bfc9-b73205c2bcb0",
            "rules": [
              {
                "id": "ccc8b068-a193-48ff-8e6a-92effb86c45a",
                "name": "Extract Message from json.message",
                "description": "",
                "sourceField": "text.json.message",
                "parameters": {
                  "extractParameters": {
                    "rule": "(?P<message>.+)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "aa824967-48fc-4a89-a335-2b5992c0cc77",
            "rules": [
              {
                "id": "3ac982e1-3952-4f0b-ac1e-5b7c916e9c75",
                "name": "Delete json.message",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "removeFieldsParameters": {
                    "fields": [
                      "json.message"
                    ]
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          }
        ],
        "order": 16
      },
      {
        "id": "f25714a3-8db1-41fc-981e-72752b92c009",
        "name": "Frontend Service Parsing Rules",
        "description": "Created by George P for Demo Flow - Please do not delete",
        "creator": "george.boddey@coralogix.com",
        "enabled": false,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "default"
            }
          },
          {
            "subsystemName": {
              "value": "frontend"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "44293f0b-d637-45ed-8a84-0f56afb65ee0",
            "rules": [
              {
                "id": "d771c802-c549-409d-9838-04f98da9dac0",
                "name": "Filter logs where JSON already exists - step 1",
                "description": "{\"product_id_enriched\":{\"product_desc\":\"This lightweight hairdryer has 3 heat and speed settings. It's perfect for travel.\",\"product_name\":\"Hairdryer\",\"price_in_currency\":\"24\",\"product_img\":\"https://www.coralogix-demo.net/static/img/products/hairdryer.jpg\",\"currency\":\"USD\",\"category\":\"hair\"},\"json\":{\"http_req_ip_geoip\":{\"ip\":\"91.214.87.74\",\"ip_ipaddr\":\"91.214.87.74\",\"location_geopoint\":{\"lat\":50.5182,\"lon\":30.8041},\"continent_name\":\"Europe\",\"country_name\":\"Ukraine\",\"city_name\":\"Brovary\",\"postal_code\":\"07400\"},\"http_req_id\":\"eb42c8a5-1a7c-4174-acac-43ba70ede542\",\"http_req_ip\":\"91.214.87.74\",\"http_req_method\":\"GET\",\"http_req_path\":\"/product\",\"http_resp_bytes\":7893,\"http_resp_status\":200,\"http_resp_took_ms\":1180,\"session\":\"141329a7-ee0e-4c36-be93-ec85aca25dce\",\"severity\":\"debug\",\"span_id\":\"2af19aadfd800015\",\"timestamp\":\"2024-01-12T11:13:46.18049654Z\",\"trace_id\":\"ffde5d9a8da0e54d776d385c97e6a114\"},\"@timestamp\":\"2024-01-12T11:13:46.180Z\",\"@version\":\"1\",\"beat\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\"},\"cloud\":{\"account\":{\"id\":\"074157727657\"},\"availability_zone\":\"us-east-2a\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-02084e96d21517df8\"},\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"region\":\"us-east-2\",\"service\":{\"name\":\"EC2\"}},\"cluster_name\":\"cluster.local\",\"host\":\"172.31.4.242\",\"kubernetes\":{\"container\":{\"id\":\"27f46be207970279dbda825cdcea0ed0ef0a724d6ed8c41f33db3b207e845a54\",\"name\":\"server\"},\"deployment\":{\"name\":\"frontend\"},\"namespace\":\"default\",\"namespace_labels\":{\"kubernetes_io/metadata_name\":\"default\"},\"namespace_uid\":\"21a7e2d9-7da6-4a74-97f7-d04a7dbbb77a\",\"node\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"labels\":{\"beta_kubernetes_io/arch\":\"amd64\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"k8s_io/cloud-provider-aws\":\"5ae15d428da2ffa3cd3bbc9149af8ce1\",\"kubernetes_io/arch\":\"amd64\",\"kubernetes_io/hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"kubernetes_io/os\":\"linux\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"topology_kubernetes_io/region\":\"us-east-2\",\"topology_kubernetes_io/zone\":\"us-east-2a\"},\"name\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"uid\":\"c027d669-c71e-443c-b6d3-6be6b5b7e1ca\"},\"pod\":{\"ip\":\"172.31.2.154\",\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"69d989d8dd\"},\"name\":\"frontend-69d989d8dd-msq9g\",\"uid\":\"b0008d6f-730a-43e3-a4f8-b35b1670980d\"},\"replicaset\":{\"name\":\"frontend-69d989d8dd\"}},\"message\":\"request GET /product/2ZYFJ3GM2N completed with status: 200. requestID: eb42c8a5-1a7c-4174-acac-43ba70ede542\",\"product_id\":\"2ZYFJ3GM2N\",\"tags\":[\"beats_input_codec_plain_applied\"]}\n\n{\"json\":{\"http_req_ip_geoip\":{\"ip\":\"147.237.70.107\",\"ip_ipaddr\":\"147.237.70.107\",\"location_geopoint\":{\"lat\":31.5,\"lon\":34.75},\"continent_name\":\"Asia\",\"country_name\":\"Israel\",\"city_name\":null,\"postal_code\":null},\"http_req_id\":\"98b82456-1094-4523-961a-42a7c8b2e0c8\",\"http_req_ip\":\"147.237.70.107\",\"http_req_method\":\"POST\",\"http_req_path\":\"/cart/checkout\",\"session\":\"25b3ccb7-1cb5-4765-8ea6-5db7307c1bd0\",\"severity\":\"debug\",\"span_id\":\"63524cdcf612ccb9\",\"timestamp\":\"2024-01-12T11:13:45.447175815Z\",\"trace_id\":\"e1e43f802a679c21f9d66c42add6ec95\"},\"@timestamp\":\"2024-01-12T11:13:45.448Z\",\"@version\":\"1\",\"beat\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\"},\"cloud\":{\"account\":{\"id\":\"074157727657\"},\"availability_zone\":\"us-east-2a\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-02084e96d21517df8\"},\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"region\":\"us-east-2\",\"service\":{\"name\":\"EC2\"}},\"cluster_name\":\"cluster.local\",\"host\":\"172.31.4.242\",\"kubernetes\":{\"container\":{\"id\":\"27f46be207970279dbda825cdcea0ed0ef0a724d6ed8c41f33db3b207e845a54\",\"name\":\"server\"},\"deployment\":{\"name\":\"frontend\"},\"namespace\":\"default\",\"namespace_labels\":{\"kubernetes_io/metadata_name\":\"default\"},\"namespace_uid\":\"21a7e2d9-7da6-4a74-97f7-d04a7dbbb77a\",\"node\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"labels\":{\"beta_kubernetes_io/arch\":\"amd64\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"k8s_io/cloud-provider-aws\":\"5ae15d428da2ffa3cd3bbc9149af8ce1\",\"kubernetes_io/arch\":\"amd64\",\"kubernetes_io/hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"kubernetes_io/os\":\"linux\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"topology_kubernetes_io/region\":\"us-east-2\",\"topology_kubernetes_io/zone\":\"us-east-2a\"},\"name\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"uid\":\"c027d669-c71e-443c-b6d3-6be6b5b7e1ca\"},\"pod\":{\"ip\":\"172.31.2.154\",\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"69d989d8dd\"},\"name\":\"frontend-69d989d8dd-msq9g\",\"uid\":\"b0008d6f-730a-43e3-a4f8-b35b1670980d\"},\"replicaset\":{\"name\":\"frontend-69d989d8dd\"}},\"message\":\"request POST /cart/checkout started. requestID: 98b82456-1094-4523-961a-42a7c8b2e0c8\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"json1\":{",
                    "rule": "\\\"json\\\"\\:\\{"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "ccd4ac30-e311-4081-8ea2-ade353446486",
            "rules": [
              {
                "id": "f869410e-7d3e-414d-ac49-10234ea18f5b",
                "name": "Filter logs where JSON already exists - step 2",
                "description": "{\"json\":{\"http_req_ip_geoip\":{\"ip\":\"147.237.70.107\",\"ip_ipaddr\":\"147.237.70.107\",\"location_geopoint\":{\"lat\":31.5,\"lon\":34.75},\"continent_name\":\"Asia\",\"country_name\":\"Israel\",\"city_name\":null,\"postal_code\":null},\"http_req_id\":\"98b82456-1094-4523-961a-42a7c8b2e0c8\",\"http_req_ip\":\"147.237.70.107\",\"http_req_method\":\"POST\",\"http_req_path\":\"/cart/checkout\",\"session\":\"25b3ccb7-1cb5-4765-8ea6-5db7307c1bd0\",\"severity\":\"debug\",\"span_id\":\"63524cdcf612ccb9\",\"timestamp\":\"2024-01-12T11:13:45.447175815Z\",\"trace_id\":\"e1e43f802a679c21f9d66c42add6ec95\"},\"@timestamp\":\"2024-01-12T11:13:45.448Z\",\"@version\":\"1\",\"beat\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\"},\"cloud\":{\"account\":{\"id\":\"074157727657\"},\"availability_zone\":\"us-east-2a\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-02084e96d21517df8\"},\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"region\":\"us-east-2\",\"service\":{\"name\":\"EC2\"}},\"cluster_name\":\"cluster.local\",\"host\":\"172.31.4.242\",\"kubernetes\":{\"container\":{\"id\":\"27f46be207970279dbda825cdcea0ed0ef0a724d6ed8c41f33db3b207e845a54\",\"name\":\"server\"},\"deployment\":{\"name\":\"frontend\"},\"namespace\":\"default\",\"namespace_labels\":{\"kubernetes_io/metadata_name\":\"default\"},\"namespace_uid\":\"21a7e2d9-7da6-4a74-97f7-d04a7dbbb77a\",\"node\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"labels\":{\"beta_kubernetes_io/arch\":\"amd64\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"k8s_io/cloud-provider-aws\":\"5ae15d428da2ffa3cd3bbc9149af8ce1\",\"kubernetes_io/arch\":\"amd64\",\"kubernetes_io/hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"kubernetes_io/os\":\"linux\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"topology_kubernetes_io/region\":\"us-east-2\",\"topology_kubernetes_io/zone\":\"us-east-2a\"},\"name\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"uid\":\"c027d669-c71e-443c-b6d3-6be6b5b7e1ca\"},\"pod\":{\"ip\":\"172.31.2.154\",\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"69d989d8dd\"},\"name\":\"frontend-69d989d8dd-msq9g\",\"uid\":\"b0008d6f-730a-43e3-a4f8-b35b1670980d\"},\"replicaset\":{\"name\":\"frontend-69d989d8dd\"}},\"message\":\"request POST /cart/checkout started. requestID: 98b82456-1094-4523-961a-42a7c8b2e0c8\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"json\":{",
                    "rule": "\\\"json1\\\"\\:\\{"
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "7e5af3c2-28a0-427c-b21a-5a39f5e1355f",
                "name": "Nest fields under JSON if not already nested v1",
                "description": "{\"resource\":{\"attributes\":{\"cloud.account.id\":\"074157727657\",\"cloud.availability_zone\":\"us-east-2c\",\"cloud.platform\":\"aws_ec2\",\"cloud.provider\":\"aws\",\"cloud.region\":\"us-east-2\",\"cx.otel_integration.name\":\"coralogix-integration-helm\",\"host.id\":\"i-0b423258572c23bf6\",\"host.image.id\":\"ami-07b50b966251fda6e\",\"host.name\":\"ip-172-31-43-38.us-east-2.compute.internal\",\"host.type\":\"t3.large\",\"k8s.cluster.name\":\"onlineboutique\",\"k8s.container.name\":\"server\",\"k8s.container.restart_count\":\"0\",\"k8s.deployment.name\":\"frontend\",\"k8s.namespace.name\":\"default\",\"k8s.node.name\":\"ip-172-31-43-38.us-east-2.compute.internal\",\"k8s.pod.name\":\"frontend-69d989d8dd-7qc7q\",\"k8s.pod.uid\":\"144393ed-680f-4ed3-9354-f3e33871b009\",\"os.type\":\"linux\"}},\"resourceSchemaUrl\":\"https://opentelemetry.io/schemas/1.6.1\",\"scope\":{\"attributes\":{}},\"attributes\":{\"log.file.path\":\"/var/log/pods/default_frontend-69d989d8dd-7qc7q_144393ed-680f-4ed3-9354-f3e33871b009/server/0.log\",\"log.iostream\":\"stdout\",\"time\":\"2024-01-05T13:57:43.456577052Z\"},\"observedTimeUnixNano\":1704463063650460200,\"timeUnixNano\":1704463063456577000,\"http_req_id\":\"042f4b7f-1cf2-4946-a4c5-bcfe938580fa\",\"http_req_ip\":\"172.217.18.110\",\"http_req_method\":\"POST\",\"http_req_path\":\"/cart\",\"session\":\"82daafa1-0fe7-443e-b9aa-92063354954c\",\"severity\":\"debug\",\"span_id\":\"3661a7f017c4b32b\",\"timestamp\":\"2024-01-05T13:57:43.456319372Z\",\"trace_id\":\"ece78d03cd5e60160c3a7af539bf13ab\"}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$beginning\"json\":{\"http_req_id\":\"$http_req_id\",\"http_req_ip\":\"$http_req_ip\",\"http_req_method\":\"$http_req_method\",\"http_req_path\":\"$http_req_path\",\"session\":\"$session\",\"severity\":\"$severity\",\"span_id\":\"$span_id\",\"timestamp\":\"$timestamp\",\"trace_id\":\"$trace_id\"}}",
                    "rule": "(?P<beginning>.*)\\\"http_req_id\\\"\\:\\\"(?P<http_req_id>[\\w\\-]+)\\\"\\,\\\"http_req_ip\\\"\\:\\\"(?P<http_req_ip>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\\"\\,\\\"http_req_method\\\"\\:\\\"(?P<http_req_method>[\\w]+)\\\"\\,\\\"http_req_path\\\"\\:\\\"(?P<http_req_path>[\\/\\w]+)\\\"\\,\\\"session\\\"\\:\\\"(?P<session>[\\w\\-]+)\\\"\\,\\\"severity\\\"\\:\\\"(?P<severity>[\\w]+)\\\"\\,\\\"span_id\\\"\\:\\\"(?P<span_id>[\\w]+)\\\"\\,\\\"timestamp\\\"\\:\\\"(?P<timestamp>\\d{4}\\-\\d{2}\\-\\d{2}T\\d{2}\\:\\d{2}\\:\\d{2}\\.\\d{1,10}Z)\\\"\\,\\\"trace_id\\\"\\:\\\"(?P<trace_id>[\\w]+)\\\"\\}"
                  }
                },
                "enabled": true,
                "order": 2
              },
              {
                "id": "9cc33f9c-ac97-4f4c-aea0-a06aeb3dafb3",
                "name": "Nest fields under JSON if not already nested v2",
                "description": "{\"resource\":{\"attributes\":{\"cloud.account.id\":\"074157727657\",\"cloud.availability_zone\":\"us-east-2b\",\"cloud.platform\":\"aws_ec2\",\"cloud.provider\":\"aws\",\"cloud.region\":\"us-east-2\",\"cx.otel_integration.name\":\"coralogix-integration-helm\",\"host.id\":\"i-0a5b27e90b547603f\",\"host.image.id\":\"ami-07b50b966251fda6e\",\"host.name\":\"ip-172-31-30-194.us-east-2.compute.internal\",\"host.type\":\"t3.large\",\"k8s.cluster.name\":\"onlineboutique\",\"k8s.container.name\":\"server\",\"k8s.container.restart_count\":\"0\",\"k8s.deployment.name\":\"frontend\",\"k8s.namespace.name\":\"default\",\"k8s.node.name\":\"ip-172-31-30-194.us-east-2.compute.internal\",\"k8s.pod.name\":\"frontend-69d989d8dd-fvxbh\",\"k8s.pod.uid\":\"93174814-bcbd-46ef-803d-423995ae8c20\",\"os.type\":\"linux\"}},\"resourceSchemaUrl\":\"https://opentelemetry.io/schemas/1.6.1\",\"scope\":{\"attributes\":{}},\"attributes\":{\"log.file.path\":\"/var/log/pods/default_frontend-69d989d8dd-fvxbh_93174814-bcbd-46ef-803d-423995ae8c20/server/0.log\",\"log.iostream\":\"stdout\",\"time\":\"2024-01-05T13:57:43.780503549Z\"},\"observedTimeUnixNano\":1704463063948296400,\"timeUnixNano\":1704463063780503600,\"http_req_id\":\"646b6167-9fdc-4057-88e9-c74db871128f\",\"http_req_ip\":\"157.131.72.157\",\"http_req_method\":\"GET\",\"http_req_path\":\"/product/LS4PSXUNUM\",\"http_resp_bytes\":7983,\"http_resp_status\":200,\"http_resp_took_ms\":32,\"session\":\"f8112775-873c-4860-a2fa-780ac9eb40fb\",\"severity\":\"debug\",\"span_id\":\"c93746ea2fa9d733\",\"timestamp\":\"2024-01-05T13:57:43.780204274Z\",\"trace_id\":\"f040cc8be8a9609e7f186675293fe6ff\"}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$beginning\"json\":{\"http_req_id\":\"$http_req_id\",\"http_req_ip\":\"$http_req_ip\",\"http_req_method\":\"$http_req_method\",\"http_req_path\":\"$http_req_path\",\"http_resp_bytes\":\"$http_resp_bytes\",\"http_resp_status\":\"$http_resp_status\",\"http_resp_took_ms\":\"$http_resp_took_ms\",\"session\":\"$session\",\"severity\":\"$severity\",\"span_id\":\"$span_id\",\"timestamp\":\"$timestamp\",\"trace_id\":\"$trace_id\"}}",
                    "rule": "(?P<beginning>.*)\\\"http_req_id\\\"\\:\\\"(?P<http_req_id>[\\w\\-]+)\\\"\\,\\\"http_req_ip\\\"\\:\\\"(?P<http_req_ip>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\\"\\,\\\"http_req_method\\\"\\:\\\"(?P<http_req_method>[\\w]+)\\\"\\,\\\"http_req_path\\\"\\:\\\"(?P<http_req_path>[\\/\\w]+)\\\"\\,\"http_resp_bytes\":(?P<http_resp_bytes>\\d{1,8})\\,\"http_resp_status\":(?P<http_resp_status>\\d{1,3})\\,\"http_resp_took_ms\":(?P<http_resp_took_ms>\\d{1,3})\\,\\\"session\\\"\\:\\\"(?P<session>[\\w\\-]+)\\\"\\,\\\"severity\\\"\\:\\\"(?P<severity>[\\w]+)\\\"\\,\\\"span_id\\\"\\:\\\"(?P<span_id>[\\w]+)\\\"\\,\\\"timestamp\\\"\\:\\\"(?P<timestamp>\\d{4}\\-\\d{2}\\-\\d{2}T\\d{2}\\:\\d{2}\\:\\d{2}\\.\\d{1,10}Z)\\\"\\,\\\"trace_id\\\"\\:\\\"(?P<trace_id>[\\w]+)\\\"\\}"
                  }
                },
                "enabled": true,
                "order": 3
              }
            ],
            "enabled": true,
            "order": 2
          }
        ],
        "order": 17
      },
      {
        "id": "cd430546-88ed-4862-85b1-d553f84a9a61",
        "name": "Parse frontend product info",
        "description": "",
        "creator": "george.pickers@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "default"
            }
          },
          {
            "subsystemName": {
              "value": "frontend"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "f65d765e-fc84-488e-8562-d3660520d77c",
            "rules": [
              {
                "id": "8665a2ce-b247-4a45-9b4f-47165085b817",
                "name": "Extract product ID",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "extractParameters": {
                    "rule": "(json.*?){.*?http.req.path.*?product.*?(?P<product_id>\\w+)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "6ef5d60e-9d6e-4590-8e6f-50909581954a",
            "rules": [
              {
                "id": "3418fb25-5930-4d20-97a1-72788a257080",
                "name": "Delete product id from request path",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$1",
                    "rule": "(json.*?{.*?http.req.path.*?product)(?P<product_id>.*?\\w+)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          }
        ],
        "order": 18
      },
      {
        "id": "2ed3074a-785b-46e9-adc0-0062e75f69d6",
        "name": "OB - Error to Message",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "default"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "7a2c6b24-7929-4ae4-955c-dccc27780190",
            "rules": [
              {
                "id": "a700b24d-15ad-48a7-95d6-a4839662c4eb",
                "name": "error -> message",
                "description": "",
                "sourceField": "text.error",
                "parameters": {
                  "extractParameters": {
                    "rule": "(?P<message>.*)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 19
      },
      {
        "id": "886f53bd-4e95-468f-baf8-5e85c0ddad08",
        "name": "Product stats",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "default"
            }
          },
          {
            "subsystemName": {
              "value": "loadgenerator"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "9d28c671-05f3-4caa-8233-d5745bd97253",
            "rules": [
              {
                "id": "292c6587-3f6f-4fa9-a2a7-9958a40627c3",
                "name": "Parse stats fields",
                "description": "{\"cloud\":{\"machine\":{\"type\":\"t3.large\"},\"availability_zone\":\"us-east-2a\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"provider\":\"aws\",\"instance\":{\"id\":\"i-0f7afac2798217d04\"}},\"kubernetes\":{\"container\":{\"id\":\"f656936403a86d996f50bbd349cb4a1da83678cb9b633af526abe46d8b7556e4\",\"name\":\"main\"},\"pod\":{\"labels\":{\"app\":\"loadgenerator\",\"pod-template-hash\":\"589648f87f\"},\"ip\":\"172.31.4.1\",\"name\":\"loadgenerator-589648f87f-46n6p\"},\"namespace\":\"default\",\"node\":{\"labels\":{\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"topology_kubernetes_io/region\":\"us-east-2\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"topology_kubernetes_io/zone\":\"us-east-2a\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"beta_kubernetes_io/os\":\"linux\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"beta_kubernetes_io/arch\":\"amd64\",\"kubernetes_io/arch\":\"amd64\"},\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"deployment\":{\"name\":\"loadgenerator\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2021-08-26T21:52:06.589Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\" GET /product/1YMWWN1N4O 1181 16(1.35%) | 28 3 1729 15 | 0.10 0.00\",\"tags\":[\"kubernetes\",\"containers\",\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"machine\":{\"type\":\"t3.large\"},\"account\":{\"id\":\"074157727657\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2a\",\"region\":\"us-east-2\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"service\":{\"name\":\"EC2\"},\"instance\":{\"id\":\"i-0f7afac2798217d04\"}},\"kubernetes\":{\"container\":{\"id\":\"f656936403a86d996f50bbd349cb4a1da83678cb9b633af526abe46d8b7556e4\",\"name\":\"main\"},\"pod\":{\"labels\":{\"app\":\"loadgenerator\",\"pod-template-hash\":\"589648f87f\"},\"ip\":\"172.31.4.1\",\"name\":\"loadgenerator-589648f87f-46n6p\"},\"namespace\":\"default\",\"deployment\":{\"name\":\"loadgenerator\"},\"node\":{\"labels\":{\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"topology_kubernetes_io/region\":\"us-east-2\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"topology_kubernetes_io/zone\":\"us-east-2a\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"beta_kubernetes_io/os\":\"linux\",\"kubernetes_io/os\":\"linux\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"beta_kubernetes_io/arch\":\"amd64\",\"kubernetes_io/arch\":\"amd64\"},\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2021-08-26T22:30:12.743Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\" POST /setCurrency 2045 33(1.61%) | 40 5 1890 21 | 0.50 0.00\",\"tags\":[\"kubernetes\",\"containers\",\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"machine\":{\"type\":\"t3.large\"},\"availability_zone\":\"us-east-2a\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"provider\":\"aws\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"region\":\"us-east-2\",\"instance\":{\"id\":\"i-0f7afac2798217d04\"}},\"kubernetes\":{\"container\":{\"id\":\"f656936403a86d996f50bbd349cb4a1da83678cb9b633af526abe46d8b7556e4\",\"name\":\"main\"},\"pod\":{\"labels\":{\"app\":\"loadgenerator\",\"pod-template-hash\":\"589648f87f\"},\"ip\":\"172.31.4.1\",\"name\":\"loadgenerator-589648f87f-46n6p\"},\"namespace\":\"default\",\"deployment\":{\"name\":\"loadgenerator\"},\"node\":{\"labels\":{\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"topology_kubernetes_io/region\":\"us-east-2\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"topology_kubernetes_io/zone\":\"us-east-2a\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"kubernetes_io/os\":\"linux\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"beta_kubernetes_io/arch\":\"amd64\",\"kubernetes_io/arch\":\"amd64\"},\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2021-08-26T23:13:35.546Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\" GET /product/6E92ZMYYFZ 1923 21(1.09%) | 28 3 1671 15 | 0.00 0.00\",\"tags\":[\"kubernetes\",\"containers\",\"beats_input_codec_plain_applied\"]}\n",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "stats\":{\"method\":\"$1\",\"endpoint\":\"$2\",\"product\":\"$3\",\"success\":\"$4\",\"failure\":\"$5\",\"prct_failure\":\"$6\",\"avg\":\"$7\",\"min\":\"$8\",\"max\":\"$9\",\"mid\":\"$10\",\"requests_rate\":\"$11\",\"failures_rate\":\"$12\"}",
                    "rule": "message\"\\s*:\"\\s*(?P<method>\\w+)\\s*(?P<endpoint>[^\\s\\\\]+)(?:\\\\/)?(?P<product_no>\\w*)\\s*(?P<successs>\\d+)\\s*(?P<failure>\\d+)\\((?P<prct_failure>[\\d\\.]+)%\\)\\s*\\|\\s*(?P<avg>\\d+)\\s*(?P<min>\\d+)\\s*(?P<max>\\d+)\\s*(?P<mid>\\d+)\\s*\\|\\s*(?P<requests_rate>[\\d\\.]+)\\s*(?P<failures_rate>[\\d\\.]+)\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 20
      },
      {
        "id": "4746a5f5-4612-481f-845e-b0dcd3d3497a",
        "name": "Extract service from cx.metadata",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "074157727657"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "070b8945-a64c-4945-a62a-84f7e69c58f7",
            "rules": [
              {
                "id": "87e30907-1b57-45aa-880e-6145ca250197",
                "name": "Extract faas_name into cx_metadata.service_name",
                "description": "{\"platform_event_type\":\"report\",\"cx_metadata\":{\"cloud_account_id\":\"074157727657\",\"cloud_provider\":\"aws\",\"cloud_region\":\"eu-west-1\",\"faas_execution\":\"e1065026-d775-4bd9-ae53-99032e367c79\",\"faas_id\":\"arn:aws:lambda:eu-west-1:074157727657:function:cll-lambda-python-2:$LATEST\",\"faas_instance_cx_id\":\"2d6b859b1e5ed7e415774a1c17d6cd35\",\"faas_name\":\"cll-lambda-python-2\",\"span_id\":\"a851dc681f9b1358\",\"tags\":{\"project\":\"coralogix-lambda-lab\"},\"trace_id\":\"2194edc1974a58d39628b739c9ba8a6b\"},\"event\":{\"error_type\":null,\"metrics\":{\"billed_duration_ms\":1311,\"duration_ms\":1310.858,\"init_duration_ms\":null,\"max_memory_used_mb\":118,\"memory_size_mb\":128,\"produced_bytes\":0,\"restore_duration_ms\":null},\"request_id\":\"e1065026-d775-4bd9-ae53-99032e367c79\",\"status\":\"success\"}}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "$start\"faas_name\":\"$service_name\"$end,\"service\":\"$service_name\"}",
                    "rule": "(?P<start>.*)\"faas_name\":\"(?P<service_name>[^\"]*)\"(?P<end>.*)}"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 21
      },
      {
        "id": "d71e37f1-c50d-45c3-b842-37b585bd9bc3",
        "name": "Parse AWS-ELB",
        "description": "Parse logs generated from AWS Classic Load Balancer (ELB)",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "aws-elb"
            }
          },
          {
            "subsystemName": {
              "value": "customers-elb"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "da7d831b-f977-4a14-beda-cee4e70dc554",
            "rules": [
              {
                "id": "877c0541-e26f-4d15-8259-bdda990f1d1b",
                "name": "Parse AWS-ELB Logs",
                "description": "{\"message\":\"2022-10-04T15:42:14.780568Z prod 146.225.200.106:443 - -1 -1 -1 504 504 4942 4942 \\\"GET https://learningcatalytics.com:443/questions/856776/item_versions HTTP/1.0\\\" \\\"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/536.2 (KHTML, like Gecko) Chrome/60.0.808.0 Safari/536.2\\\" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2\"}\n\n{\"message\":\"2022-10-04T15:41:58.780568Z prod 86.95.52.184:443 - -1 -1 -1 504 504 5041 5041 \\\"GET https://learningcatalytics.com:443courses/285528/modules HTTP/1.0\\\" \\\"Mozilla/5.0 (Windows 98; Win 9x 4.90; ky-KG; rv:1.9.1.20) Gecko/2020-07-10 09:07:16 Firefox/3.6.3\\\" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2\"}",
                "sourceField": "text",
                "parameters": {
                  "parseParameters": {
                    "destinationField": "text",
                    "rule": "message\\\"\\:\\\"(?P<timestamp>\\d{4}\\-\\d{2}\\-[0-9]{2}T\\d{2}\\:\\d{2}\\:\\d{2}\\.\\d+Z)\\s*(?P<elb_name>[\\w\\-]+)\\s*(?P<client_ip>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\:(?P<client_port>\\d+)\\s*(?P<target_ip>(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}|\\-))(\\:(?P<target_port>\\d+))?\\s*(?P<request_processing_time>[\\-\\d\\.]+)\\s*(?P<target_processing_time>[\\-\\d\\.]+)\\s*(?P<response_processing_time>[\\-\\d\\.]+)\\s*(?P<elb_status_code>\\d{3})\\s*(?P<target_status_code>\\d{3})\\s*(?P<received_bytes>\\d+)\\s*(?P<sent_bytes>\\d+)\\s*(\\\\)?\\\"(?P<request_verb>[a-zA-Z]+|-)\\s*(?P<request_uri>[^\\s*]+)\\s*(?P<request_protocol>[^\\\"]+)\\\"\\s*(\\\\)?\\\"(\\s*)?(?P<user_agent>[^\\\"]+)\\\"\\s*(?P<tls_cipher>[\\w\\-]+)\\s*(?P<tls_protocol>[\\w\\.]+)"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "058949f0-ab00-4ecc-98f7-8d2b0510b152",
            "rules": [
              {
                "id": "3fb9dfc3-2b80-45df-a296-c631dcbfda1e",
                "name": "Extract Timestamp from AWS-ELB Logs",
                "description": "2022-10-04T15:58:34.780568Z",
                "sourceField": "text.timestamp",
                "parameters": {
                  "extractTimestampParameters": {
                    "standard": "FORMAT_STANDARD_STRFTIME_OR_UNSPECIFIED",
                    "format": "%Y-%m-%dT%H:%M:%S.%fZ"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          }
        ],
        "order": 22
      },
      {
        "id": "72f3533e-9eab-4325-8681-baec84660fc8",
        "name": "Windows - rename host",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "windows_logs"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "92d0f336-5c4f-4157-a69b-7f4f41a6e0ce",
            "rules": [
              {
                "id": "7f387c67-7ea3-4600-9dc6-e572f077f60f",
                "name": "Rename host",
                "description": "{\"@timestamp\":\"2021-11-02T00:14:26.379Z\",\"event\":{\"code\":4625,\"created\":\"2021-11-02T00:14:27.912Z\",\"outcome\":\"failure\",\"action\":\"Logon\",\"provider\":\"Microsoft-Windows-Security-Auditing\",\"kind\":\"event\"},\"tags\":[\"beats_input_codec_plain_applied\"],\"agent\":{\"ephemeral_id\":\"075c16b2-19a2-41fa-a024-644958b4a4c7\",\"type\":\"winlogbeat\",\"name\":\"EC2AMAZ-CIFBMR8\",\"hostname\":\"EC2AMAZ-CIFBMR8\",\"id\":\"ea08b7e2-c1b6-4031-9ce6-f5c4b04ac45f\",\"version\":\"7.10.1\"},\"message\":\"An account failed to log on.\\n\\nSubject:\\n\\tSecurity ID:\\t\\tS-1-0-0\\n\\tAccount Name:\\t\\t-\\n\\tAccount Domain:\\t\\t-\\n\\tLogon ID:\\t\\t0x0\\n\\nLogon Type:\\t\\t\\t3\\n\\nAccount For Which Logon Failed:\\n\\tSecurity ID:\\t\\tS-1-0-0\\n\\tAccount Name:\\t\\tADMINISTRATOR\\n\\tAccount Domain:\\t\\t\\n\\nFailure Information:\\n\\tFailure Reason:\\t\\tUnknown user name or bad password.\\n\\tStatus:\\t\\t\\t0xC000006D\\n\\tSub Status:\\t\\t0xC000006A\\n\\nProcess Information:\\n\\tCaller Process ID:\\t0x0\\n\\tCaller Process Name:\\t-\\n\\nNetwork Information:\\n\\tWorkstation Name:\\t-\\n\\tSource Network Address:\\t27.72.30.223\\n\\tSource Port:\\t\\t0\\n\\nDetailed Authentication Information:\\n\\tLogon Process:\\t\\tNtLmSsp \\n\\tAuthentication Package:\\tNTLM\\n\\tTransited Services:\\t-\\n\\tPackage Name (NTLM only):\\t-\\n\\tKey Length:\\t\\t0\\n\\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\\n\\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\n\\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\\n\\nThe Process Information fields indicate which account and process on the system requested the logon.\\n\\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\n\\nThe authentication information fields provide detailed information about this specific logon request.\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\",\"@version\":\"1\",\"host\":{\"name\":\"EC2AMAZ-CIFBMR8\"},\"ecs\":{\"version\":\"1.5.0\"},\"winlog\":{\"channel\":\"Security\",\"event_id\":4625,\"process\":{\"pid\":716,\"thread\":{\"id\":4108}},\"opcode\":\"Info\",\"event_data\":{\"SubjectUserName\":\"-\",\"SubStatus\":\"0xc000006a\",\"TransmittedServices\":\"-\",\"SubjectLogonId\":\"0x0\",\"SubjectUserSid\":\"S-1-0-0\",\"Status\":\"0xc000006d\",\"IpPort\":\"0\",\"IpAddress\":\"27.72.30.223\",\"FailureReason\":\"%%2313\",\"ProcessName\":\"-\",\"LmPackageName\":\"-\",\"TargetUserName\":\"ADMINISTRATOR\",\"TargetUserSid\":\"S-1-0-0\",\"ProcessId\":\"0x0\",\"KeyLength\":\"0\",\"LogonProcessName\":\"NtLmSsp \",\"SubjectDomainName\":\"-\",\"AuthenticationPackageName\":\"NTLM\",\"LogonType\":\"3\",\"WorkstationName\":\"-\"},\"keywords\":[\"Audit Failure\"],\"task\":\"Logon\",\"record_id\":16734626,\"provider_name\":\"Microsoft-Windows-Security-Auditing\",\"api\":\"wineventlog\",\"computer_name\":\"EC2AMAZ-CIFBMR8\",\"provider_guid\":\"{54849625-5478-4994-A5BA-3E3B0328C30D}\",\"activity_id\":\"{92522A8E-F43F-0000-B42A-52923FF4D601}\"},\"log\":{\"level\":\"information\"}}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"host_windows\":{",
                    "rule": "\"host\"\\s*:{"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 23
      },
      {
        "id": "47cf44d3-9be4-4b87-b9be-42f2c206b4d1",
        "name": "Parse prometheus-server logs",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "prometheus"
            }
          },
          {
            "subsystemName": {
              "value": "prometheus-server"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "cd147eae-2876-427a-8c2f-bb610bdaa442",
            "rules": [
              {
                "id": "89c1fe5f-fcbd-42c7-a53f-f468eff8f981",
                "name": "Parse prometheus-server logs #1",
                "description": "{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T22:49:53.600Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T22:49:53.599Z caller=notifier.go:601 component=notifier msg=\\\"Stopping notification manager...\\\"\",\"tags\":[\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"service\":{\"name\":\"EC2\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T22:49:53.600Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T22:49:53.599Z caller=main.go:664 msg=\\\"Scrape discovery manager stopped\\\"\",\"tags\":[\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"deployment\":{\"name\":\"prometheus-server\"},\"namespace\":\"prometheus\"},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T22:49:53.600Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=error ts=2022-08-30T22:49:53.600Z caller=main.go:881 err=\\\"opening storage failed: lock DB directory: resource temporarily unavailable\\\"\",\"tags\":[\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T22:55:03.838Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T22:55:03.838Z caller=repair.go:57 component=tsdb msg=\\\"Found healthy block\\\" mint=1661875200263 maxt=1661882400000 ulid=01GBR2017JBF14WHDTVGHH3HYA\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"component\":\"$component\",\"message\":\"$message\",\"mint\":\"$mint\",\"maxt\":\"$maxt\",\"ulid\":\"$ulid\"",
                    "rule": "\"message\":\"level=(?P<level>[A-z]+) ts=(?P<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]{3}Z) caller=(?P<caller>[^ ]+)(?: component=([^ ]+))? (?:msg|err)=\\\\\"(?P<message>[^\"]+)\\\\\"(?: mint=(?P<mint>[0-9]+) maxt=(?P<maxt>[0-9]+) ulid=(?P<ulid>[0-9A-Z]+))?\""
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "be53cfdb-3c75-4ecf-82d2-87164e9016d5",
                "name": "Parse prometheus-server logs #2",
                "description": "{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T23:15:28.719Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T23:15:28.719Z caller=tls_config.go:191 component=web msg=\\\"TLS is disabled.\\\" http2=false\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"component\":\"$component\",\"message\":\"$message\",\"http2\":\"$http2\"",
                    "rule": "\"message\":\"level=(?P<level>[A-z]+) ts=(?P<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]{3}Z) caller=(?P<caller>[^ ]+) component=(?P<component>[^ ]+) msg=\\\\\"(?P<message>[^\"]+)\\\\\" http2=(?P<http2>[a-z]+)\""
                  }
                },
                "enabled": true,
                "order": 2
              },
              {
                "id": "f31c1aa1-42d2-4832-993b-c911bad92096",
                "name": "Parse prometheus-server logs #3",
                "description": "{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T23:15:28.719Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T23:15:28.717Z caller=manager.go:944 component=\\\"rule manager\\\" msg=\\\"Rule manager stopped\\\"\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"component\":\"$component\",\"message\":\"$message\"",
                    "rule": "\"message\":\"level=(?P<level>[A-z]+) ts=(?P<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]{3}Z) caller=(?P<caller>[^ ]+) component=\\\\\"(?P<component>[^\"]+)\\\\\" msg=\\\\\"(?P<message>[^\"]+)\\\\\"\""
                  }
                },
                "enabled": true,
                "order": 3
              },
              {
                "id": "ed56a432-33a5-4667-8ea3-d65301494fa8",
                "name": "Parse prometheus-server logs #4",
                "description": "{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"service\":{\"name\":\"EC2\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T23:25:46.815Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T23:25:46.815Z caller=web.go:540 component=web msg=\\\"Start listening for connections\\\" address=0.0.0.0:9090\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"component\":\"$component\",\"message\":\"$message\",\"address\":\"$address\"",
                    "rule": "\"message\":\"level=(?P<level>[A-z]+) ts=(?P<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]{3}Z) caller=(?P<caller>[^ ]+) component=(?P<component>[^ ]+) msg=\\\\\"(?P<message>[^\"]+)\\\\\" address=(?P<address>[0-9\\.:]+)\""
                  }
                },
                "enabled": true,
                "order": 4
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "4ab3e013-02be-4ea9-aa8e-d2adb2331c9b",
            "rules": [
              {
                "id": "5a1a4e65-d3ff-45f8-a099-312229b5fd39",
                "name": "extract level to Coralogix severity",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "jsonExtractParameters": {
                    "destinationFieldType": "DESTINATION_FIELD_SEVERITY",
                    "rule": "level",
                    "destinationFieldText": null
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "a4624faf-f86d-40ed-8708-590c894ff4b5",
            "rules": [
              {
                "id": "ae0171ed-51cc-4eb7-adcd-caa27f33b641",
                "name": "remove empty field1",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "",
                    "rule": "\"[^\"]+\":\"\","
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          },
          {
            "id": "0d2d9493-ea07-4b7b-93c1-cb8c2b9e3aa8",
            "rules": [
              {
                "id": "2363b954-9f4e-4d08-87e3-386017de6a76",
                "name": "remove empty field2",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "",
                    "rule": ",\"[^\"]+\":\"\""
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 4
          }
        ],
        "order": 24
      },
      {
        "id": "2283df8c-11d5-4997-b081-69abc89ae1a7",
        "name": "Severity Rules",
        "description": "",
        "creator": "george.pickers@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "b506f55b-7c21-4982-bab3-23c1a935fb38",
            "rules": [
              {
                "id": "640b2e13-281c-4fb7-bd10-53feb21bbadc",
                "name": "Extract Severity from AWS-ELB Status Code",
                "description": "{\"client_addr\":\"225.44.33.12\",\"client_port\":\"443\",\"elb\":\"prod\",\"elb_status_code\":\"504\",\"recieved_bytes\":\"4997\",\"request\":\"GET https://learningcatalytics.com:443/list HTTP/1.0\\\\\",\"request_processing_time\":\"-1\",\"response_processing_time\":\"-1\",\"sent_bytes\":\"4997\",\"ssl_cipher\":\"ECDHE-RSA-AES128-GCM-SHA256\",\"ssl_protocol\":\"TLSv1.2\",\"target_addr\":\"-\",\"target_processing_time\":\"-1\",\"target_status_code\":\"504\",\"timestamp\":\"2022-05-25T04:33:47.120274Z\",\"user_agent\":\"Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/2012-01-05 11:36:56 Firefox/3.8\\\\\"}",
                "sourceField": "text",
                "parameters": {
                  "jsonExtractParameters": {
                    "destinationFieldType": "DESTINATION_FIELD_SEVERITY",
                    "rule": "elb_status_code",
                    "destinationFieldText": null
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "8a5ac040-7b23-4b40-a038-4111eb347f81",
                "name": "Extract severity from json.http_resp_status",
                "description": "{\"cloud\":{\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2a\",\"service\":{\"name\":\"EC2\"},\"region\":\"us-east-2\",\"account\":{\"id\":\"074157727657\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-0f7afac2798217d04\"}},\"kubernetes\":{\"container\":{\"id\":\"83b5eabd340b092e44f97e6a0add04a45f8b2408daad162d1b1e4ff4901e9312\",\"name\":\"server\"},\"pod\":{\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"b85fc47d4\"},\"ip\":\"172.31.13.168\",\"name\":\"frontend-b85fc47d4-z8vb5\"},\"namespace\":\"default\",\"node\":{\"labels\":{\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"topology_kubernetes_io/region\":\"us-east-2\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"topology_kubernetes_io/zone\":\"us-east-2a\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"kubernetes_io/os\":\"linux\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"beta_kubernetes_io/arch\":\"amd64\",\"kubernetes_io/arch\":\"amd64\"},\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"deployment\":{\"name\":\"frontend\"}},\"cluster_name\":\"cluster.local\",\"inner_json\":{\"severity\":\"debug\",\"timestamp\":\"2021-08-27T23:54:32.487194427Z\",\"http_req_id\":\"231de558-b0d3-40ee-a5e9-674b52e8f987\",\"http_req_method\":\"GET\",\"http_req_path\":\"/cart\",\"http_resp_bytes\":16822,\"http_resp_status\":200,\"http_resp_took_ms\":47,\"message\":\"request complete\",\"session\":\"25740e19-1bcc-4ea4-b5f3-eaacffddbaa1\"},\"@timestamp\":\"2021-08-27T23:54:32.488Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"tags\":[\"kubernetes\",\"containers\",\"beats_input_codec_plain_applied\"]}\n",
                "sourceField": "text",
                "parameters": {
                  "extractParameters": {
                    "rule": "json.*?http_resp_status\\\\\"\\s*:.*?(?P<severity>\\d{3})"
                  }
                },
                "enabled": false,
                "order": 2
              },
              {
                "id": "d98fe39b-7c27-4ae7-9c8a-c311132332dc",
                "name": "Set status 2/3xx logs to INFO",
                "description": "",
                "sourceField": "text.json.http_resp_status",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "severity",
                    "replaceNewVal": "INFO",
                    "rule": "(2|3)\\d\\d"
                  }
                },
                "enabled": false,
                "order": 3
              },
              {
                "id": "d106f430-1009-4666-aa93-e56281bce453",
                "name": "Request started/completed -> INFO",
                "description": "",
                "sourceField": "text.message",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "INFO",
                    "rule": ".*?(started|completed).*"
                  }
                },
                "enabled": false,
                "order": 4
              },
              {
                "id": "c5e3cb41-88d6-4293-ad18-2c5e6ddc473c",
                "name": "Extract severity from json.severity",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "jsonExtractParameters": {
                    "destinationFieldType": "DESTINATION_FIELD_SEVERITY",
                    "rule": "json.severity",
                    "destinationFieldText": null
                  }
                },
                "enabled": true,
                "order": 5
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "540b55da-0333-4cef-9d65-7a65c8c4abf3",
            "rules": [
              {
                "id": "e9bfe7f9-3eae-4943-8d06-711d8624d205",
                "name": "Extract severity from json.http_resp_status",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "jsonExtractParameters": {
                    "destinationFieldType": "DESTINATION_FIELD_SEVERITY",
                    "rule": "json.http_resp_status",
                    "destinationFieldText": null
                  }
                },
                "enabled": true,
                "order": 1
              },
              {
                "id": "f2b247dd-326b-459d-a934-57d63689b5c5",
                "name": "Severity Rule",
                "description": "Look for default severity text",
                "sourceField": "text",
                "parameters": {
                  "extractParameters": {
                    "rule": "\\b(?P<severity>DEBUG|TRACE|INFO|WARN|ERROR|FATAL|EXCEPTION|[Dd]ebug|[Tt]race|[Ii]nfo|[Ww]arn|[Ee]rror|[Ff]atal|[Ee]xception)\\b"
                  }
                },
                "enabled": true,
                "order": 2
              }
            ],
            "enabled": true,
            "order": 2
          }
        ],
        "order": 25
      },
      {
        "id": "376f5964-a9a7-4859-86c8-f7835c8f23f4",
        "name": "kube",
        "description": "Fix odd fields causing parsing to fail",
        "creator": "david.bott+boutique@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "kube-system"
            }
          },
          {
            "subsystemName": {
              "value": "kube-apiserver-audit"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "5afafc04-f68f-447b-895d-0247e4bb0e7a",
            "rules": [
              {
                "id": "adf0c50f-a3c1-4d20-a168-83083c7f2992",
                "name": "Remove field called \".\"",
                "description": "\n{\ntext:{\"stage\":\"ResponseComplete\",\"requestURI\":\"/apis/authorization.k8s.io/v1/subjectaccessreviews\",\"requestObject\":{\"kind\":\"SubjectAccessReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null},\"spec\":{\"resourceAttributes\":{\"verb\":\"get\",\"version\":\"v1\",\"resource\":\"nodes\",\"subresource\":\"metrics\",\"name\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"user\":\"system:serviceaccount:monitoring24:coralogix-opentelemetry-collector\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:monitoring24\",\"system:authenticated\"],\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"coralogix-opentelemetry-collector-8497849d4-9bmvl\"],\"authentication.kubernetes.io/pod-uid\":[\"1bd6c1e0-5d2c-4d85-9a3b-1e3c838e3dc1\"]},\"uid\":\"3772d3fb-8c4e-4af6-be48-924e91cfe7d4\"},\"status\":{\"allowed\":false}},\"auditID\":\"25b68412-42de-4d04-a755-dbe91e10bf98\",\"objectRef\":{\"resource\":\"subjectaccessreviews\",\"apiGroup\":\"authorization.k8s.io\",\"apiVersion\":\"v1\"},\"userAgent\":\"kubelet/v1.21.2 (linux/amd64) kubernetes/3d33787\",\"sourceIPs\":[\"18.118.132.47\"],\"responseStatus\":{\"metadata\":{},\"code\":201},\"responseObject\":{\"kind\":\"SubjectAccessReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null,\"managedFields\":[{\"manager\":\"kubelet\",\"operation\":\"Update\",\"apiVersion\":\"authorization.k8s.io/v1\",\"time\":\"2024-10-10T15:39:56Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:spec\":{\"f:extra\":{\".\":{},\"f:authentication.kubernetes.io/pod-name\":{},\"f:authentication.kubernetes.io/pod-uid\":{}},\"f:groups\":{},\"f:resourceAttributes\":{\".\":{},\"f:name\":{},\"f:resource\":{},\"f:subresource\":{},\"f:verb\":{},\"f:version\":{}},\"f:uid\":{},\"f:user\":{}}}}]},\"spec\":{\"resourceAttributes\":{\"verb\":\"get\",\"version\":\"v1\",\"resource\":\"nodes\",\"subresource\":\"metrics\",\"name\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"user\":\"system:serviceaccount:monitoring24:coralogix-opentelemetry-collector\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:monitoring24\",\"system:authenticated\"],\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"coralogix-opentelemetry-collector-8497849d4-9bmvl\"],\"authentication.kubernetes.io/pod-uid\":[\"1bd6c1e0-5d2c-4d85-9a3b-1e3c838e3dc1\"]},\"uid\":\"3772d3fb-8c4e-4af6-be48-924e91cfe7d4\"},\"status\":{\"allowed\":true,\"reason\":\"RBAC: allowed by ClusterRoleBinding \\\"coralogix-opentelemetry-collector\\\" of ClusterRole \\\"coralogix-opentelemetry-collector\\\" to ServiceAccount \\\"coralogix-opentelemetry-collector/monitoring24\\\"\"}},\"user\":{\"username\":\"system:node:ip-172-31-43-38.us-east-2.compute.internal\",\"uid\":\"aws-iam-authenticator:074157727657:AROARCRBFD6U5I6XD6RHO\",\"groups\":[\"system:bootstrappers\",\"system:nodes\",\"system:authenticated\"],\"extra\":{\"accessKeyId\":[\"ASIARCRBFD6UYC7YIWNE\"],\"arn\":[\"arn:aws:sts::074157727657:assumed-role/eks-nodes/i-0b423258572c23bf6\"],\"canonicalArn\":[\"arn:aws:iam::074157727657:role/eks-nodes\"],\"principalId\":[\"AROARCRBFD6U5I6XD6RHO\"],\"sessionName\":[\"i-0b423258572c23bf6\"],\"sigs.k8s.io/aws-iam-authenticator/principalId\":[\"AROARCRBFD6U5I6XD6RHO\"]}},\"level\":\"RequestResponse\",\"annotations\":{\"authorization.k8s.io/decision\":\"allow\",\"authorization.k8s.io/reason\":\"\"},\"stageTimestamp\":\"2024-10-10T15:39:56.576301Z\",\"requestReceivedTimestamp\":\"2024-10-10T15:39:56.573475Z\",\"verb\":\"create\",\"kind\":\"Event\",\"apiVersion\":\"audit.k8s.io/v1\"}\n}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": " ",
                    "rule": "\\\"\\.\\\"\\:\\{\\}\\,"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          },
          {
            "id": "bb641c4b-174f-44c7-bba2-b694c11ec3c3",
            "rules": [
              {
                "id": "1c755e7d-6c5f-4c5d-95af-5c92e14a8c21",
                "name": "Rename status to statusObject",
                "description": "{\ntext:{\"stage\":\"ResponseComplete\",\"requestURI\":\"/apis/authorization.k8s.io/v1/subjectaccessreviews\",\"requestObject\":{\"kind\":\"SubjectAccessReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null},\"spec\":{\"resourceAttributes\":{\"verb\":\"get\",\"version\":\"v1\",\"resource\":\"nodes\",\"subresource\":\"metrics\",\"name\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"user\":\"system:serviceaccount:monitoring24:coralogix-opentelemetry-collector\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:monitoring24\",\"system:authenticated\"],\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"coralogix-opentelemetry-collector-8497849d4-9bmvl\"],\"authentication.kubernetes.io/pod-uid\":[\"1bd6c1e0-5d2c-4d85-9a3b-1e3c838e3dc1\"]},\"uid\":\"3772d3fb-8c4e-4af6-be48-924e91cfe7d4\"},\"status\":{\"allowed\":false}},\"auditID\":\"25b68412-42de-4d04-a755-dbe91e10bf98\",\"objectRef\":{\"resource\":\"subjectaccessreviews\",\"apiGroup\":\"authorization.k8s.io\",\"apiVersion\":\"v1\"},\"userAgent\":\"kubelet/v1.21.2 (linux/amd64) kubernetes/3d33787\",\"sourceIPs\":[\"18.118.132.47\"],\"responseStatus\":{\"metadata\":{},\"code\":201},\"responseObject\":{\"kind\":\"SubjectAccessReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null,\"managedFields\":[{\"manager\":\"kubelet\",\"operation\":\"Update\",\"apiVersion\":\"authorization.k8s.io/v1\",\"time\":\"2024-10-10T15:39:56Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:spec\":{\"f:extra\":{ \"f:authentication.kubernetes.io/pod-name\":{},\"f:authentication.kubernetes.io/pod-uid\":{}},\"f:groups\":{},\"f:resourceAttributes\":{ \"f:name\":{},\"f:resource\":{},\"f:subresource\":{},\"f:verb\":{},\"f:version\":{}},\"f:uid\":{},\"f:user\":{}}}}]},\"spec\":{\"resourceAttributes\":{\"verb\":\"get\",\"version\":\"v1\",\"resource\":\"nodes\",\"subresource\":\"metrics\",\"name\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"user\":\"system:serviceaccount:monitoring24:coralogix-opentelemetry-collector\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:monitoring24\",\"system:authenticated\"],\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"coralogix-opentelemetry-collector-8497849d4-9bmvl\"],\"authentication.kubernetes.io/pod-uid\":[\"1bd6c1e0-5d2c-4d85-9a3b-1e3c838e3dc1\"]},\"uid\":\"3772d3fb-8c4e-4af6-be48-924e91cfe7d4\"},\"status\":{\"allowed\":true,\"reason\":\"RBAC: allowed by ClusterRoleBinding \\\"coralogix-opentelemetry-collector\\\" of ClusterRole \\\"coralogix-opentelemetry-collector\\\" to ServiceAccount \\\"coralogix-opentelemetry-collector/monitoring24\\\"\"}},\"user\":{\"username\":\"system:node:ip-172-31-43-38.us-east-2.compute.internal\",\"uid\":\"aws-iam-authenticator:074157727657:AROARCRBFD6U5I6XD6RHO\",\"groups\":[\"system:bootstrappers\",\"system:nodes\",\"system:authenticated\"],\"extra\":{\"accessKeyId\":[\"ASIARCRBFD6UYC7YIWNE\"],\"arn\":[\"arn:aws:sts::074157727657:assumed-role/eks-nodes/i-0b423258572c23bf6\"],\"canonicalArn\":[\"arn:aws:iam::074157727657:role/eks-nodes\"],\"principalId\":[\"AROARCRBFD6U5I6XD6RHO\"],\"sessionName\":[\"i-0b423258572c23bf6\"],\"sigs.k8s.io/aws-iam-authenticator/principalId\":[\"AROARCRBFD6U5I6XD6RHO\"]}},\"level\":\"RequestResponse\",\"annotations\":{\"authorization.k8s.io/decision\":\"allow\",\"authorization.k8s.io/reason\":\"\"},\"stageTimestamp\":\"2024-10-10T15:39:56.576301Z\",\"requestReceivedTimestamp\":\"2024-10-10T15:39:56.573475Z\",\"verb\":\"create\",\"kind\":\"Event\",\"apiVersion\":\"audit.k8s.io/v1\"}\n}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"statusObject\":{",
                    "rule": "\"status\"\\s*?:\\s*?\\{"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 2
          },
          {
            "id": "c7e672a6-dc4d-4d8e-a5ce-7236724337c2",
            "rules": [
              {
                "id": "f3fe990e-f881-430d-9471-ebd24279d694",
                "name": "app abuse",
                "description": "There's a field called \"app\" which is just text, and many of type \"app.kubernetes.io/<xxx>\" which are also text, but the dot notation makes it think app is an object. Rename \"app\" since it's rarely there\n\"labels\":{\n\"app\":\"cartservice\",\n\"pod-template-hash\":\"5df6bd977\"\n}",
                "sourceField": "text",
                "parameters": {
                  "replaceParameters": {
                    "destinationField": "text",
                    "replaceNewVal": "\"application\":",
                    "rule": "\"app\"\\s*:"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 3
          }
        ],
        "order": 26
      },
      {
        "id": "3bbb9ac2-7676-4414-8e81-66ec99da14e4",
        "name": "Extract http method and response code",
        "description": "",
        "creator": "support@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [],
        "ruleSubgroups": [
          {
            "id": "55affb81-3a25-4be0-8774-652d612c77e5",
            "rules": [
              {
                "id": "92aa40f1-fd01-44b5-a986-1973a555df51",
                "name": "method and response",
                "description": "",
                "sourceField": "text.body",
                "parameters": {
                  "extractParameters": {
                    "rule": "\"(?P<method>[A-Z]+) [^\"]+\" (?P<status_code>\\d{3})\n"
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 27
      },
      {
        "id": "6badd11e-211e-4c7a-8395-ca1d9d4508fc",
        "name": "ruben rule to remove",
        "description": "",
        "creator": "bot@coralogix.com",
        "enabled": true,
        "hidden": false,
        "ruleMatchers": [
          {
            "applicationName": {
              "value": "statuspage"
            }
          },
          {
            "subsystemName": {
              "value": "coralogix-ebpf-profiler"
            }
          },
          {
            "severity": {
              "value": "VALUE_DEBUG_OR_UNSPECIFIED"
            }
          }
        ],
        "ruleSubgroups": [
          {
            "id": "d0ffd32d-dbca-41dd-9fb6-59eb6d451f85",
            "rules": [
              {
                "id": "d05853de-6244-4b58-97e9-2b56808dc894",
                "name": "aasdasd",
                "description": "",
                "sourceField": "text",
                "parameters": {
                  "removeFieldsParameters": {
                    "fields": [
                      "requestParameters.encryptionContext.aws:lambda:FunctionArn"
                    ]
                  }
                },
                "enabled": true,
                "order": 1
              }
            ],
            "enabled": true,
            "order": 1
          }
        ],
        "order": 28
      }
    ],
    "resource_identifiers": [
      "k8s Opentelemetry parsing",
      "Db Snapshot Made Public (Security)",
      "Data Normalization - GitHub (Security)",
      "AWS CloudTrail - max fields - stringifying fields (Security)",
      "Data Normalization - GuardDuty (Security)",
      "Data Normalization - CrowdStrike (Security).",
      "AWS CloudTrail - AMI Made Public (Security)",
      "Data Normalization - CloudTrail (Security)",
      "k8s Opentelemetry parsing",
      "AWS status rules",
      "Cloudtrail rules",
      "Replace AWS host name with host ip - For metrics correlation",
      "PII - Mask Email addresses",
      "PII - Block Payment Details",
      "Parse payment info",
      "Default Subsystem - Demo - Parsing",
      "Frontend Service Parsing Rules",
      "Parse frontend product info",
      "OB - Error to Message",
      "Product stats",
      "Extract service from cx.metadata",
      "Parse AWS-ELB",
      "Windows - rename host",
      "Parse prometheus-server logs",
      "Severity Rules",
      "kube",
      "Extract http method and response code",
      "ruben rule to remove"
    ]
  },
  "metadata": {
    "created_by": "version_manager",
    "purpose": "pre_migration_snapshot"
  }
}