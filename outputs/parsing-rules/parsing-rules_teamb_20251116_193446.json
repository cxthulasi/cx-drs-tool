{
  "timestamp": "2025-11-16T19:34:46.712624",
  "service": "parsing-rules",
  "team": "teamb",
  "resources": [
    {
      "id": "5c192196-6b12-4a4d-9a27-741bd2aacf9e",
      "name": "k8s Opentelemetry parsing",
      "description": "k8s Opentelemetry extension pack",
      "creator": "k8s Opentelemetry extension pack",
      "enabled": true,
      "hidden": false,
      "ruleSubgroups": [
        {
          "id": "0140697c-ce54-4e67-9e28-e66418499200",
          "rules": [
            {
              "id": "f4b451fa-e109-415f-9db5-0b7dd8a90164",
              "name": "Stringify logRecord",
              "description": "",
              "sourceField": "text.logRecord",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.logRecord_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "50da5a77-b78f-49f0-b837-a64317375d05",
          "rules": [
            {
              "id": "502f3698-4dec-454e-9e90-54282a9b7078",
              "name": "Parse json logRecord_tmp",
              "description": "",
              "sourceField": "text.logRecord_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "5c5890f8-a59c-4965-88b2-c9c6ee1cc4ea",
          "rules": [
            {
              "id": "29fb6907-f8dd-432f-ab0d-415a7e70d33e",
              "name": "Parse json body",
              "description": "",
              "sourceField": "text.body",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        },
        {
          "id": "64d07711-b567-45ed-a665-d9d73e76879a",
          "rules": [
            {
              "id": "2325ac86-1a2a-4c9a-a365-505de501dd24",
              "name": "map deprecatedLastTimestamp, eventTime as datetime fields",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"${1}_custom_timestamp\":\"",
                  "rule": "\"(deprecatedLastTimestamp|eventTime)\":\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 4
        },
        {
          "id": "7b9acb8d-49df-4a95-acb4-1d72c352d568",
          "rules": [
            {
              "id": "7a07ae21-c6c8-4e4c-bdcd-0e65675a3b5a",
              "name": "fix mapping exception for infra collector empty f:annotations",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "${1}\"f:workflow\":{",
                  "rule": "(\"f:annotations\":\\{.*?)\"\\.\":\\{"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 5
        },
        {
          "id": "4406f683-4c5b-4c5f-a643-f09c20c1b587",
          "rules": [
            {
              "id": "0d162eef-a42c-4f04-b16a-e2e1a3606565",
              "name": "Parse common logs from k8s containers",
              "description": "This rule parses containers: kube-apiserver, kube-controller-manager, kube-proxy, kube-scheduler, storage-provisioner.",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"message\":\"$message\"",
                  "rule": "\"body\":\"(?P<level>[A-Z])(?P<timestamp>\\d{4} \\d{2}:\\d{2}:\\d{2}\\.\\d+)\\s*1 (?P<caller>[^\\]]+)\\] (?P<message>(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "5289a7e3-bada-46a9-940b-fc11d428ee4c",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with time",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(time=\\\\\"(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 2
            },
            {
              "id": "423871ed-7323-49ec-9087-dcad270e303c",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with ts",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(ts=\\d{4}(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 3
            },
            {
              "id": "170a3336-f720-4ab1-bb74-972f13b37d50",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with level",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(level=(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 4
            }
          ],
          "enabled": true,
          "order": 6
        },
        {
          "id": "eafb17cc-9849-4d9b-bffa-e3f010e12380",
          "rules": [
            {
              "id": "33a2a933-dd76-4492-9eac-95701f12cddb",
              "name": "Extract msg from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "extractParameters": {
                  "rule": "msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 7
        },
        {
          "id": "b43052e5-e4c8-4f18-bb30-6460409da107",
          "rules": [
            {
              "id": "e207fa75-2909-40e5-b5be-9b04de97c6ce",
              "name": "Remove msg from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\s+msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 8
        },
        {
          "id": "1051d92e-d95e-4f68-b7b5-274f09cbd97f",
          "rules": [
            {
              "id": "e0c01f1c-88a9-4797-8839-e510eba4847e",
              "name": "Extract query from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "extractParameters": {
                  "rule": "query=\\\\\"(?P<query>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "82aff5ab-b9b3-45c0-9570-24fdb62834fb",
              "name": "Extract query from kvPairs when kvPairs also had msg in it along with query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "extractParameters": {
                  "rule": "query=\\\\\\\\\\\\\"(?P<query>(?:\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 9
        },
        {
          "id": "6f634415-5d8e-48ee-a77e-b96bf76f109f",
          "rules": [
            {
              "id": "7933b904-925e-429e-82e8-94b24629fef9",
              "name": "remove query from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\s+query=\\\\\"(?P<query>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "d3124a36-590f-4f08-8525-84d69a2b9ffa",
              "name": "remove query from kvPairs when kvPairs also had msg in it along with query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\s+query=\\\\\\\\\\\\\"(?P<query>(?:\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 10
        },
        {
          "id": "afa88b35-7840-4d9a-ad5d-8fe61d0bcced",
          "rules": [
            {
              "id": "03f26797-98ca-497b-8e25-ad521d7d6fe2",
              "name": "prepare all the rest of the fields in a kvPairs field that had both msg and query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                  "rule": "([\\w\\.\\-\\_]+)=\\\\{7}\"((?:\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\+\"|[^\"])+)\\\\{7}\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "24e75bee-57a3-40b1-995d-314afe1b8219",
              "name": "prepare all the rest of the fields in a kvPairs field that had either msg or query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                  "rule": "([\\w\\.\\-\\_]+)=\\\\{3}\"((?:\\\\\\\\\\\\\\\\+\"|[^\"])+)\\\\{3}\""
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 11
        },
        {
          "id": "86c0ddd1-1b23-4455-aadb-ea23f4618f8f",
          "rules": [
            {
              "id": "225438f9-11d0-42db-a5ec-142529dcbad1",
              "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had both msg and query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\\\{15,}\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "5d7dbc70-00e3-4f1f-87d0-5732c53193af",
              "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had either msg or query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\\\{7,}\""
                }
              },
              "enabled": true,
              "order": 2
            },
            {
              "id": "9aa28834-eb48-4ee1-b5de-25f24cfce3e2",
              "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had no msg or query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\\\{3,}\""
                }
              },
              "enabled": true,
              "order": 3
            }
          ],
          "enabled": true,
          "order": 12
        },
        {
          "id": "7a79af25-33ed-4eaa-b048-ddd700d36b88",
          "rules": [
            {
              "id": "003e12fc-b97e-466d-b3af-84a2df08713c",
              "name": "Replace all remaining occurrences of double quotes with their corresponding backslash with \u00a7",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7",
                  "rule": "\\\\+\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 13
        },
        {
          "id": "fe1dc8a1-4354-4e1d-8290-706b886fdb5d",
          "rules": [
            {
              "id": "5f45fd2b-e526-4183-acf2-59ed7a1d8730",
              "name": "wrap the keys of the key/val pairs with \u00a7 wrapping the value with \u00a7",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                  "rule": "([\\w\\.\\-]+)=\\xA7([^\\xA7]*)\\xA7"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 14
        },
        {
          "id": "3f476e82-a0bf-4e9f-9019-0626fe6eb982",
          "rules": [
            {
              "id": "527157a3-139c-4408-802a-96515bcc8558",
              "name": "Adding to the rest of key/val pairs \u00a7 before and after the keys and values",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                  "rule": "([\\w\\.\\-\\_]+)=((?:$|[^ ])*)(?: |$)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 15
        },
        {
          "id": "dec1aa8a-a4c8-4f8c-b556-d8b1a5e2ac14",
          "rules": [
            {
              "id": "b955e01b-3ea0-401d-bdd4-b5f8b012d571",
              "name": "Adding commas between key/val pairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "${1}:${2},",
                  "rule": "(\\xA7[^\\xA7]*\\xA7):(\\xA7[^\\xA7]*\\xA7)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 16
        },
        {
          "id": "4a8063ee-2e71-489d-86f3-e0ee4f558175",
          "rules": [
            {
              "id": "52a95e3c-18c9-4747-8013-d6dd8a2679f2",
              "name": "Remove last comma before jsonizing kvPairs field",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "{$1}",
                  "rule": "(.*),"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 17
        },
        {
          "id": "aada335b-f4cc-45fb-9fb9-73135bc1f4ae",
          "rules": [
            {
              "id": "1b7c1ca7-6e74-4b09-8d04-d4c8afba6b9b",
              "name": "Replacing \u00a7 with \" to jsonize kvPairs in order to get a valid JSON",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\"",
                  "rule": "\\xA7"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 18
        },
        {
          "id": "82f7d8ec-d66c-43bc-bc88-6afcef11615a",
          "rules": [
            {
              "id": "4c084da3-75af-45b4-a64c-be798e679261",
              "name": "reformat kvPairs field back to an escaped JSON string format",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.kvPairs_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 19
        },
        {
          "id": "d928b066-96f8-4533-9129-ac39e9baed6e",
          "rules": [
            {
              "id": "97950889-6542-44f9-bce9-deaa373f1a30",
              "name": "Parse kvPairs_tmp as JSON to root",
              "description": "",
              "sourceField": "text.kvPairs_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 20
        }
      ],
      "order": 1
    },
    {
      "id": "e288158a-8a99-4b00-ad70-7d2db4dbc32e",
      "name": "remove fields",
      "description": "",
      "creator": "thulasiram.toorpu@coralogix.com",
      "enabled": false,
      "hidden": false,
      "ruleSubgroups": [
        {
          "id": "a67eb19b-2e74-4d50-a45e-c93f720a04e0",
          "rules": [
            {
              "id": "e358482b-f4e1-4e56-989f-910354823239",
              "name": "remove fields",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "removeFieldsParameters": {
                  "fields": [
                    "resource.attributes.cloud_provider",
                    "resource.attributes.cloud_account_id",
                    "resource.attributes.cloud_availability_zone",
                    "resource.attributes.cloud_platform"
                  ]
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 3
    },
    {
      "id": "054933a1-af4f-4e5c-a460-3768b38dbd2a",
      "name": "Severity Rules",
      "description": "",
      "creator": "",
      "enabled": true,
      "hidden": false,
      "ruleSubgroups": [
        {
          "id": "c6d0d7f1-0de0-46f3-9915-eb3d44239ff7",
          "rules": [
            {
              "id": "ea93df75-2d47-4bf4-be6c-924801bd70b3",
              "name": "Severity Rule",
              "description": "Look for default severity text",
              "sourceField": "text",
              "parameters": {
                "extractParameters": {
                  "rule": "\\b(?P<severity>DEBUG|TRACE|INFO|WARN|ERROR|FATAL|EXCEPTION|[Dd]ebug|[Tt]race|[Ii]nfo|[Ww]arn|[Ee]rror|[Ff]atal|[Ee]xception)\\b"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 4
    }
  ],
  "count": 3,
  "resource_identifiers": [
    "5c192196-6b12-4a4d-9a27-741bd2aacf9e",
    "e288158a-8a99-4b00-ad70-7d2db4dbc32e",
    "054933a1-af4f-4e5c-a460-3768b38dbd2a"
  ]
}