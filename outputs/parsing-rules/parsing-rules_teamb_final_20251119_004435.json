{
  "timestamp": "2025-11-19T00:44:35.948570",
  "service": "parsing-rules",
  "team": "teamb_final",
  "resources": [
    {
      "id": "3515c5eb-7cb4-45e2-85b8-2feda266ce9d",
      "name": "k8s Opentelemetry parsing",
      "description": "k8s Opentelemetry extension pack",
      "creator": "k8s Opentelemetry extension pack",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "c89968f2-c340-4abe-b478-137921f96457",
          "rules": [
            {
              "id": "5f08c7e2-d02b-4204-bb57-b31bbe31cf03",
              "name": "Stringify logRecord",
              "description": "",
              "sourceField": "text.logRecord",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.logRecord_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "f0bb3fc3-cd77-47fe-bda5-ae876173c652",
          "rules": [
            {
              "id": "1ff9cfef-631a-4979-83f8-94ae84b240a7",
              "name": "Parse json logRecord_tmp",
              "description": "",
              "sourceField": "text.logRecord_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "da740e20-a48c-491d-8c1d-ddf048276c68",
          "rules": [
            {
              "id": "77e8113a-10ad-4d27-af7e-5e48b0b71000",
              "name": "Parse json body",
              "description": "",
              "sourceField": "text.body",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        },
        {
          "id": "72c9ffa0-9e9b-4025-b31b-06a44fadf74f",
          "rules": [
            {
              "id": "88d7fa4f-3ce2-4ccd-97b3-7ba03efcb255",
              "name": "map deprecatedLastTimestamp, eventTime as datetime fields",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"${1}_custom_timestamp\":\"",
                  "rule": "\"(deprecatedLastTimestamp|eventTime)\":\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 4
        },
        {
          "id": "7bae5294-a386-40ed-b4df-e12a460d02fd",
          "rules": [
            {
              "id": "12a8a537-31f1-4b4f-9322-0e55207746a5",
              "name": "fix mapping exception for infra collector empty f:annotations",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "${1}\"f:workflow\":{",
                  "rule": "(\"f:annotations\":\\{.*?)\"\\.\":\\{"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 5
        },
        {
          "id": "2ccac124-c904-4e56-8742-abeb1c3261ac",
          "rules": [
            {
              "id": "97e5dd8f-a314-49b1-9027-77656cfe4855",
              "name": "Parse common logs from k8s containers",
              "description": "This rule parses containers: kube-apiserver, kube-controller-manager, kube-proxy, kube-scheduler, storage-provisioner.",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"message\":\"$message\"",
                  "rule": "\"body\":\"(?P<level>[A-Z])(?P<timestamp>\\d{4} \\d{2}:\\d{2}:\\d{2}\\.\\d+)\\s*1 (?P<caller>[^\\]]+)\\] (?P<message>(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "653c558c-619f-40ac-b341-b91b602e7f8a",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with time",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(time=\\\\\"(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 2
            },
            {
              "id": "0dfabc3a-723c-4c0c-bd28-83476fd8639f",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with ts",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(ts=\\d{4}(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 3
            },
            {
              "id": "011828df-c696-4874-bc7d-3dce42cf341e",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with level",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(level=(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 4
            }
          ],
          "enabled": true,
          "order": 6
        },
        {
          "id": "ac9ac357-2f85-4f6e-b2da-f1a1671ffe3c",
          "rules": [
            {
              "id": "ab8bff28-6ed9-49de-acde-a47f041136ef",
              "name": "Extract msg from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "extractParameters": {
                  "rule": "msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 7
        },
        {
          "id": "993fd3d3-0e12-4c8b-a32d-c74035baa5ed",
          "rules": [
            {
              "id": "82603dc9-f30e-4945-8a62-22ce223e8c94",
              "name": "Remove msg from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\s+msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 8
        },
        {
          "id": "a8f133e0-0566-4b37-ba10-9de8b52d2815",
          "rules": [
            {
              "id": "ed8c78ff-5c92-48ee-9997-12d786b396d2",
              "name": "Extract query from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "extractParameters": {
                  "rule": "query=\\\\\"(?P<query>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "b44936b9-1a36-4262-acb4-b272f0936ddc",
              "name": "Extract query from kvPairs when kvPairs also had msg in it along with query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "extractParameters": {
                  "rule": "query=\\\\\\\\\\\\\"(?P<query>(?:\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 9
        },
        {
          "id": "07b5af74-c5aa-4fc8-991c-0f0880c67e60",
          "rules": [
            {
              "id": "64053f5c-6498-41f2-849d-997ece128be8",
              "name": "remove query from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\s+query=\\\\\"(?P<query>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "48f2d9bf-05c8-4f73-b40a-57a171f553bc",
              "name": "remove query from kvPairs when kvPairs also had msg in it along with query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\s+query=\\\\\\\\\\\\\"(?P<query>(?:\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 10
        },
        {
          "id": "a1b93094-1e37-4fe8-9b6f-0df23b97ff4b",
          "rules": [
            {
              "id": "fc13fc91-83ac-4908-b44f-dcc495dff129",
              "name": "prepare all the rest of the fields in a kvPairs field that had both msg and query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                  "rule": "([\\w\\.\\-\\_]+)=\\\\{7}\"((?:\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\+\"|[^\"])+)\\\\{7}\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "c44cf214-ceb2-4323-8f68-23ef8ea0eb10",
              "name": "prepare all the rest of the fields in a kvPairs field that had either msg or query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                  "rule": "([\\w\\.\\-\\_]+)=\\\\{3}\"((?:\\\\\\\\\\\\\\\\+\"|[^\"])+)\\\\{3}\""
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 11
        },
        {
          "id": "fe451020-f3b8-483a-b41b-1a16940b3039",
          "rules": [
            {
              "id": "9dbe5677-7d0d-44d8-a792-c96136d6262a",
              "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had both msg and query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\\\{15,}\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "8bb3f787-4d45-4fcc-ac6e-3d9cd7974b8b",
              "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had either msg or query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\\\{7,}\""
                }
              },
              "enabled": true,
              "order": 2
            },
            {
              "id": "c62577db-6978-4b2a-8c66-b94718774201",
              "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had no msg or query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\\\{3,}\""
                }
              },
              "enabled": true,
              "order": 3
            }
          ],
          "enabled": true,
          "order": 12
        },
        {
          "id": "29ed9d0b-2031-4e50-9342-edefe6bd9d65",
          "rules": [
            {
              "id": "319c9302-11cb-486b-9437-befd281c2ac3",
              "name": "Replace all remaining occurrences of double quotes with their corresponding backslash with \u00a7",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7",
                  "rule": "\\\\+\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 13
        },
        {
          "id": "9fc80b7d-9389-4007-8bab-d21be64f7510",
          "rules": [
            {
              "id": "27096fd6-647f-4bc5-b38f-783e6c3fda01",
              "name": "wrap the keys of the key/val pairs with \u00a7 wrapping the value with \u00a7",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                  "rule": "([\\w\\.\\-]+)=\\xA7([^\\xA7]*)\\xA7"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 14
        },
        {
          "id": "2ac8092f-ea10-470d-ae78-83727e2a9d76",
          "rules": [
            {
              "id": "3ce2e7ca-5035-4a8a-acd2-22be68925be5",
              "name": "Adding to the rest of key/val pairs \u00a7 before and after the keys and values",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                  "rule": "([\\w\\.\\-\\_]+)=((?:$|[^ ])*)(?: |$)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 15
        },
        {
          "id": "ec43148a-0385-4faf-a23e-bc01e2603bf6",
          "rules": [
            {
              "id": "6e864aad-731c-4669-932a-2d41a4c90220",
              "name": "Adding commas between key/val pairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "${1}:${2},",
                  "rule": "(\\xA7[^\\xA7]*\\xA7):(\\xA7[^\\xA7]*\\xA7)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 16
        },
        {
          "id": "0841c317-4a3a-4245-95a0-2797b97b0373",
          "rules": [
            {
              "id": "d6135c7f-c3c1-4cc3-a9b2-abc34b592d07",
              "name": "Remove last comma before jsonizing kvPairs field",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "{$1}",
                  "rule": "(.*),"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 17
        },
        {
          "id": "a50300c5-fe11-49c6-8f34-a87870a43570",
          "rules": [
            {
              "id": "dfe8b23b-e046-4050-b987-67801becb7b6",
              "name": "Replacing \u00a7 with \" to jsonize kvPairs in order to get a valid JSON",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\"",
                  "rule": "\\xA7"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 18
        },
        {
          "id": "6211dece-c408-4200-a1ef-530e866b0b4a",
          "rules": [
            {
              "id": "d2328982-f5dd-4cfc-89a1-527fc9bd1a20",
              "name": "reformat kvPairs field back to an escaped JSON string format",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.kvPairs_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 19
        },
        {
          "id": "97f23a4c-3d1d-4c5d-9bde-55883bb02a3b",
          "rules": [
            {
              "id": "1ffd33bb-75f4-4a88-a790-13e415677bf4",
              "name": "Parse kvPairs_tmp as JSON to root",
              "description": "",
              "sourceField": "text.kvPairs_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 20
        }
      ],
      "order": 1
    },
    {
      "id": "f31216f5-06c2-4f75-b6c8-f260d815db78",
      "name": "Db Snapshot Made Public (Security)",
      "description": "",
      "creator": "AWS-Application",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "7d764891-3e56-4cfc-8b6e-543aef57966e",
          "rules": [
            {
              "id": "18f7376c-275e-41d6-b614-8b2180d12dae",
              "name": "DB snapshot made public ",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"db_snapshot_made_public\":\"true\"$1",
                  "rule": "\"dBSnapshotAttributes\"\\s*:\\s*\\[\\s*\\{\\s*\"attributeName\"\\s*:\\s*\"restore\"\\s*,\\s*\"attributeValues\"\\s*:\\s*\\[\\s*\"all\"\\s*\\]\\s*\\}\\s*\\]"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 2
    },
    {
      "id": "1fb0df15-eefc-4b0a-8055-b3cb99e84f3f",
      "name": "Data Normalization - GitHub (Security)",
      "description": "",
      "creator": "GitHub",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "22adabb0-2603-4354-af99-b411950931bd",
          "rules": [
            {
              "id": "674f7139-50d9-4c26-a617-131f0cf6694f",
              "name": "Event Name",
              "description": "",
              "sourceField": "text.github.action",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<event_name>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "f400cea8-9c2a-46c6-bd22-f92e13cfae91",
          "rules": [
            {
              "id": "e08c12d3-35eb-4f9e-b863-b1b8272ccf0b",
              "name": "User Name",
              "description": "",
              "sourceField": "text.github.sender.login",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<username>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "1acaf32f-2db4-487f-8d71-9d3662db1bd4",
          "rules": [
            {
              "id": "a26f0dd0-3b6e-4c29-aedb-d30be0cc6023",
              "name": "Source",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "$1\"source\":\"GitHub\",\"service\":\"GitHub\",$2",
                  "rule": "(.*\"cx_security\":{)(.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        }
      ],
      "order": 3
    },
    {
      "id": "d5ad7c48-1e13-47c7-b078-66c2611abf4f",
      "name": "AWS CloudTrail - max fields - stringifying fields (Security)",
      "description": "",
      "creator": "AWS CloudTrail - Security Extension",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "0265ee65-921c-4b15-9388-72c8fa05ddfc",
          "rules": [
            {
              "id": "5fdb14cf-5c81-47ff-945f-9fd77544d0cf",
              "name": "tlsDetails",
              "description": "",
              "sourceField": "text.tlsDetails",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.tlsDetails_str",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "2c35f004-8728-42be-bd64-864fece0f3e8",
          "rules": [
            {
              "id": "8ee9532f-f9fc-4805-bcf9-3dd8ae1bdabd",
              "name": "resources",
              "description": "",
              "sourceField": "text.resources",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.resources_str",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "b64e2380-6d08-4060-88a9-de3b15bf400a",
          "rules": [
            {
              "id": "0ca3f566-56e1-4756-8930-3a92369c4698",
              "name": "requestParameters.actions",
              "description": "",
              "sourceField": "text.requestParameters.actions",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.requestParameters.actions_str",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        },
        {
          "id": "c8d585c0-0b9a-4224-bb50-1e53866fb07f",
          "rules": [
            {
              "id": "fd0fe87b-0ca8-4579-8a65-11d0eb2d01b9",
              "name": "requestParameters.conditions",
              "description": "",
              "sourceField": "text.requestParameters.conditions",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.requestParameters.conditions_str",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 4
        },
        {
          "id": "900b1e3a-60ac-4b76-a0bc-3aa0bf3fc7f2",
          "rules": [
            {
              "id": "bc27a606-583c-4f85-814b-b06930a655a9",
              "name": "requestParameters.ipPermissions.items",
              "description": "",
              "sourceField": "text.requestParameters.ipPermissions.items",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.requestParameters.ipPermissions.items_str",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 5
        },
        {
          "id": "0bf4f492-1133-4c27-80d6-bd35a48c4e63",
          "rules": [
            {
              "id": "03a22d85-cc84-40ad-aef2-5aaad0c32d01",
              "name": "requestParameters.tags",
              "description": "",
              "sourceField": "text.requestParameters.tags",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.requestParameters.tags_str",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 6
        },
        {
          "id": "9ebd5f62-c8ad-45b6-aee3-5d15e1e81f8b",
          "rules": [
            {
              "id": "5d6c6014-30e0-4946-b306-d844b7039fdb",
              "name": "responseElements.policy.tags",
              "description": "",
              "sourceField": "text.responseElements.policy.tags",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.responseElements.policy.tags_str",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 7
        },
        {
          "id": "22871cbc-e2f9-4031-8b1b-1d3db060a1b4",
          "rules": [
            {
              "id": "7e6da931-2b2a-4f5f-9410-451cb7c99038",
              "name": "responseElements.loadBalancers",
              "description": "",
              "sourceField": "text.responseElements.loadBalancers",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.responseElements.loadBalancers_str",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 8
        },
        {
          "id": "828b21d9-0b9b-4e54-bf6a-89472f2f5a76",
          "rules": [
            {
              "id": "26796e5c-690a-4c50-842b-71882e10a95e",
              "name": "responseElements.rules",
              "description": "",
              "sourceField": "text.responseElements.rules",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.responseElements.rules_str",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 9
        },
        {
          "id": "98bc7509-751a-46bb-a139-d7dc2b7a1f5f",
          "rules": [
            {
              "id": "8fc36a8f-7f5c-4535-b7af-9a0b3a3a9b3b",
              "name": "responseElements.instancesSet.items",
              "description": "",
              "sourceField": "text.responseElements.instancesSet.items",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.responseElements.instancesSet.items_str",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 10
        },
        {
          "id": "7c873101-67a4-4221-a559-5b13a63b0438",
          "rules": [
            {
              "id": "e4b12c45-311b-45a3-a63c-f592be5cf24b",
              "name": "responseObject.metadata.managedFields",
              "description": "",
              "sourceField": "text.responseObject.metadata.managedFields",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.responseObject.metadata.managedFields_str",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 11
        }
      ],
      "order": 4
    },
    {
      "id": "8fa2fb7f-3046-4429-bd9e-49820b46b95d",
      "name": "Data Normalization - GuardDuty (Security)",
      "description": "",
      "creator": "STAa",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "074157727657"
          }
        },
        {
          "subsystemName": {
            "value": "adservice"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "43cd7cd2-e353-4996-a5bc-b64f2baf3fb8",
          "rules": [
            {
              "id": "be6c68ec-f74e-4ac6-94e7-5711384a6735",
              "name": "Event Name",
              "description": "",
              "sourceField": "text.detail.type",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<event_name>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "b09b47d6-e474-4fbf-a759-bc885adbb352",
          "rules": [
            {
              "id": "a4c6dd5d-4283-4643-95d5-84cb4cc772c8",
              "name": "Resource",
              "description": "",
              "sourceField": "text.detail.resource.instancedetails.instanceid",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<resource>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "9615d40b-19bf-4ba2-94cc-83696749cdb3",
          "rules": [
            {
              "id": "c74f10ca-c1fb-4266-a019-be50df0a4690",
              "name": "Source Host Name",
              "description": "",
              "sourceField": "text.detail.resource.instanceDetails.networkInterfaces.privateDnsName",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<source_hostname>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        },
        {
          "id": "cdc95752-c089-4efa-962e-4f66df8d83c8",
          "rules": [
            {
              "id": "0711ad82-1b15-4dd2-9ae8-8d4149ca2ab6",
              "name": "Source IP",
              "description": "",
              "sourceField": "text.detail.resource.instanceDetails.networkInterfaces.privateIpAddress",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<source_ip>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 4
        },
        {
          "id": "99716509-731e-4e60-9ea9-08126834dc67",
          "rules": [
            {
              "id": "9bda3278-0475-4802-9c27-1f8a74e4d4ab",
              "name": "Source",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "$1\"source\":\"AWS\",\"service\":\"GuardDuty\",$2",
                  "rule": "(.*\"cx_security\":{)(.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 5
        }
      ],
      "order": 5
    },
    {
      "id": "30273d4a-161c-485e-a0f7-814db82b4981",
      "name": "Data Normalization - CrowdStrike (Security).",
      "description": ".",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "app-demo"
          }
        },
        {
          "subsystemName": {
            "value": "audit-logs"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "12143b69-8e72-4ba6-9ff1-53c3852d9cc9",
          "rules": [
            {
              "id": "28e4da65-41ed-4d91-8ba1-fb47612871da",
              "name": "Email",
              "description": "",
              "sourceField": "text.event.UserId",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<email>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "9eaa49fd-c21e-41e7-91c5-0dafdbed6a77",
          "rules": [
            {
              "id": "15c7fe80-3d33-43c5-ada5-00d5e18f68e7",
              "name": "Event Name",
              "description": "",
              "sourceField": "text.metadata.eventType",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<event_name>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "13224969-36a3-479e-963d-c6e6f96a8591",
          "rules": [
            {
              "id": "a40d94ba-6a0b-4013-8422-48b0570bffb0",
              "name": "Source IP",
              "description": "",
              "sourceField": "text.event.UserIp",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<source_ip>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        },
        {
          "id": "efafd7c3-e6af-43a9-970b-e66c5c5eb1db",
          "rules": [
            {
              "id": "f780b7a8-b42e-4131-941b-a5e97db8cb7e",
              "name": "Source",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "$1\"source\":\"CrowdStrike\",\"service\":\"CrowdStrike\",$2",
                  "rule": "(.*\"cx_security\":{)(.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 4
        }
      ],
      "order": 6
    },
    {
      "id": "4eacfd86-1bc7-4dc9-9a0f-78bf1f6a37b1",
      "name": "AWS CloudTrail - AMI Made Public (Security)",
      "description": "",
      "creator": "AWS-Application",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "81d82079-8cd1-4297-b315-77c3af05a23a",
          "rules": [
            {
              "id": "861730eb-ec4c-4e13-8522-dd50ada149ad",
              "name": "Array converter",
              "description": "creates a new object called \"group_all\" with the value of \"true\" when exists to be detected by the corresponding alert",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"ami_made_public\":\"true\"$1",
                  "rule": "\"launchPermission\"\\s*:\\s*\\{\\s*\"add\"\\s*:\\s*\\{\\s*\"items\"\\s*:\\s*\\[\\s*\\{\\s*\"group\"\\s*:\\s*\"all\"\\s*\\}\\s*\\]\\s*\\}\\s*\\}"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 7
    },
    {
      "id": "0496b342-091a-48a5-a0b9-e4aff8778ca0",
      "name": "Data Normalization - CloudTrail (Security)",
      "description": "",
      "creator": "CloudTrail",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "2023fa8a-8434-4223-8f0e-7e46f846a139",
          "rules": [
            {
              "id": "59658b5c-78fa-41a8-9dc3-0e69fcf1c319",
              "name": "Event Name",
              "description": "",
              "sourceField": "text.eventName",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<event_name>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "2bd4b3b8-148f-44c5-93f3-f2358feb07a4",
          "rules": [
            {
              "id": "2e4c9d24-2ad2-4cf1-8a63-8dc9354de0e9",
              "name": "Resource",
              "description": "",
              "sourceField": "text.userIdentity.sessionContext.sessionIssuer.arn",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<resource>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "52d4a2da-de98-4810-857d-fc935bf07a2b",
          "rules": [
            {
              "id": "7ca73986-5c71-4c85-a023-cf0b662bcd0e",
              "name": "Source IP",
              "description": "",
              "sourceField": "text.sourceIPAddress",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<source_ip>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        },
        {
          "id": "25c5da73-85a4-408e-9be8-d972bff945cd",
          "rules": [
            {
              "id": "8b580bae-e337-4365-a854-376114b9f489",
              "name": "User Name",
              "description": "",
              "sourceField": "text.userIdentity.sessionContext.sessionIssuer.userName",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text.cx_security",
                  "rule": "(?P<username>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 4
        },
        {
          "id": "d34c05d1-f57f-484e-9092-d62192249628",
          "rules": [
            {
              "id": "9fc6ccf4-2b39-471e-aef8-15e9027bce9a",
              "name": "Source",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "$1\"source\":\"AWS\",\"service\":\"CloudTrail\",$2",
                  "rule": "(.*\"cx_security\":{)(.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 5
        }
      ],
      "order": 8
    },
    {
      "id": "a9c191e3-4dcc-47dc-a576-b1f845bb008f",
      "name": "k8s Opentelemetry parsing",
      "description": "k8s Opentelemetry extension pack",
      "creator": "jasvinder.atwal@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "fa643f34-b4f3-482c-8b73-52b5361eb430",
          "rules": [
            {
              "id": "67882e45-43c9-4fc6-9658-d1046cbf5901",
              "name": "Stringify logRecord",
              "description": "",
              "sourceField": "text.logRecord",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.logRecord_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "84622ba1-62e8-442b-9656-1f2d8cf11b5d",
          "rules": [
            {
              "id": "e67d7d99-1bba-4634-a463-1b244d1a20be",
              "name": "Parse json logRecord_tmp",
              "description": "",
              "sourceField": "text.logRecord_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "3394f9d8-3a0b-4357-9411-bf3710b722ed",
          "rules": [
            {
              "id": "070fa80e-abed-4ef9-af98-9b7f107f8f8d",
              "name": "Stringify body",
              "description": "",
              "sourceField": "text.body",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.body_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        },
        {
          "id": "fb38383c-ff64-4a23-8b28-d3f09b6a7e0b",
          "rules": [
            {
              "id": "8b66adb9-06cd-45c8-b7da-8a827bed3528",
              "name": "Parse json body",
              "description": "",
              "sourceField": "text.body",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "0ae82c11-4fe6-40da-b80a-9fb6ba490770",
              "name": "Parse json body_tmp",
              "description": "",
              "sourceField": "text.body_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 4
        },
        {
          "id": "e9e02c30-3d96-4f4b-ad8b-922bc977b7e5",
          "rules": [
            {
              "id": "fcaf0602-dd83-45ac-b8a8-167a13564e12",
              "name": "Replacing all dots within field names with underscores",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"${1}_${2}_${3}_${4}_${5}_${6}_${7}_${8}_${9}_${10}\":",
                  "rule": "\"([a-zA-Z\\d\\_]+)\\.([a-zA-Z\\d\\_]+)(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?\":"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 5
        },
        {
          "id": "1b61c186-438e-4cd8-8117-4cd22e9c2a8d",
          "rules": [
            {
              "id": "a24aeecc-6250-4f75-9570-f7c85b1dafbb",
              "name": "Remove trailing underscores",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"$1\":",
                  "rule": "\"([^\"]+?)\\_+\":"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 6
        },
        {
          "id": "355101ab-7cdf-4074-8e7a-44f309541b9f",
          "rules": [
            {
              "id": "9a85bd2e-9f5b-42b2-9d1e-f65aa73947fe",
              "name": "map deprecatedLastTimestamp, eventTime as datetime fields",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"${1}_custom_timestamp\":\"",
                  "rule": "\"(deprecatedLastTimestamp|eventTime)\":\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 7
        },
        {
          "id": "a0aaf080-3e1f-436f-997e-4ab3a63c95e2",
          "rules": [
            {
              "id": "e0646eba-6186-41c1-9872-e65d0eb647b6",
              "name": "fix mapping exception for infra collector empty f:annotations",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "${1}\"f:workflow\":{",
                  "rule": "(\"f:annotations\":\\{.*?)\"\\.\":\\{"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 8
        },
        {
          "id": "423b79ad-cd81-4d42-9c11-8aa995c2489a",
          "rules": [
            {
              "id": "6c2629b7-03b1-4c8d-a3e0-c2c19900cc97",
              "name": "Parse common logs from k8s containers",
              "description": "This rule parses containers: kube-apiserver, kube-controller-manager, kube-proxy, kube-scheduler, storage-provisioner.",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"message\":\"$message\"",
                  "rule": "\"body\":\"(?P<level>[A-Z])(?P<timestamp>\\d{4} \\d{2}:\\d{2}:\\d{2}\\.\\d+)\\s*1 (?P<caller>[^\\]]+)\\] (?P<message>(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "f3f0a974-9a2d-4a5e-8bbe-1ca2191bdef2",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with time",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(time=\\\\\"(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 2
            },
            {
              "id": "bd8dfe6a-e65e-44b6-8661-c10ac7bae284",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with ts",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(ts=\\d{4}(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 3
            }
          ],
          "enabled": true,
          "order": 9
        },
        {
          "id": "5289dd0e-33ec-422d-abb3-4fd54f77ef48",
          "rules": [
            {
              "id": "ef010023-f5c2-44a5-82c6-adae1c57f5b6",
              "name": "Extract msg from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "extractParameters": {
                  "rule": "msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 10
        },
        {
          "id": "08dc7760-f32e-473e-887c-687b0457cb04",
          "rules": [
            {
              "id": "d891f543-1a59-44ab-911b-e37749846401",
              "name": "Remove msg from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\smsg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 11
        },
        {
          "id": "4242a511-f7f7-4902-b0d5-4802f1f72610",
          "rules": [
            {
              "id": "15988db1-c206-41db-9b60-c905dfb1164f",
              "name": "Jsonizing key/vals when val is enclosed with double quotes",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7$1\u00a7:\u00a7$2\u00a7,",
                  "rule": "([\\w\\.\\-]+)=\\\\\\\\\\\\\"((?:\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 12
        },
        {
          "id": "74605b30-2f29-40a5-a6c3-69048e3fb71a",
          "rules": [
            {
              "id": "d42d53ec-ac73-4ca8-8eb9-21630334984b",
              "name": "Remove any remaining backslashes followed by double quotes",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\\\+\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 13
        },
        {
          "id": "9b1a230b-17ba-492c-939c-c63912fe8077",
          "rules": [
            {
              "id": "6946039d-8e2b-4e09-adbb-160e47bcd2bb",
              "name": "Jsonizing rest of key/vals",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7$1\u00a7:\u00a7$2\u00a7,",
                  "rule": "([\\w\\.\\-]+)=((?:$|[^ \\xA7])+)?(?: |$)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 14
        },
        {
          "id": "d909fd70-8f45-4137-86ef-0384cdc9259c",
          "rules": [
            {
              "id": "abc9ac8b-2899-4b30-b646-37a2d7af12d0",
              "name": "Removing last Comma and wrapping with curly brackets",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "{$1}",
                  "rule": "(.*),"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 15
        },
        {
          "id": "6ab45e8f-6efa-4eb0-9e34-4bac629f148e",
          "rules": [
            {
              "id": "194bcab6-b42f-49e7-87d8-43291be3e058",
              "name": "Replacing \u00a7 with double quotes in order to get a valid JSON",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\"",
                  "rule": "\\xA7"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 16
        },
        {
          "id": "d3033b41-8e52-4238-b50b-f7c40472c3ee",
          "rules": [
            {
              "id": "ba9417f6-2c3a-49ae-9f8b-a2c043aa4056",
              "name": "reformat kvPairs field back to an escaped JSON string format",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.kvPairs_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 17
        },
        {
          "id": "769cb3ca-9884-4da8-959b-fb70e72e22d2",
          "rules": [
            {
              "id": "9631b8bd-29a1-4716-bb04-4cf92fd1fea9",
              "name": "Parse kvPairs_tmp as JSON to root",
              "description": "",
              "sourceField": "text.kvPairs_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 18
        },
        {
          "id": "b2762b92-b677-41bc-82d3-ddf0b9b2e9f2",
          "rules": [
            {
              "id": "2116166c-87c1-4193-91c0-8283ea835fe9",
              "name": "Extract json.trace_id ",
              "description": "{\"observedTimeUnixNano\":1744818871177174088,\"resource\":{\"attributes\":{\"k8s_pod_name\":\"frontend-69d989d8dd-tnwxc\",\"k8s_container_restart_count\":\"0\",\"k8s_pod_uid\":\"4fea94df-ac83-45af-ac5d-078a76365c38\",\"k8s_container_name\":\"server\",\"k8s_namespace_name\":\"default\",\"k8s_cluster_name\":\"onlineboutique\",\"cx_otel_integration_name\":\"coralogix-integration-helm\",\"k8s_deployment_name\":\"frontend\",\"k8s_node_name\":\"ip-172-31-14-14.us-east-2.compute.internal\",\"host_name\":\"ip-172-31-14-14.us-east-2.compute.internal\",\"os_type\":\"linux\",\"host_id\":\"i-09f3a61cd39f3ae71\",\"cloud_provider\":\"aws\",\"cloud_platform\":\"aws_ec2\",\"cloud_region\":\"us-east-2\",\"cloud_account_id\":\"074157727657\",\"cloud_availability_zone\":\"us-east-2a\",\"host_image_id\":\"ami-02b2ce7c83227ce13\",\"host_type\":\"t3.large\"}},\"timeUnixNano\":1744818871043095596,\"scope\":{\"attributes\":{}},\"resourceSchemaUrl\":\"https:\\/\\/opentelemetry.io\\/schemas\\/1.6.1\",\"json\":{\"http_req_ip_geoip\":{\"ip\":\"158.46.145.28\",\"ip_ipaddr\":\"158.46.145.28\",\"location_geopoint\":{\"lat\":52.2299,\"lon\":21.0093},\"continent_name\":\"Europe\",\"country_name\":\"Poland\",\"city_name\":\"Warsaw\",\"postal_code\":\"00-510\",\"is_local\":false,\"asn\":{\"number\":\"59729\",\"organization\":\"Green Floid LLC\"}},\"http_req_id\":\"713a8831-2aec-4670-8fb9-7bae628307b8\",\"http_req_ip\":\"158.46.145.28\",\"http_req_method\":\"GET\",\"http_req_path\":\"\\/cart\",\"session\":\"a1548467-f87d-499e-b1cf-78829da93a54\",\"severity\":\"debug\",\"span_id\":\"3e67b3e9962fcd8c\",\"timestamp\":\"2025-04-16T15:54:31.042989207Z\",\"trace_id\":\"4cd3da495f7e8399a941900b950b7bd9\"},\"attributes\":{\"log_file_path\":\"\\/var\\/log\\/pods\\/default_frontend-69d989d8dd-tnwxc_4fea94df-ac83-45af-ac5d-078a76365c38\\/server\\/0.log\",\"log_iostream\":\"stdout\",\"logtag\":\"F\",\"time\":\"2025-04-16T15:54:31.043095596Z\"}}",
              "sourceField": "text",
              "parameters": {
                "extractParameters": {
                  "rule": "\"json\":\\{.*?\"trace_id\":\"(?P<trace_id>[^\"]+)\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 19
        }
      ],
      "order": 9
    },
    {
      "id": "ba5716ce-cb7e-45bf-b3f1-33e09889720c",
      "name": "AWS status rules",
      "description": "",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "subsystemName": {
            "value": "aws-status"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "b952bbbc-7fb9-45f4-9196-3428b5c89802",
          "rules": [
            {
              "id": "a5e16d0a-6caa-4e67-a733-b5145ae5b024",
              "name": "Replace \"resolved\" messages level to INFO",
              "description": "",
              "sourceField": "text.aws.title",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "severity",
                  "replaceNewVal": "INFO",
                  "rule": "RESOLVED"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 10
    },
    {
      "id": "aaf89b1b-2580-4628-a63c-f96fc73b903c",
      "name": "Cloudtrail rules",
      "description": "Cloudtrail extension pack",
      "creator": "Cloudtrail extension pack",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "cfec2db0-e284-455a-a8ac-0536b84b45fe",
          "rules": [
            {
              "id": "1e8b36a3-e5b0-4310-a255-17e0425f2bd6",
              "name": "Replace Cloudtrail log severity to error if errorMessage exists",
              "description": "",
              "sourceField": "text.errorMessage",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "severity",
                  "replaceNewVal": "ERROR",
                  "rule": ".*"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 11
    },
    {
      "id": "6bd74954-92ff-4a91-85a8-09383ead4d9d",
      "name": "Replace AWS host name with host ip - For metrics correlation",
      "description": "Hey You - Adi Golan here please DO NOT DELETE this rule - Thanks! :)",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "993c524d-0eb0-4621-b3aa-cb3b9d5752a6",
          "rules": [
            {
              "id": "d2d1e82e-e4ea-4bf8-ac05-4834c6b564b7",
              "name": "replace host with the host ip solely",
              "description": "{\"cloud\":{\"account\":{\"id\":\"074157727657\"},\"availability_zone\":\"us-east-2a\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-0f7afac2798217d04\"},\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"region\":\"us-east-2\",\"service\":{\"name\":\"EC2\"}},\"kubernetes\":{\"container\":{\"id\":\"dd6e99a9c3900e93bf2744fc03925544481e0d8f1a8df84aa1c68f45f888de95\",\"name\":\"server\"},\"deployment\":{\"name\":\"frontend\"},\"namespace\":\"default\",\"namespace_labels\":{\"kubernetes_io/metadata_name\":\"default\"},\"namespace_uid\":\"21a7e2d9-7da6-4a74-97f7-d04a7dbbb77a\",\"node\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"labels\":{\"beta_kubernetes_io/arch\":\"amd64\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"k8s_io/cloud-provider-aws\":\"5ae15d428da2ffa3cd3bbc9149af8ce1\",\"kubernetes_io/arch\":\"amd64\",\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"kubernetes_io/os\":\"linux\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"topology_kubernetes_io/region\":\"us-east-2\",\"topology_kubernetes_io/zone\":\"us-east-2a\"},\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"uid\":\"5a512b89-9f46-416c-874e-9572c0b38ecc\"},\"pod\":{\"ip\":\"172.31.3.40\",\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"69d989d8dd\"},\"name\":\"frontend-69d989d8dd-lbnrg\",\"uid\":\"c19d2ea0-be65-4886-8b4d-df814c967f0b\"},\"replicaset\":{\"name\":\"frontend-69d989d8dd\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2023-08-21T20:32:47.713Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"json\":{\"http_req_ip_geoip\":{\"ip\":\"34.206.39.153\",\"ip_ipaddr\":\"34.206.39.153\",\"location_geopoint\":{\"lat\":39.0469,\"lon\":-77.4903},\"continent_name\":\"North America\",\"country_name\":\"United States\",\"city_name\":\"Ashburn\",\"postal_code\":\"20149\"},\"http_req_id\":\"92313d79-b665-47eb-a0d4-7a08c7dec302\",\"http_req_ip\":\"34.206.39.153\",\"http_req_method\":\"POST\",\"http_req_path\":\"/cart\",\"http_resp_bytes\":0,\"http_resp_status\":302,\"http_resp_took_ms\":4,\"session\":\"097733bc-6386-475e-bfbc-6ada1a96e9be\",\"severity\":\"debug\",\"span_id\":\"4cf425fb8ed181d7\",\"timestamp\":\"2023-08-21T20:32:47.713652989Z\",\"trace_id\":\"f76998ff4a582250107c6a44e35ac47f\"},\"message\":\"request POST /cart completed with status: 302. requestID: 92313d79-b665-47eb-a0d4-7a08c7dec302\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"host\":\"${1}.${2}.${3}.${4}\"",
                  "rule": "\"host\":\"ip\\-(\\d{1,3})\\-(\\d{1,3})\\-(\\d{1,3})\\-(\\d{1,3})\\.[^\"]+\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 12
    },
    {
      "id": "70802300-9bf1-48d8-b21a-b4e91d12bca9",
      "name": "PII - Mask Email addresses",
      "description": "",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "statuspage"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "3a4a2770-bf91-4934-a857-26c70d50e2f4",
          "rules": [
            {
              "id": "8167b687-ffe8-4da6-9620-e9cbe485e435",
              "name": "Mask Email addresses",
              "description": "{\"log\":\"Error on adding subscription.\",\"type\":\"we1-prd-portal-slices-product\",\"Msg_obj\":{\"Data\":{\"Arguments\":{\"SubscriptionRequest\":{\"CultureCode\":\"en-US\",\"SubscriberId\":\"test_email@gmail.com\",\"Topics\":[{\"DeliveryChannels\":[{\"Address\":\"test_email@gmail.com\",\"Platform\":\"Email\",\"Source\":\"10003_nibis_email\"}],\"Specification\":{\"CountryId\":\"165\",\"ProductId\":\"15756113\",\"Scale\":\"750\",\"Size\":\"27\"},\"TypeId\":\"BackInStock\"}]}},\"Class\":\"Farfetch.Web.Slices.Product.Infrastructure.CrossCutting.Resilience.Clients.MarketingApi.ResilientSubscriptionsClient\",\"ConnectionId\":\"0HMQQJHR59PJ8\",\"Exception\":{\"ApplicationErrors\":[{\"Code\":\"500\",\"DeveloperMessage\":\"Operation canceled\",\"Exception\":{\"InnerException\":{\"InnerException\":{\"Message\":\"Operation canceled\",\"Type\":\"SocketException\"},\"Message\":\"Unable to read data from the transport connection: Operation canceled.\",\"Source\":\"System.Net.Sockets\",\"Type\":\"IOException\"},\"Message\":\"The operation was canceled.\",\"Source\":\"System.Net.Http\",\"Type\":\"TaskCanceledException\"},\"Message\":\"The operation was canceled.\"}],\"Message\":\"ApplicationErrorException containing a TaskCanceledException was thrown with error code 500.\",\"Source\":\"Farfetch.Framework.API.Client.HttpClient\",\"StackTrace\":\"   at Farfetch.Framework.API.Client.HttpClient.HttpClientConnection.ExecuteAsync(HttpMethod method, Uri uri, Object body, HttpHeader[] headers, CancellationToken cancellationToken)\\n   at Farfetch.Framework.API.Client.HttpClient.HttpClientConnection.PostAsync[TRequestBody](ApiRequest`1 request, CancellationToken cancellationToken)\\n   at Farfetch.MktApi.Client.SDK.Implementations.SubscriptionClient.AddSubscriptionAsync(SubscriptionRequest subscription, CancellationToken cancellationToken)\\n   at Polly.AsyncPolicy.<>c__DisplayClass40_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.CircuitBreaker.AsyncCircuitBreakerPolicy.<>c__DisplayClass8_0`1.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.CircuitBreaker.AsyncCircuitBreakerEngine.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext, ExceptionPredicates shouldHandleExceptionPredicates, ResultPredicates`1 shouldHandleResultPredicates, ICircuitController`1 breakerController)\\n   at Polly.CircuitBreaker.AsyncCircuitBreakerPolicy.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.Wrap.AsyncPolicyWrapEngine.<>c__DisplayClass4_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.AsyncPolicy.<>c__DisplayClass40_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Farfetch.Framework.Resilience.Policies.CustomPolicies.Engines.AsyncOffloadEngine.ExecuteAsync[TResult](Func`3 action, Context context, ConcurrentDictionary`2 circuitBreakerEvents, Boolean continueOnCapturedContext, CancellationToken cancellationToken)\\n   at Farfetch.Framework.Resilience.Policies.CustomPolicies.AsyncOffloadPolicy.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.Wrap.AsyncPolicyWrapEngine.ImplementationAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext, IAsyncPolicy outerPolicy, IAsyncPolicy innerPolicy)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.Wrap.AsyncPolicyWrapEngine.<>c__DisplayClass4_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.AsyncPolicy.<>c__DisplayClass40_0.<<ImplementationAsync>b__0>d.MoveNext()\\n--- End of stack trace from previous location ---\\n   at Polly.Timeout.AsyncTimeoutEngine.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Func`2 timeoutProvider, TimeoutStrategy timeoutStrategy, Func`5 onTimeoutAsync, Boolean continueOnCapturedContext)\\n   at Polly.Timeout.AsyncTimeoutEngine.ImplementationAsync[TResult](Func`3 action, Context context, CancellationToken cancellationToken, Func`2 timeoutProvider, TimeoutStrategy timeoutStrategy, Func`5 onTimeoutAsync, Boolean continueOnCapturedContext)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Polly.Wrap.AsyncPolicyWrapEngine.ImplementationAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext, IAsyncPolicy outerPolicy, IAsyncPolicy innerPolicy)\\n   at Polly.AsyncPolicy.ExecuteAsync(Func`3 action, Context context, CancellationToken cancellationToken, Boolean continueOnCapturedContext)\\n   at Farfetch.Web.Slices.Product.Infrastructure.CrossCutting.Resilience.Clients.MarketingApi.ResilientSubscriptionsClient.AddSubscriptionAsync(SubscriptionRequest subscription, CancellationToken cancellationToken) in /source/src/Infrastructure.CrossCutting.Resilience/Clients/MarketingApi/ResilientSubscriptionsClient.cs:line 42\",\"Type\":\"ApplicationErrorException\"},\"Headers\":{\"User-Agent\":\"experience-web-gateway/1.0.23139.317\",\"X-Geo-Subfolder\":\"/pt\",\"X-History-Root-Category\":\"women\",\"X-Is-Bot\":\"false\",\"X-Known-Root-Categories\":\"\\\"{\\\\u0022beauty\\\\u0022:141257,\\\\u0022kids\\\\u0022:141260,\\\\u0022men\\\\u0022:141259,\\\\u0022women\\\\u0022:141258}\\\"\",\"X-Subfolder\":\"/pt\",\"X-Tenant-Id\":\"10000\",\"X-User-Agent\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 16_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/20E252 [FBAN/FBIOS;FBDV/iPhone14,2;FBMD/iPhone;FBSN/iOS;FBSV/16.4.1;FBSS/3;FBID/phone;FBLC/pt_PT;FBOP/5]\",\"X-User-Correlation-Id\":\"6fc3fb3e-0a08-4787-af5d-c280bad73b93\",\"x-bct\":\"168885\"},\"LogType\":\"ExternalRequest\",\"Method\":\"AddSubscriptionAsync\",\"ParentId\":\"5a554e25951d7fa3\",\"RawUrl\":\"http://portal-slices-product-we1.customer.net:9059/graphql/\",\"RequestId\":\"0HMQQJHR59PJ8:00000002\",\"RequestPath\":\"/graphql/\",\"Service\":\"marketing-core-api\",\"SpanId\":\"6a837306180d85e8\",\"TraceId\":\"000000000000000036ffd3d2d9abb486\"},\"Message\":\"Error on adding subscription.\"},\"Timestamp\":\"2023-05-22T08:52:07.3771285Z\",\"stream\":\"stdout\",\"host\":\"aks-pstdspot2-26760775-vmss0001zr\",\"@version\":\"1\",\"HostName\":\"portal-slices-product-557d947474-p2rv5\",\"EventSeverity\":\"Warning\",\"kafka_topic\":\"p2_t0_app_log\",\"datacenter\":\"we1\",\"kubernetes_pod_name\":\"portal-slices-product-557d947474-p2rv5\",\"ActId\":\"963f7019-d866-4a20-9aa2-f886616629e6\",\"Thread\":\"21\",\"kubernetes_namespace_name\":\"portal-slices\",\"kubernetes_docker_id\":\"6b9575e2857338d11a0fcfe7b684c05645d655ae2ea0a921385e82ca0a344eb4\",\"_p\":\"F\",\"@timestamp\":\"2023-05-22T08:52:07.377Z\",\"stage\":\"stable\",\"kubernetes_container_hash\":\"artifacts-we1.customer.net/docker-stable/customer/portal-slices-product@sha256:dfe52ca9c25bec6537d5f5ac2cf291c7a2b32b262e162671cc916adfb8208fa5\",\"kubernetes_pod_id\":\"4e69cb06-ac70-413a-ac68-3251dd259e2b\",\"kubernetes_container_name\":\"portal-slices-product\",\"time\":\"2023-05-22T08:52:07.377552964Z\",\"kubernetes_host\":\"aks-pstdspot2-26760775-vmss0001zr\",\"fields\":{\"boundary\":\"slices\",\"clusterName\":\"we1-prd-portal-std-1\",\"dc\":\"we1\",\"environment\":\"prd\",\"fqdn\":\"aks-pstdspot2-26760775-vmss0001zr\",\"full_name\":\"portal-slices-product\",\"minion_id\":\"aks-pstdspot2-26760775-vmss0001zr\",\"name\":\"product\",\"platform\":\"portal\",\"tags\":\"json\",\"tier\":\"0\"},\"kubernetes_container_image\":\"artifacts-we1.customer.net/docker-stable/customer/portal-slices-product:1.0.23139.489\"}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "XXXXXXXXXX@XXXXXXX",
                  "rule": "(?P<email_address>([\\d\\w\\.\\-\\_]+)@([\\d\\w]+)\\.([\\w]+))"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 13
    },
    {
      "id": "3a471869-e506-4104-bae1-c1a7f0a77936",
      "name": "PII - Block Payment Details",
      "description": "",
      "creator": "bot@coralogix.com",
      "enabled": false,
      "hidden": false,
      "ruleMatchers": [
        {
          "subsystemName": {
            "value": "paymentservice"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "ba881038-eefe-4073-bad3-d239e3bdcb32",
          "rules": [
            {
              "id": "77fd3513-fdf0-429f-b32c-70b4dec23028",
              "name": "Block payment invocation log",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "blockParameters": {
                  "keepBlockedLogs": false,
                  "rule": "PaymentService#Charge invoked"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 14
    },
    {
      "id": "b2cfdca4-ffea-4548-a9d2-e5c90acdff24",
      "name": "Parse payment info",
      "description": "",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "subsystemName": {
            "value": "paymentservice"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "fc607e75-5ab1-4b72-8a69-20337688146b",
          "rules": [
            {
              "id": "b15b6e28-c7b0-4204-b6fe-1877213235a9",
              "name": "Parse payment info",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"pay_transaction\":{\"cc\":\"$1\",\"currency\":\"$2\",\"amount\":\"$3\"}",
                  "rule": "\"message\"\\s*:\\s*\"Transaction processed:\\s*(?P<cc>\\w+)\\s*ending\\s*\\d+\\s*Amount:\\s*(?P<currency>[A-Z]+)(?P<amount>[\\d\\.]+)\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 15
    },
    {
      "id": "1d5293c9-a04b-45f9-b80f-1ebda66767ce",
      "name": "Default Subsystem - Demo - Parsing",
      "description": "Hey You - Adi Golan here please DO NOT DELETE this rule - Thanks! :)",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "default"
          }
        },
        {
          "subsystemName": {
            "value": "frontend"
          }
        },
        {
          "subsystemName": {
            "value": "checkoutservice"
          }
        },
        {
          "subsystemName": {
            "value": "recommendationservice"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "1c1a1a2b-e216-47fb-8e04-4af2124a4319",
          "rules": [
            {
              "id": "2be8e9dc-37f8-46c1-900c-a868f2c8e582",
              "name": "Delete original message",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "removeFieldsParameters": {
                  "fields": [
                    "message"
                  ]
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "0370e3fc-405b-4211-9224-5946b81322e4",
          "rules": [
            {
              "id": "a0a242b5-0172-47eb-a4a6-dd652f29179f",
              "name": "Extract Message from json.message",
              "description": "",
              "sourceField": "text.json.message",
              "parameters": {
                "extractParameters": {
                  "rule": "(?P<message>.+)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "a985effd-dfa5-41ee-a888-aa49d1a16b4e",
          "rules": [
            {
              "id": "eef5da70-fe4f-4ea7-9c3b-44d7133a0e7b",
              "name": "Delete json.message",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "removeFieldsParameters": {
                  "fields": [
                    "json.message"
                  ]
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        }
      ],
      "order": 16
    },
    {
      "id": "ee4b38a9-3768-49ee-9193-e6424745a8d7",
      "name": "Frontend Service Parsing Rules",
      "description": "Created by George P for Demo Flow - Please do not delete",
      "creator": "george.boddey@coralogix.com",
      "enabled": false,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "default"
          }
        },
        {
          "subsystemName": {
            "value": "frontend"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "6a3e0cb9-eb49-48fc-8a6f-05b586bd7222",
          "rules": [
            {
              "id": "72108a85-a2bd-4902-b9c5-05895024de0f",
              "name": "Filter logs where JSON already exists - step 1",
              "description": "{\"product_id_enriched\":{\"product_desc\":\"This lightweight hairdryer has 3 heat and speed settings. It's perfect for travel.\",\"product_name\":\"Hairdryer\",\"price_in_currency\":\"24\",\"product_img\":\"https://www.coralogix-demo.net/static/img/products/hairdryer.jpg\",\"currency\":\"USD\",\"category\":\"hair\"},\"json\":{\"http_req_ip_geoip\":{\"ip\":\"91.214.87.74\",\"ip_ipaddr\":\"91.214.87.74\",\"location_geopoint\":{\"lat\":50.5182,\"lon\":30.8041},\"continent_name\":\"Europe\",\"country_name\":\"Ukraine\",\"city_name\":\"Brovary\",\"postal_code\":\"07400\"},\"http_req_id\":\"eb42c8a5-1a7c-4174-acac-43ba70ede542\",\"http_req_ip\":\"91.214.87.74\",\"http_req_method\":\"GET\",\"http_req_path\":\"/product\",\"http_resp_bytes\":7893,\"http_resp_status\":200,\"http_resp_took_ms\":1180,\"session\":\"141329a7-ee0e-4c36-be93-ec85aca25dce\",\"severity\":\"debug\",\"span_id\":\"2af19aadfd800015\",\"timestamp\":\"2024-01-12T11:13:46.18049654Z\",\"trace_id\":\"ffde5d9a8da0e54d776d385c97e6a114\"},\"@timestamp\":\"2024-01-12T11:13:46.180Z\",\"@version\":\"1\",\"beat\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\"},\"cloud\":{\"account\":{\"id\":\"074157727657\"},\"availability_zone\":\"us-east-2a\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-02084e96d21517df8\"},\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"region\":\"us-east-2\",\"service\":{\"name\":\"EC2\"}},\"cluster_name\":\"cluster.local\",\"host\":\"172.31.4.242\",\"kubernetes\":{\"container\":{\"id\":\"27f46be207970279dbda825cdcea0ed0ef0a724d6ed8c41f33db3b207e845a54\",\"name\":\"server\"},\"deployment\":{\"name\":\"frontend\"},\"namespace\":\"default\",\"namespace_labels\":{\"kubernetes_io/metadata_name\":\"default\"},\"namespace_uid\":\"21a7e2d9-7da6-4a74-97f7-d04a7dbbb77a\",\"node\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"labels\":{\"beta_kubernetes_io/arch\":\"amd64\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"k8s_io/cloud-provider-aws\":\"5ae15d428da2ffa3cd3bbc9149af8ce1\",\"kubernetes_io/arch\":\"amd64\",\"kubernetes_io/hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"kubernetes_io/os\":\"linux\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"topology_kubernetes_io/region\":\"us-east-2\",\"topology_kubernetes_io/zone\":\"us-east-2a\"},\"name\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"uid\":\"c027d669-c71e-443c-b6d3-6be6b5b7e1ca\"},\"pod\":{\"ip\":\"172.31.2.154\",\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"69d989d8dd\"},\"name\":\"frontend-69d989d8dd-msq9g\",\"uid\":\"b0008d6f-730a-43e3-a4f8-b35b1670980d\"},\"replicaset\":{\"name\":\"frontend-69d989d8dd\"}},\"message\":\"request GET /product/2ZYFJ3GM2N completed with status: 200. requestID: eb42c8a5-1a7c-4174-acac-43ba70ede542\",\"product_id\":\"2ZYFJ3GM2N\",\"tags\":[\"beats_input_codec_plain_applied\"]}\n\n{\"json\":{\"http_req_ip_geoip\":{\"ip\":\"147.237.70.107\",\"ip_ipaddr\":\"147.237.70.107\",\"location_geopoint\":{\"lat\":31.5,\"lon\":34.75},\"continent_name\":\"Asia\",\"country_name\":\"Israel\",\"city_name\":null,\"postal_code\":null},\"http_req_id\":\"98b82456-1094-4523-961a-42a7c8b2e0c8\",\"http_req_ip\":\"147.237.70.107\",\"http_req_method\":\"POST\",\"http_req_path\":\"/cart/checkout\",\"session\":\"25b3ccb7-1cb5-4765-8ea6-5db7307c1bd0\",\"severity\":\"debug\",\"span_id\":\"63524cdcf612ccb9\",\"timestamp\":\"2024-01-12T11:13:45.447175815Z\",\"trace_id\":\"e1e43f802a679c21f9d66c42add6ec95\"},\"@timestamp\":\"2024-01-12T11:13:45.448Z\",\"@version\":\"1\",\"beat\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\"},\"cloud\":{\"account\":{\"id\":\"074157727657\"},\"availability_zone\":\"us-east-2a\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-02084e96d21517df8\"},\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"region\":\"us-east-2\",\"service\":{\"name\":\"EC2\"}},\"cluster_name\":\"cluster.local\",\"host\":\"172.31.4.242\",\"kubernetes\":{\"container\":{\"id\":\"27f46be207970279dbda825cdcea0ed0ef0a724d6ed8c41f33db3b207e845a54\",\"name\":\"server\"},\"deployment\":{\"name\":\"frontend\"},\"namespace\":\"default\",\"namespace_labels\":{\"kubernetes_io/metadata_name\":\"default\"},\"namespace_uid\":\"21a7e2d9-7da6-4a74-97f7-d04a7dbbb77a\",\"node\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"labels\":{\"beta_kubernetes_io/arch\":\"amd64\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"k8s_io/cloud-provider-aws\":\"5ae15d428da2ffa3cd3bbc9149af8ce1\",\"kubernetes_io/arch\":\"amd64\",\"kubernetes_io/hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"kubernetes_io/os\":\"linux\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"topology_kubernetes_io/region\":\"us-east-2\",\"topology_kubernetes_io/zone\":\"us-east-2a\"},\"name\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"uid\":\"c027d669-c71e-443c-b6d3-6be6b5b7e1ca\"},\"pod\":{\"ip\":\"172.31.2.154\",\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"69d989d8dd\"},\"name\":\"frontend-69d989d8dd-msq9g\",\"uid\":\"b0008d6f-730a-43e3-a4f8-b35b1670980d\"},\"replicaset\":{\"name\":\"frontend-69d989d8dd\"}},\"message\":\"request POST /cart/checkout started. requestID: 98b82456-1094-4523-961a-42a7c8b2e0c8\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"json1\":{",
                  "rule": "\\\"json\\\"\\:\\{"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "0df896be-9a9a-4aa4-af0d-f60ae74bffee",
          "rules": [
            {
              "id": "12430d7a-ad52-4f64-a6a3-fd42f17e1ea3",
              "name": "Filter logs where JSON already exists - step 2",
              "description": "{\"json\":{\"http_req_ip_geoip\":{\"ip\":\"147.237.70.107\",\"ip_ipaddr\":\"147.237.70.107\",\"location_geopoint\":{\"lat\":31.5,\"lon\":34.75},\"continent_name\":\"Asia\",\"country_name\":\"Israel\",\"city_name\":null,\"postal_code\":null},\"http_req_id\":\"98b82456-1094-4523-961a-42a7c8b2e0c8\",\"http_req_ip\":\"147.237.70.107\",\"http_req_method\":\"POST\",\"http_req_path\":\"/cart/checkout\",\"session\":\"25b3ccb7-1cb5-4765-8ea6-5db7307c1bd0\",\"severity\":\"debug\",\"span_id\":\"63524cdcf612ccb9\",\"timestamp\":\"2024-01-12T11:13:45.447175815Z\",\"trace_id\":\"e1e43f802a679c21f9d66c42add6ec95\"},\"@timestamp\":\"2024-01-12T11:13:45.448Z\",\"@version\":\"1\",\"beat\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\"},\"cloud\":{\"account\":{\"id\":\"074157727657\"},\"availability_zone\":\"us-east-2a\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-02084e96d21517df8\"},\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"region\":\"us-east-2\",\"service\":{\"name\":\"EC2\"}},\"cluster_name\":\"cluster.local\",\"host\":\"172.31.4.242\",\"kubernetes\":{\"container\":{\"id\":\"27f46be207970279dbda825cdcea0ed0ef0a724d6ed8c41f33db3b207e845a54\",\"name\":\"server\"},\"deployment\":{\"name\":\"frontend\"},\"namespace\":\"default\",\"namespace_labels\":{\"kubernetes_io/metadata_name\":\"default\"},\"namespace_uid\":\"21a7e2d9-7da6-4a74-97f7-d04a7dbbb77a\",\"node\":{\"hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"labels\":{\"beta_kubernetes_io/arch\":\"amd64\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"k8s_io/cloud-provider-aws\":\"5ae15d428da2ffa3cd3bbc9149af8ce1\",\"kubernetes_io/arch\":\"amd64\",\"kubernetes_io/hostname\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"kubernetes_io/os\":\"linux\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"topology_kubernetes_io/region\":\"us-east-2\",\"topology_kubernetes_io/zone\":\"us-east-2a\"},\"name\":\"ip-172-31-4-242.us-east-2.compute.internal\",\"uid\":\"c027d669-c71e-443c-b6d3-6be6b5b7e1ca\"},\"pod\":{\"ip\":\"172.31.2.154\",\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"69d989d8dd\"},\"name\":\"frontend-69d989d8dd-msq9g\",\"uid\":\"b0008d6f-730a-43e3-a4f8-b35b1670980d\"},\"replicaset\":{\"name\":\"frontend-69d989d8dd\"}},\"message\":\"request POST /cart/checkout started. requestID: 98b82456-1094-4523-961a-42a7c8b2e0c8\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"json\":{",
                  "rule": "\\\"json1\\\"\\:\\{"
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "0db3e96f-c8b0-41ea-94ab-2006f889ab3a",
              "name": "Nest fields under JSON if not already nested v1",
              "description": "{\"resource\":{\"attributes\":{\"cloud.account.id\":\"074157727657\",\"cloud.availability_zone\":\"us-east-2c\",\"cloud.platform\":\"aws_ec2\",\"cloud.provider\":\"aws\",\"cloud.region\":\"us-east-2\",\"cx.otel_integration.name\":\"coralogix-integration-helm\",\"host.id\":\"i-0b423258572c23bf6\",\"host.image.id\":\"ami-07b50b966251fda6e\",\"host.name\":\"ip-172-31-43-38.us-east-2.compute.internal\",\"host.type\":\"t3.large\",\"k8s.cluster.name\":\"onlineboutique\",\"k8s.container.name\":\"server\",\"k8s.container.restart_count\":\"0\",\"k8s.deployment.name\":\"frontend\",\"k8s.namespace.name\":\"default\",\"k8s.node.name\":\"ip-172-31-43-38.us-east-2.compute.internal\",\"k8s.pod.name\":\"frontend-69d989d8dd-7qc7q\",\"k8s.pod.uid\":\"144393ed-680f-4ed3-9354-f3e33871b009\",\"os.type\":\"linux\"}},\"resourceSchemaUrl\":\"https://opentelemetry.io/schemas/1.6.1\",\"scope\":{\"attributes\":{}},\"attributes\":{\"log.file.path\":\"/var/log/pods/default_frontend-69d989d8dd-7qc7q_144393ed-680f-4ed3-9354-f3e33871b009/server/0.log\",\"log.iostream\":\"stdout\",\"time\":\"2024-01-05T13:57:43.456577052Z\"},\"observedTimeUnixNano\":1704463063650460200,\"timeUnixNano\":1704463063456577000,\"http_req_id\":\"042f4b7f-1cf2-4946-a4c5-bcfe938580fa\",\"http_req_ip\":\"172.217.18.110\",\"http_req_method\":\"POST\",\"http_req_path\":\"/cart\",\"session\":\"82daafa1-0fe7-443e-b9aa-92063354954c\",\"severity\":\"debug\",\"span_id\":\"3661a7f017c4b32b\",\"timestamp\":\"2024-01-05T13:57:43.456319372Z\",\"trace_id\":\"ece78d03cd5e60160c3a7af539bf13ab\"}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "$beginning\"json\":{\"http_req_id\":\"$http_req_id\",\"http_req_ip\":\"$http_req_ip\",\"http_req_method\":\"$http_req_method\",\"http_req_path\":\"$http_req_path\",\"session\":\"$session\",\"severity\":\"$severity\",\"span_id\":\"$span_id\",\"timestamp\":\"$timestamp\",\"trace_id\":\"$trace_id\"}}",
                  "rule": "(?P<beginning>.*)\\\"http_req_id\\\"\\:\\\"(?P<http_req_id>[\\w\\-]+)\\\"\\,\\\"http_req_ip\\\"\\:\\\"(?P<http_req_ip>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\\"\\,\\\"http_req_method\\\"\\:\\\"(?P<http_req_method>[\\w]+)\\\"\\,\\\"http_req_path\\\"\\:\\\"(?P<http_req_path>[\\/\\w]+)\\\"\\,\\\"session\\\"\\:\\\"(?P<session>[\\w\\-]+)\\\"\\,\\\"severity\\\"\\:\\\"(?P<severity>[\\w]+)\\\"\\,\\\"span_id\\\"\\:\\\"(?P<span_id>[\\w]+)\\\"\\,\\\"timestamp\\\"\\:\\\"(?P<timestamp>\\d{4}\\-\\d{2}\\-\\d{2}T\\d{2}\\:\\d{2}\\:\\d{2}\\.\\d{1,10}Z)\\\"\\,\\\"trace_id\\\"\\:\\\"(?P<trace_id>[\\w]+)\\\"\\}"
                }
              },
              "enabled": true,
              "order": 2
            },
            {
              "id": "7a1e332c-6043-4fdd-91df-b23714e1727e",
              "name": "Nest fields under JSON if not already nested v2",
              "description": "{\"resource\":{\"attributes\":{\"cloud.account.id\":\"074157727657\",\"cloud.availability_zone\":\"us-east-2b\",\"cloud.platform\":\"aws_ec2\",\"cloud.provider\":\"aws\",\"cloud.region\":\"us-east-2\",\"cx.otel_integration.name\":\"coralogix-integration-helm\",\"host.id\":\"i-0a5b27e90b547603f\",\"host.image.id\":\"ami-07b50b966251fda6e\",\"host.name\":\"ip-172-31-30-194.us-east-2.compute.internal\",\"host.type\":\"t3.large\",\"k8s.cluster.name\":\"onlineboutique\",\"k8s.container.name\":\"server\",\"k8s.container.restart_count\":\"0\",\"k8s.deployment.name\":\"frontend\",\"k8s.namespace.name\":\"default\",\"k8s.node.name\":\"ip-172-31-30-194.us-east-2.compute.internal\",\"k8s.pod.name\":\"frontend-69d989d8dd-fvxbh\",\"k8s.pod.uid\":\"93174814-bcbd-46ef-803d-423995ae8c20\",\"os.type\":\"linux\"}},\"resourceSchemaUrl\":\"https://opentelemetry.io/schemas/1.6.1\",\"scope\":{\"attributes\":{}},\"attributes\":{\"log.file.path\":\"/var/log/pods/default_frontend-69d989d8dd-fvxbh_93174814-bcbd-46ef-803d-423995ae8c20/server/0.log\",\"log.iostream\":\"stdout\",\"time\":\"2024-01-05T13:57:43.780503549Z\"},\"observedTimeUnixNano\":1704463063948296400,\"timeUnixNano\":1704463063780503600,\"http_req_id\":\"646b6167-9fdc-4057-88e9-c74db871128f\",\"http_req_ip\":\"157.131.72.157\",\"http_req_method\":\"GET\",\"http_req_path\":\"/product/LS4PSXUNUM\",\"http_resp_bytes\":7983,\"http_resp_status\":200,\"http_resp_took_ms\":32,\"session\":\"f8112775-873c-4860-a2fa-780ac9eb40fb\",\"severity\":\"debug\",\"span_id\":\"c93746ea2fa9d733\",\"timestamp\":\"2024-01-05T13:57:43.780204274Z\",\"trace_id\":\"f040cc8be8a9609e7f186675293fe6ff\"}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "$beginning\"json\":{\"http_req_id\":\"$http_req_id\",\"http_req_ip\":\"$http_req_ip\",\"http_req_method\":\"$http_req_method\",\"http_req_path\":\"$http_req_path\",\"http_resp_bytes\":\"$http_resp_bytes\",\"http_resp_status\":\"$http_resp_status\",\"http_resp_took_ms\":\"$http_resp_took_ms\",\"session\":\"$session\",\"severity\":\"$severity\",\"span_id\":\"$span_id\",\"timestamp\":\"$timestamp\",\"trace_id\":\"$trace_id\"}}",
                  "rule": "(?P<beginning>.*)\\\"http_req_id\\\"\\:\\\"(?P<http_req_id>[\\w\\-]+)\\\"\\,\\\"http_req_ip\\\"\\:\\\"(?P<http_req_ip>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\\"\\,\\\"http_req_method\\\"\\:\\\"(?P<http_req_method>[\\w]+)\\\"\\,\\\"http_req_path\\\"\\:\\\"(?P<http_req_path>[\\/\\w]+)\\\"\\,\"http_resp_bytes\":(?P<http_resp_bytes>\\d{1,8})\\,\"http_resp_status\":(?P<http_resp_status>\\d{1,3})\\,\"http_resp_took_ms\":(?P<http_resp_took_ms>\\d{1,3})\\,\\\"session\\\"\\:\\\"(?P<session>[\\w\\-]+)\\\"\\,\\\"severity\\\"\\:\\\"(?P<severity>[\\w]+)\\\"\\,\\\"span_id\\\"\\:\\\"(?P<span_id>[\\w]+)\\\"\\,\\\"timestamp\\\"\\:\\\"(?P<timestamp>\\d{4}\\-\\d{2}\\-\\d{2}T\\d{2}\\:\\d{2}\\:\\d{2}\\.\\d{1,10}Z)\\\"\\,\\\"trace_id\\\"\\:\\\"(?P<trace_id>[\\w]+)\\\"\\}"
                }
              },
              "enabled": true,
              "order": 3
            }
          ],
          "enabled": true,
          "order": 2
        }
      ],
      "order": 17
    },
    {
      "id": "1132fc85-f45f-4c66-9c5a-0fd4ceacd0d3",
      "name": "Parse frontend product info",
      "description": "",
      "creator": "george.pickers@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "default"
          }
        },
        {
          "subsystemName": {
            "value": "frontend"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "2a9fa9ef-4269-4e6c-8c4a-20a22702bdef",
          "rules": [
            {
              "id": "dd0a0ac1-b664-4e25-84c5-6a6d59e69f5c",
              "name": "Extract product ID",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "extractParameters": {
                  "rule": "(json.*?){.*?http.req.path.*?product.*?(?P<product_id>\\w+)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "992d8df3-0698-43b3-94e9-720976de50f4",
          "rules": [
            {
              "id": "be0c5dfd-bf7e-4ae0-83a4-68083fc3ffd5",
              "name": "Delete product id from request path",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "$1",
                  "rule": "(json.*?{.*?http.req.path.*?product)(?P<product_id>.*?\\w+)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        }
      ],
      "order": 18
    },
    {
      "id": "39d733e6-184e-4be0-9fba-f50160ba13f9",
      "name": "OB - Error to Message",
      "description": "",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "default"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "0ab6aac1-c335-4fa4-ba99-0976b2ea29e7",
          "rules": [
            {
              "id": "a2185019-5661-44b6-8300-d7d2d6ba1f75",
              "name": "error -> message",
              "description": "",
              "sourceField": "text.error",
              "parameters": {
                "extractParameters": {
                  "rule": "(?P<message>.*)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 19
    },
    {
      "id": "41ead467-a24d-4b88-9148-690c6874f148",
      "name": "Product stats",
      "description": "",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "default"
          }
        },
        {
          "subsystemName": {
            "value": "loadgenerator"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "532954d6-8468-493f-b06f-6e89b4f73986",
          "rules": [
            {
              "id": "e233d7a0-f0f7-4a17-ac2e-96c25dff9b0e",
              "name": "Parse stats fields",
              "description": "{\"cloud\":{\"machine\":{\"type\":\"t3.large\"},\"availability_zone\":\"us-east-2a\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"provider\":\"aws\",\"instance\":{\"id\":\"i-0f7afac2798217d04\"}},\"kubernetes\":{\"container\":{\"id\":\"f656936403a86d996f50bbd349cb4a1da83678cb9b633af526abe46d8b7556e4\",\"name\":\"main\"},\"pod\":{\"labels\":{\"app\":\"loadgenerator\",\"pod-template-hash\":\"589648f87f\"},\"ip\":\"172.31.4.1\",\"name\":\"loadgenerator-589648f87f-46n6p\"},\"namespace\":\"default\",\"node\":{\"labels\":{\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"topology_kubernetes_io/region\":\"us-east-2\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"topology_kubernetes_io/zone\":\"us-east-2a\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"beta_kubernetes_io/os\":\"linux\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"beta_kubernetes_io/arch\":\"amd64\",\"kubernetes_io/arch\":\"amd64\"},\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"deployment\":{\"name\":\"loadgenerator\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2021-08-26T21:52:06.589Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\" GET /product/1YMWWN1N4O 1181 16(1.35%) | 28 3 1729 15 | 0.10 0.00\",\"tags\":[\"kubernetes\",\"containers\",\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"machine\":{\"type\":\"t3.large\"},\"account\":{\"id\":\"074157727657\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2a\",\"region\":\"us-east-2\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"service\":{\"name\":\"EC2\"},\"instance\":{\"id\":\"i-0f7afac2798217d04\"}},\"kubernetes\":{\"container\":{\"id\":\"f656936403a86d996f50bbd349cb4a1da83678cb9b633af526abe46d8b7556e4\",\"name\":\"main\"},\"pod\":{\"labels\":{\"app\":\"loadgenerator\",\"pod-template-hash\":\"589648f87f\"},\"ip\":\"172.31.4.1\",\"name\":\"loadgenerator-589648f87f-46n6p\"},\"namespace\":\"default\",\"deployment\":{\"name\":\"loadgenerator\"},\"node\":{\"labels\":{\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"topology_kubernetes_io/region\":\"us-east-2\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"topology_kubernetes_io/zone\":\"us-east-2a\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"beta_kubernetes_io/os\":\"linux\",\"kubernetes_io/os\":\"linux\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"beta_kubernetes_io/arch\":\"amd64\",\"kubernetes_io/arch\":\"amd64\"},\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2021-08-26T22:30:12.743Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\" POST /setCurrency 2045 33(1.61%) | 40 5 1890 21 | 0.50 0.00\",\"tags\":[\"kubernetes\",\"containers\",\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"machine\":{\"type\":\"t3.large\"},\"availability_zone\":\"us-east-2a\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"provider\":\"aws\",\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"region\":\"us-east-2\",\"instance\":{\"id\":\"i-0f7afac2798217d04\"}},\"kubernetes\":{\"container\":{\"id\":\"f656936403a86d996f50bbd349cb4a1da83678cb9b633af526abe46d8b7556e4\",\"name\":\"main\"},\"pod\":{\"labels\":{\"app\":\"loadgenerator\",\"pod-template-hash\":\"589648f87f\"},\"ip\":\"172.31.4.1\",\"name\":\"loadgenerator-589648f87f-46n6p\"},\"namespace\":\"default\",\"deployment\":{\"name\":\"loadgenerator\"},\"node\":{\"labels\":{\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"topology_kubernetes_io/region\":\"us-east-2\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"topology_kubernetes_io/zone\":\"us-east-2a\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"kubernetes_io/os\":\"linux\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"beta_kubernetes_io/arch\":\"amd64\",\"kubernetes_io/arch\":\"amd64\"},\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2021-08-26T23:13:35.546Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\" GET /product/6E92ZMYYFZ 1923 21(1.09%) | 28 3 1671 15 | 0.00 0.00\",\"tags\":[\"kubernetes\",\"containers\",\"beats_input_codec_plain_applied\"]}\n",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "stats\":{\"method\":\"$1\",\"endpoint\":\"$2\",\"product\":\"$3\",\"success\":\"$4\",\"failure\":\"$5\",\"prct_failure\":\"$6\",\"avg\":\"$7\",\"min\":\"$8\",\"max\":\"$9\",\"mid\":\"$10\",\"requests_rate\":\"$11\",\"failures_rate\":\"$12\"}",
                  "rule": "message\"\\s*:\"\\s*(?P<method>\\w+)\\s*(?P<endpoint>[^\\s\\\\]+)(?:\\\\/)?(?P<product_no>\\w*)\\s*(?P<successs>\\d+)\\s*(?P<failure>\\d+)\\((?P<prct_failure>[\\d\\.]+)%\\)\\s*\\|\\s*(?P<avg>\\d+)\\s*(?P<min>\\d+)\\s*(?P<max>\\d+)\\s*(?P<mid>\\d+)\\s*\\|\\s*(?P<requests_rate>[\\d\\.]+)\\s*(?P<failures_rate>[\\d\\.]+)\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 20
    },
    {
      "id": "00c05394-9f5a-4c4d-86ae-00cd298c29cb",
      "name": "Extract service from cx.metadata",
      "description": "",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "074157727657"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "ead8c277-b3a3-453a-8ef6-7c5b0ae11b93",
          "rules": [
            {
              "id": "349be8c8-1925-4d90-bfeb-7d7260af17d8",
              "name": "Extract faas_name into cx_metadata.service_name",
              "description": "{\"platform_event_type\":\"report\",\"cx_metadata\":{\"cloud_account_id\":\"074157727657\",\"cloud_provider\":\"aws\",\"cloud_region\":\"eu-west-1\",\"faas_execution\":\"e1065026-d775-4bd9-ae53-99032e367c79\",\"faas_id\":\"arn:aws:lambda:eu-west-1:074157727657:function:cll-lambda-python-2:$LATEST\",\"faas_instance_cx_id\":\"2d6b859b1e5ed7e415774a1c17d6cd35\",\"faas_name\":\"cll-lambda-python-2\",\"span_id\":\"a851dc681f9b1358\",\"tags\":{\"project\":\"coralogix-lambda-lab\"},\"trace_id\":\"2194edc1974a58d39628b739c9ba8a6b\"},\"event\":{\"error_type\":null,\"metrics\":{\"billed_duration_ms\":1311,\"duration_ms\":1310.858,\"init_duration_ms\":null,\"max_memory_used_mb\":118,\"memory_size_mb\":128,\"produced_bytes\":0,\"restore_duration_ms\":null},\"request_id\":\"e1065026-d775-4bd9-ae53-99032e367c79\",\"status\":\"success\"}}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "$start\"faas_name\":\"$service_name\"$end,\"service\":\"$service_name\"}",
                  "rule": "(?P<start>.*)\"faas_name\":\"(?P<service_name>[^\"]*)\"(?P<end>.*)}"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 21
    },
    {
      "id": "2899cbbf-5ca0-4b0f-b358-e672518b21c5",
      "name": "Parse AWS-ELB",
      "description": "Parse logs generated from AWS Classic Load Balancer (ELB)",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "aws-elb"
          }
        },
        {
          "subsystemName": {
            "value": "customers-elb"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "530f9ff5-d72e-4da1-bd07-b9de0b721f9e",
          "rules": [
            {
              "id": "c1a3cf72-9e14-4d19-b607-ed12a4de5d21",
              "name": "Parse AWS-ELB Logs",
              "description": "{\"message\":\"2022-10-04T15:42:14.780568Z prod 146.225.200.106:443 - -1 -1 -1 504 504 4942 4942 \\\"GET https://learningcatalytics.com:443/questions/856776/item_versions HTTP/1.0\\\" \\\"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/536.2 (KHTML, like Gecko) Chrome/60.0.808.0 Safari/536.2\\\" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2\"}\n\n{\"message\":\"2022-10-04T15:41:58.780568Z prod 86.95.52.184:443 - -1 -1 -1 504 504 5041 5041 \\\"GET https://learningcatalytics.com:443courses/285528/modules HTTP/1.0\\\" \\\"Mozilla/5.0 (Windows 98; Win 9x 4.90; ky-KG; rv:1.9.1.20) Gecko/2020-07-10 09:07:16 Firefox/3.6.3\\\" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2\"}",
              "sourceField": "text",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text",
                  "rule": "message\\\"\\:\\\"(?P<timestamp>\\d{4}\\-\\d{2}\\-[0-9]{2}T\\d{2}\\:\\d{2}\\:\\d{2}\\.\\d+Z)\\s*(?P<elb_name>[\\w\\-]+)\\s*(?P<client_ip>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\:(?P<client_port>\\d+)\\s*(?P<target_ip>(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}|\\-))(\\:(?P<target_port>\\d+))?\\s*(?P<request_processing_time>[\\-\\d\\.]+)\\s*(?P<target_processing_time>[\\-\\d\\.]+)\\s*(?P<response_processing_time>[\\-\\d\\.]+)\\s*(?P<elb_status_code>\\d{3})\\s*(?P<target_status_code>\\d{3})\\s*(?P<received_bytes>\\d+)\\s*(?P<sent_bytes>\\d+)\\s*(\\\\)?\\\"(?P<request_verb>[a-zA-Z]+|-)\\s*(?P<request_uri>[^\\s*]+)\\s*(?P<request_protocol>[^\\\"]+)\\\"\\s*(\\\\)?\\\"(\\s*)?(?P<user_agent>[^\\\"]+)\\\"\\s*(?P<tls_cipher>[\\w\\-]+)\\s*(?P<tls_protocol>[\\w\\.]+)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "13be2e7a-e93e-49a1-aeb6-36c7d7a07acf",
          "rules": [
            {
              "id": "c2fbd33d-89b6-4304-824d-5ce0e60d2f5b",
              "name": "Extract Timestamp from AWS-ELB Logs",
              "description": "2022-10-04T15:58:34.780568Z",
              "sourceField": "text.timestamp",
              "parameters": {
                "extractTimestampParameters": {
                  "standard": "FORMAT_STANDARD_STRFTIME_OR_UNSPECIFIED",
                  "format": "%Y-%m-%dT%H:%M:%S.%fZ"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        }
      ],
      "order": 22
    },
    {
      "id": "cfdc9d60-6466-4a72-91c4-b0fdc4f44b3f",
      "name": "Windows - rename host",
      "description": "",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "windows_logs"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "3311bb18-1743-448b-bad2-e0cf9cb77d0e",
          "rules": [
            {
              "id": "e8ff3989-60b2-47cd-80bc-66a50a2afd52",
              "name": "Rename host",
              "description": "{\"@timestamp\":\"2021-11-02T00:14:26.379Z\",\"event\":{\"code\":4625,\"created\":\"2021-11-02T00:14:27.912Z\",\"outcome\":\"failure\",\"action\":\"Logon\",\"provider\":\"Microsoft-Windows-Security-Auditing\",\"kind\":\"event\"},\"tags\":[\"beats_input_codec_plain_applied\"],\"agent\":{\"ephemeral_id\":\"075c16b2-19a2-41fa-a024-644958b4a4c7\",\"type\":\"winlogbeat\",\"name\":\"EC2AMAZ-CIFBMR8\",\"hostname\":\"EC2AMAZ-CIFBMR8\",\"id\":\"ea08b7e2-c1b6-4031-9ce6-f5c4b04ac45f\",\"version\":\"7.10.1\"},\"message\":\"An account failed to log on.\\n\\nSubject:\\n\\tSecurity ID:\\t\\tS-1-0-0\\n\\tAccount Name:\\t\\t-\\n\\tAccount Domain:\\t\\t-\\n\\tLogon ID:\\t\\t0x0\\n\\nLogon Type:\\t\\t\\t3\\n\\nAccount For Which Logon Failed:\\n\\tSecurity ID:\\t\\tS-1-0-0\\n\\tAccount Name:\\t\\tADMINISTRATOR\\n\\tAccount Domain:\\t\\t\\n\\nFailure Information:\\n\\tFailure Reason:\\t\\tUnknown user name or bad password.\\n\\tStatus:\\t\\t\\t0xC000006D\\n\\tSub Status:\\t\\t0xC000006A\\n\\nProcess Information:\\n\\tCaller Process ID:\\t0x0\\n\\tCaller Process Name:\\t-\\n\\nNetwork Information:\\n\\tWorkstation Name:\\t-\\n\\tSource Network Address:\\t27.72.30.223\\n\\tSource Port:\\t\\t0\\n\\nDetailed Authentication Information:\\n\\tLogon Process:\\t\\tNtLmSsp \\n\\tAuthentication Package:\\tNTLM\\n\\tTransited Services:\\t-\\n\\tPackage Name (NTLM only):\\t-\\n\\tKey Length:\\t\\t0\\n\\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\\n\\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\n\\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\\n\\nThe Process Information fields indicate which account and process on the system requested the logon.\\n\\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\n\\nThe authentication information fields provide detailed information about this specific logon request.\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\",\"@version\":\"1\",\"host\":{\"name\":\"EC2AMAZ-CIFBMR8\"},\"ecs\":{\"version\":\"1.5.0\"},\"winlog\":{\"channel\":\"Security\",\"event_id\":4625,\"process\":{\"pid\":716,\"thread\":{\"id\":4108}},\"opcode\":\"Info\",\"event_data\":{\"SubjectUserName\":\"-\",\"SubStatus\":\"0xc000006a\",\"TransmittedServices\":\"-\",\"SubjectLogonId\":\"0x0\",\"SubjectUserSid\":\"S-1-0-0\",\"Status\":\"0xc000006d\",\"IpPort\":\"0\",\"IpAddress\":\"27.72.30.223\",\"FailureReason\":\"%%2313\",\"ProcessName\":\"-\",\"LmPackageName\":\"-\",\"TargetUserName\":\"ADMINISTRATOR\",\"TargetUserSid\":\"S-1-0-0\",\"ProcessId\":\"0x0\",\"KeyLength\":\"0\",\"LogonProcessName\":\"NtLmSsp \",\"SubjectDomainName\":\"-\",\"AuthenticationPackageName\":\"NTLM\",\"LogonType\":\"3\",\"WorkstationName\":\"-\"},\"keywords\":[\"Audit Failure\"],\"task\":\"Logon\",\"record_id\":16734626,\"provider_name\":\"Microsoft-Windows-Security-Auditing\",\"api\":\"wineventlog\",\"computer_name\":\"EC2AMAZ-CIFBMR8\",\"provider_guid\":\"{54849625-5478-4994-A5BA-3E3B0328C30D}\",\"activity_id\":\"{92522A8E-F43F-0000-B42A-52923FF4D601}\"},\"log\":{\"level\":\"information\"}}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"host_windows\":{",
                  "rule": "\"host\"\\s*:{"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 23
    },
    {
      "id": "6ce9880a-9156-4416-a410-fc1d3d129c95",
      "name": "Parse prometheus-server logs",
      "description": "",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "prometheus"
          }
        },
        {
          "subsystemName": {
            "value": "prometheus-server"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "a761c037-34ad-4f92-bd54-0acad9d38d1f",
          "rules": [
            {
              "id": "d88d809f-cb66-4d42-87c7-4f912f986d3d",
              "name": "Parse prometheus-server logs #1",
              "description": "{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T22:49:53.600Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T22:49:53.599Z caller=notifier.go:601 component=notifier msg=\\\"Stopping notification manager...\\\"\",\"tags\":[\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"service\":{\"name\":\"EC2\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T22:49:53.600Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T22:49:53.599Z caller=main.go:664 msg=\\\"Scrape discovery manager stopped\\\"\",\"tags\":[\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"deployment\":{\"name\":\"prometheus-server\"},\"namespace\":\"prometheus\"},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T22:49:53.600Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=error ts=2022-08-30T22:49:53.600Z caller=main.go:881 err=\\\"opening storage failed: lock DB directory: resource temporarily unavailable\\\"\",\"tags\":[\"beats_input_codec_plain_applied\"]}\n\n{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T22:55:03.838Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T22:55:03.838Z caller=repair.go:57 component=tsdb msg=\\\"Found healthy block\\\" mint=1661875200263 maxt=1661882400000 ulid=01GBR2017JBF14WHDTVGHH3HYA\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"component\":\"$component\",\"message\":\"$message\",\"mint\":\"$mint\",\"maxt\":\"$maxt\",\"ulid\":\"$ulid\"",
                  "rule": "\"message\":\"level=(?P<level>[A-z]+) ts=(?P<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]{3}Z) caller=(?P<caller>[^ ]+)(?: component=([^ ]+))? (?:msg|err)=\\\\\"(?P<message>[^\"]+)\\\\\"(?: mint=(?P<mint>[0-9]+) maxt=(?P<maxt>[0-9]+) ulid=(?P<ulid>[0-9A-Z]+))?\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "94b439ba-8302-436f-bc49-a30ae3007257",
              "name": "Parse prometheus-server logs #2",
              "description": "{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T23:15:28.719Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T23:15:28.719Z caller=tls_config.go:191 component=web msg=\\\"TLS is disabled.\\\" http2=false\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"component\":\"$component\",\"message\":\"$message\",\"http2\":\"$http2\"",
                  "rule": "\"message\":\"level=(?P<level>[A-z]+) ts=(?P<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]{3}Z) caller=(?P<caller>[^ ]+) component=(?P<component>[^ ]+) msg=\\\\\"(?P<message>[^\"]+)\\\\\" http2=(?P<http2>[a-z]+)\""
                }
              },
              "enabled": true,
              "order": 2
            },
            {
              "id": "897c5fee-cbfc-4791-8f15-e443be8757b3",
              "name": "Parse prometheus-server logs #3",
              "description": "{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"service\":{\"name\":\"EC2\"},\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T23:15:28.719Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T23:15:28.717Z caller=manager.go:944 component=\\\"rule manager\\\" msg=\\\"Rule manager stopped\\\"\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"component\":\"$component\",\"message\":\"$message\"",
                  "rule": "\"message\":\"level=(?P<level>[A-z]+) ts=(?P<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]{3}Z) caller=(?P<caller>[^ ]+) component=\\\\\"(?P<component>[^\"]+)\\\\\" msg=\\\\\"(?P<message>[^\"]+)\\\\\"\""
                }
              },
              "enabled": true,
              "order": 3
            },
            {
              "id": "8774b601-6aaf-4bfe-acf2-235d26f27712",
              "name": "Parse prometheus-server logs #4",
              "description": "{\"cloud\":{\"instance\":{\"id\":\"i-0b423258572c23bf6\"},\"service\":{\"name\":\"EC2\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2c\",\"account\":{\"id\":\"074157727657\"},\"region\":\"us-east-2\",\"machine\":{\"type\":\"t3.large\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"}},\"kubernetes\":{\"node\":{},\"pod\":{\"name\":\"prometheus-server-5556c6584f-d8xjj\",\"ip\":\"172.31.36.235\"},\"namespace\":\"prometheus\",\"deployment\":{\"name\":\"prometheus-server\"}},\"cluster_name\":\"cluster.local\",\"@timestamp\":\"2022-08-30T23:25:46.815Z\",\"host\":\"172.31.43.38\",\"beat\":{\"hostname\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"@version\":\"1\",\"message\":\"level=info ts=2022-08-30T23:25:46.815Z caller=web.go:540 component=web msg=\\\"Start listening for connections\\\" address=0.0.0.0:9090\",\"tags\":[\"beats_input_codec_plain_applied\"]}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"component\":\"$component\",\"message\":\"$message\",\"address\":\"$address\"",
                  "rule": "\"message\":\"level=(?P<level>[A-z]+) ts=(?P<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]{3}Z) caller=(?P<caller>[^ ]+) component=(?P<component>[^ ]+) msg=\\\\\"(?P<message>[^\"]+)\\\\\" address=(?P<address>[0-9\\.:]+)\""
                }
              },
              "enabled": true,
              "order": 4
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "0300051a-309d-43a4-9151-6edcc11c7039",
          "rules": [
            {
              "id": "8b163a58-9c76-49dd-80f9-c9549c025910",
              "name": "extract level to Coralogix severity",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "jsonExtractParameters": {
                  "destinationFieldType": "DESTINATION_FIELD_SEVERITY",
                  "rule": "level",
                  "destinationFieldText": null
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "38fff9ef-ccf8-42a0-99bf-519c4a447296",
          "rules": [
            {
              "id": "1e92ba7d-532a-4522-90c4-583668bd6cd7",
              "name": "remove empty field1",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "",
                  "rule": "\"[^\"]+\":\"\","
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        },
        {
          "id": "9cb4653a-3b6a-43fb-83ca-a3a8d44e1268",
          "rules": [
            {
              "id": "175b8f28-f7b3-409b-a980-ac569da60056",
              "name": "remove empty field2",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "",
                  "rule": ",\"[^\"]+\":\"\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 4
        }
      ],
      "order": 24
    },
    {
      "id": "d153a2a1-2e82-4a1b-82d6-0965c4c52064",
      "name": "Severity Rules",
      "description": "",
      "creator": "george.pickers@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "d980b465-9a8d-4c1e-b6bc-c9a1d5c5d932",
          "rules": [
            {
              "id": "cf9486de-429f-47f0-be1d-318e296abfe7",
              "name": "Extract Severity from AWS-ELB Status Code",
              "description": "{\"client_addr\":\"225.44.33.12\",\"client_port\":\"443\",\"elb\":\"prod\",\"elb_status_code\":\"504\",\"recieved_bytes\":\"4997\",\"request\":\"GET https://learningcatalytics.com:443/list HTTP/1.0\\\\\",\"request_processing_time\":\"-1\",\"response_processing_time\":\"-1\",\"sent_bytes\":\"4997\",\"ssl_cipher\":\"ECDHE-RSA-AES128-GCM-SHA256\",\"ssl_protocol\":\"TLSv1.2\",\"target_addr\":\"-\",\"target_processing_time\":\"-1\",\"target_status_code\":\"504\",\"timestamp\":\"2022-05-25T04:33:47.120274Z\",\"user_agent\":\"Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/2012-01-05 11:36:56 Firefox/3.8\\\\\"}",
              "sourceField": "text",
              "parameters": {
                "jsonExtractParameters": {
                  "destinationFieldType": "DESTINATION_FIELD_SEVERITY",
                  "rule": "elb_status_code",
                  "destinationFieldText": null
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "00bed83d-6888-4726-a913-d75d8d076822",
              "name": "Extract severity from json.http_resp_status",
              "description": "{\"cloud\":{\"machine\":{\"type\":\"t3.large\"},\"provider\":\"aws\",\"availability_zone\":\"us-east-2a\",\"service\":{\"name\":\"EC2\"},\"region\":\"us-east-2\",\"account\":{\"id\":\"074157727657\"},\"image\":{\"id\":\"ami-07b50b966251fda6e\"},\"instance\":{\"id\":\"i-0f7afac2798217d04\"}},\"kubernetes\":{\"container\":{\"id\":\"83b5eabd340b092e44f97e6a0add04a45f8b2408daad162d1b1e4ff4901e9312\",\"name\":\"server\"},\"pod\":{\"labels\":{\"app\":\"frontend\",\"pod-template-hash\":\"b85fc47d4\"},\"ip\":\"172.31.13.168\",\"name\":\"frontend-b85fc47d4-z8vb5\"},\"namespace\":\"default\",\"node\":{\"labels\":{\"kubernetes_io/hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"topology_kubernetes_io/region\":\"us-east-2\",\"eks_amazonaws_com/nodegroup\":\"chen-eks2-nodes\",\"topology_kubernetes_io/zone\":\"us-east-2a\",\"node_kubernetes_io/instance-type\":\"t3.large\",\"beta_kubernetes_io/instance-type\":\"t3.large\",\"kubernetes_io/os\":\"linux\",\"beta_kubernetes_io/os\":\"linux\",\"eks_amazonaws_com/capacityType\":\"ON_DEMAND\",\"failure-domain_beta_kubernetes_io/region\":\"us-east-2\",\"failure-domain_beta_kubernetes_io/zone\":\"us-east-2a\",\"eks_amazonaws_com/nodegroup-image\":\"ami-07b50b966251fda6e\",\"beta_kubernetes_io/arch\":\"amd64\",\"kubernetes_io/arch\":\"amd64\"},\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"name\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"deployment\":{\"name\":\"frontend\"}},\"cluster_name\":\"cluster.local\",\"inner_json\":{\"severity\":\"debug\",\"timestamp\":\"2021-08-27T23:54:32.487194427Z\",\"http_req_id\":\"231de558-b0d3-40ee-a5e9-674b52e8f987\",\"http_req_method\":\"GET\",\"http_req_path\":\"/cart\",\"http_resp_bytes\":16822,\"http_resp_status\":200,\"http_resp_took_ms\":47,\"message\":\"request complete\",\"session\":\"25740e19-1bcc-4ea4-b5f3-eaacffddbaa1\"},\"@timestamp\":\"2021-08-27T23:54:32.488Z\",\"host\":\"ip-172-31-2-79.us-east-2.compute.internal\",\"beat\":{\"hostname\":\"ip-172-31-2-79.us-east-2.compute.internal\"},\"@version\":\"1\",\"tags\":[\"kubernetes\",\"containers\",\"beats_input_codec_plain_applied\"]}\n",
              "sourceField": "text",
              "parameters": {
                "extractParameters": {
                  "rule": "json.*?http_resp_status\\\\\"\\s*:.*?(?P<severity>\\d{3})"
                }
              },
              "enabled": false,
              "order": 2
            },
            {
              "id": "3d5b368c-f607-4b88-83f2-8c1d8deb0c95",
              "name": "Set status 2/3xx logs to INFO",
              "description": "",
              "sourceField": "text.json.http_resp_status",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "severity",
                  "replaceNewVal": "INFO",
                  "rule": "(2|3)\\d\\d"
                }
              },
              "enabled": false,
              "order": 3
            },
            {
              "id": "490c599e-d5d4-4376-a35e-9a79de228ddd",
              "name": "Request started/completed -> INFO",
              "description": "",
              "sourceField": "text.message",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "INFO",
                  "rule": ".*?(started|completed).*"
                }
              },
              "enabled": false,
              "order": 4
            },
            {
              "id": "665d98b8-c4d9-4b55-ae79-f1da76a4d99c",
              "name": "Extract severity from json.severity",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "jsonExtractParameters": {
                  "destinationFieldType": "DESTINATION_FIELD_SEVERITY",
                  "rule": "json.severity",
                  "destinationFieldText": null
                }
              },
              "enabled": true,
              "order": 5
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "e527b635-d2e1-4044-8d07-905d21524fc1",
          "rules": [
            {
              "id": "27e385ed-c8ca-4c1e-98b4-52c18b6b89cb",
              "name": "Extract severity from json.http_resp_status",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "jsonExtractParameters": {
                  "destinationFieldType": "DESTINATION_FIELD_SEVERITY",
                  "rule": "json.http_resp_status",
                  "destinationFieldText": null
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "84bf39d5-7b04-4cda-9f9b-e62094f371e0",
              "name": "Severity Rule",
              "description": "Look for default severity text",
              "sourceField": "text",
              "parameters": {
                "extractParameters": {
                  "rule": "\\b(?P<severity>DEBUG|TRACE|INFO|WARN|ERROR|FATAL|EXCEPTION|[Dd]ebug|[Tt]race|[Ii]nfo|[Ww]arn|[Ee]rror|[Ff]atal|[Ee]xception)\\b"
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 2
        }
      ],
      "order": 25
    },
    {
      "id": "f9ed48df-2a22-47cd-a96d-b9a8a5800eec",
      "name": "kube",
      "description": "Fix odd fields causing parsing to fail",
      "creator": "david.bott+boutique@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "kube-system"
          }
        },
        {
          "subsystemName": {
            "value": "kube-apiserver-audit"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "6af9adb2-81b9-43ef-a920-ec272195de3f",
          "rules": [
            {
              "id": "bee38b9c-1b62-4c7d-a28c-3e10a13fcb7c",
              "name": "Remove field called \".\"",
              "description": "\n{\ntext:{\"stage\":\"ResponseComplete\",\"requestURI\":\"/apis/authorization.k8s.io/v1/subjectaccessreviews\",\"requestObject\":{\"kind\":\"SubjectAccessReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null},\"spec\":{\"resourceAttributes\":{\"verb\":\"get\",\"version\":\"v1\",\"resource\":\"nodes\",\"subresource\":\"metrics\",\"name\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"user\":\"system:serviceaccount:monitoring24:coralogix-opentelemetry-collector\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:monitoring24\",\"system:authenticated\"],\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"coralogix-opentelemetry-collector-8497849d4-9bmvl\"],\"authentication.kubernetes.io/pod-uid\":[\"1bd6c1e0-5d2c-4d85-9a3b-1e3c838e3dc1\"]},\"uid\":\"3772d3fb-8c4e-4af6-be48-924e91cfe7d4\"},\"status\":{\"allowed\":false}},\"auditID\":\"25b68412-42de-4d04-a755-dbe91e10bf98\",\"objectRef\":{\"resource\":\"subjectaccessreviews\",\"apiGroup\":\"authorization.k8s.io\",\"apiVersion\":\"v1\"},\"userAgent\":\"kubelet/v1.21.2 (linux/amd64) kubernetes/3d33787\",\"sourceIPs\":[\"18.118.132.47\"],\"responseStatus\":{\"metadata\":{},\"code\":201},\"responseObject\":{\"kind\":\"SubjectAccessReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null,\"managedFields\":[{\"manager\":\"kubelet\",\"operation\":\"Update\",\"apiVersion\":\"authorization.k8s.io/v1\",\"time\":\"2024-10-10T15:39:56Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:spec\":{\"f:extra\":{\".\":{},\"f:authentication.kubernetes.io/pod-name\":{},\"f:authentication.kubernetes.io/pod-uid\":{}},\"f:groups\":{},\"f:resourceAttributes\":{\".\":{},\"f:name\":{},\"f:resource\":{},\"f:subresource\":{},\"f:verb\":{},\"f:version\":{}},\"f:uid\":{},\"f:user\":{}}}}]},\"spec\":{\"resourceAttributes\":{\"verb\":\"get\",\"version\":\"v1\",\"resource\":\"nodes\",\"subresource\":\"metrics\",\"name\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"user\":\"system:serviceaccount:monitoring24:coralogix-opentelemetry-collector\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:monitoring24\",\"system:authenticated\"],\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"coralogix-opentelemetry-collector-8497849d4-9bmvl\"],\"authentication.kubernetes.io/pod-uid\":[\"1bd6c1e0-5d2c-4d85-9a3b-1e3c838e3dc1\"]},\"uid\":\"3772d3fb-8c4e-4af6-be48-924e91cfe7d4\"},\"status\":{\"allowed\":true,\"reason\":\"RBAC: allowed by ClusterRoleBinding \\\"coralogix-opentelemetry-collector\\\" of ClusterRole \\\"coralogix-opentelemetry-collector\\\" to ServiceAccount \\\"coralogix-opentelemetry-collector/monitoring24\\\"\"}},\"user\":{\"username\":\"system:node:ip-172-31-43-38.us-east-2.compute.internal\",\"uid\":\"aws-iam-authenticator:074157727657:AROARCRBFD6U5I6XD6RHO\",\"groups\":[\"system:bootstrappers\",\"system:nodes\",\"system:authenticated\"],\"extra\":{\"accessKeyId\":[\"ASIARCRBFD6UYC7YIWNE\"],\"arn\":[\"arn:aws:sts::074157727657:assumed-role/eks-nodes/i-0b423258572c23bf6\"],\"canonicalArn\":[\"arn:aws:iam::074157727657:role/eks-nodes\"],\"principalId\":[\"AROARCRBFD6U5I6XD6RHO\"],\"sessionName\":[\"i-0b423258572c23bf6\"],\"sigs.k8s.io/aws-iam-authenticator/principalId\":[\"AROARCRBFD6U5I6XD6RHO\"]}},\"level\":\"RequestResponse\",\"annotations\":{\"authorization.k8s.io/decision\":\"allow\",\"authorization.k8s.io/reason\":\"\"},\"stageTimestamp\":\"2024-10-10T15:39:56.576301Z\",\"requestReceivedTimestamp\":\"2024-10-10T15:39:56.573475Z\",\"verb\":\"create\",\"kind\":\"Event\",\"apiVersion\":\"audit.k8s.io/v1\"}\n}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": " ",
                  "rule": "\\\"\\.\\\"\\:\\{\\}\\,"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "b53484a7-d0df-4b73-b66c-62116c60698b",
          "rules": [
            {
              "id": "b66c22e6-7b6c-4f46-8ce8-683a73c71acc",
              "name": "Rename status to statusObject",
              "description": "{\ntext:{\"stage\":\"ResponseComplete\",\"requestURI\":\"/apis/authorization.k8s.io/v1/subjectaccessreviews\",\"requestObject\":{\"kind\":\"SubjectAccessReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null},\"spec\":{\"resourceAttributes\":{\"verb\":\"get\",\"version\":\"v1\",\"resource\":\"nodes\",\"subresource\":\"metrics\",\"name\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"user\":\"system:serviceaccount:monitoring24:coralogix-opentelemetry-collector\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:monitoring24\",\"system:authenticated\"],\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"coralogix-opentelemetry-collector-8497849d4-9bmvl\"],\"authentication.kubernetes.io/pod-uid\":[\"1bd6c1e0-5d2c-4d85-9a3b-1e3c838e3dc1\"]},\"uid\":\"3772d3fb-8c4e-4af6-be48-924e91cfe7d4\"},\"status\":{\"allowed\":false}},\"auditID\":\"25b68412-42de-4d04-a755-dbe91e10bf98\",\"objectRef\":{\"resource\":\"subjectaccessreviews\",\"apiGroup\":\"authorization.k8s.io\",\"apiVersion\":\"v1\"},\"userAgent\":\"kubelet/v1.21.2 (linux/amd64) kubernetes/3d33787\",\"sourceIPs\":[\"18.118.132.47\"],\"responseStatus\":{\"metadata\":{},\"code\":201},\"responseObject\":{\"kind\":\"SubjectAccessReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null,\"managedFields\":[{\"manager\":\"kubelet\",\"operation\":\"Update\",\"apiVersion\":\"authorization.k8s.io/v1\",\"time\":\"2024-10-10T15:39:56Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:spec\":{\"f:extra\":{ \"f:authentication.kubernetes.io/pod-name\":{},\"f:authentication.kubernetes.io/pod-uid\":{}},\"f:groups\":{},\"f:resourceAttributes\":{ \"f:name\":{},\"f:resource\":{},\"f:subresource\":{},\"f:verb\":{},\"f:version\":{}},\"f:uid\":{},\"f:user\":{}}}}]},\"spec\":{\"resourceAttributes\":{\"verb\":\"get\",\"version\":\"v1\",\"resource\":\"nodes\",\"subresource\":\"metrics\",\"name\":\"ip-172-31-43-38.us-east-2.compute.internal\"},\"user\":\"system:serviceaccount:monitoring24:coralogix-opentelemetry-collector\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:monitoring24\",\"system:authenticated\"],\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"coralogix-opentelemetry-collector-8497849d4-9bmvl\"],\"authentication.kubernetes.io/pod-uid\":[\"1bd6c1e0-5d2c-4d85-9a3b-1e3c838e3dc1\"]},\"uid\":\"3772d3fb-8c4e-4af6-be48-924e91cfe7d4\"},\"status\":{\"allowed\":true,\"reason\":\"RBAC: allowed by ClusterRoleBinding \\\"coralogix-opentelemetry-collector\\\" of ClusterRole \\\"coralogix-opentelemetry-collector\\\" to ServiceAccount \\\"coralogix-opentelemetry-collector/monitoring24\\\"\"}},\"user\":{\"username\":\"system:node:ip-172-31-43-38.us-east-2.compute.internal\",\"uid\":\"aws-iam-authenticator:074157727657:AROARCRBFD6U5I6XD6RHO\",\"groups\":[\"system:bootstrappers\",\"system:nodes\",\"system:authenticated\"],\"extra\":{\"accessKeyId\":[\"ASIARCRBFD6UYC7YIWNE\"],\"arn\":[\"arn:aws:sts::074157727657:assumed-role/eks-nodes/i-0b423258572c23bf6\"],\"canonicalArn\":[\"arn:aws:iam::074157727657:role/eks-nodes\"],\"principalId\":[\"AROARCRBFD6U5I6XD6RHO\"],\"sessionName\":[\"i-0b423258572c23bf6\"],\"sigs.k8s.io/aws-iam-authenticator/principalId\":[\"AROARCRBFD6U5I6XD6RHO\"]}},\"level\":\"RequestResponse\",\"annotations\":{\"authorization.k8s.io/decision\":\"allow\",\"authorization.k8s.io/reason\":\"\"},\"stageTimestamp\":\"2024-10-10T15:39:56.576301Z\",\"requestReceivedTimestamp\":\"2024-10-10T15:39:56.573475Z\",\"verb\":\"create\",\"kind\":\"Event\",\"apiVersion\":\"audit.k8s.io/v1\"}\n}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"statusObject\":{",
                  "rule": "\"status\"\\s*?:\\s*?\\{"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "6981f8b0-dbef-4c44-9d9f-0feeb31b4013",
          "rules": [
            {
              "id": "1c36c3c9-93aa-48b8-9044-cb2318b6b494",
              "name": "app abuse",
              "description": "There's a field called \"app\" which is just text, and many of type \"app.kubernetes.io/<xxx>\" which are also text, but the dot notation makes it think app is an object. Rename \"app\" since it's rarely there\n\"labels\":{\n\"app\":\"cartservice\",\n\"pod-template-hash\":\"5df6bd977\"\n}",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"application\":",
                  "rule": "\"app\"\\s*:"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        }
      ],
      "order": 26
    },
    {
      "id": "d914e180-8ea2-4641-99dc-ab71a4f10105",
      "name": "Extract http method and response code",
      "description": "",
      "creator": "support@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "0dfa5e0b-5e9a-4fbb-baad-e03f9b78f5e4",
          "rules": [
            {
              "id": "8d10c327-fab5-4e68-bb44-f45339094569",
              "name": "method and response",
              "description": "",
              "sourceField": "text.body",
              "parameters": {
                "extractParameters": {
                  "rule": "\"(?P<method>[A-Z]+) [^\"]+\" (?P<status_code>\\d{3})\n"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 27
    },
    {
      "id": "6ffd79d8-0c4f-460b-a699-70d160155cd5",
      "name": "ruben rule to remove",
      "description": "",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "statuspage"
          }
        },
        {
          "subsystemName": {
            "value": "coralogix-ebpf-profiler"
          }
        },
        {
          "severity": {
            "value": "VALUE_DEBUG_OR_UNSPECIFIED"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "5ebed3f8-340f-4c11-86e8-75f73d7ba745",
          "rules": [
            {
              "id": "1566d886-c70b-4352-9c0c-729e7e80bcc7",
              "name": "aasdasd",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "removeFieldsParameters": {
                  "fields": [
                    "requestParameters.encryptionContext.aws:lambda:FunctionArn"
                  ]
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 28
    }
  ],
  "count": 28,
  "resource_identifiers": [
    "3515c5eb-7cb4-45e2-85b8-2feda266ce9d",
    "f31216f5-06c2-4f75-b6c8-f260d815db78",
    "1fb0df15-eefc-4b0a-8055-b3cb99e84f3f",
    "d5ad7c48-1e13-47c7-b078-66c2611abf4f",
    "8fa2fb7f-3046-4429-bd9e-49820b46b95d",
    "30273d4a-161c-485e-a0f7-814db82b4981",
    "4eacfd86-1bc7-4dc9-9a0f-78bf1f6a37b1",
    "0496b342-091a-48a5-a0b9-e4aff8778ca0",
    "a9c191e3-4dcc-47dc-a576-b1f845bb008f",
    "ba5716ce-cb7e-45bf-b3f1-33e09889720c",
    "aaf89b1b-2580-4628-a63c-f96fc73b903c",
    "6bd74954-92ff-4a91-85a8-09383ead4d9d",
    "70802300-9bf1-48d8-b21a-b4e91d12bca9",
    "3a471869-e506-4104-bae1-c1a7f0a77936",
    "b2cfdca4-ffea-4548-a9d2-e5c90acdff24",
    "1d5293c9-a04b-45f9-b80f-1ebda66767ce",
    "ee4b38a9-3768-49ee-9193-e6424745a8d7",
    "1132fc85-f45f-4c66-9c5a-0fd4ceacd0d3",
    "39d733e6-184e-4be0-9fba-f50160ba13f9",
    "41ead467-a24d-4b88-9148-690c6874f148",
    "00c05394-9f5a-4c4d-86ae-00cd298c29cb",
    "2899cbbf-5ca0-4b0f-b358-e672518b21c5",
    "cfdc9d60-6466-4a72-91c4-b0fdc4f44b3f",
    "6ce9880a-9156-4416-a410-fc1d3d129c95",
    "d153a2a1-2e82-4a1b-82d6-0965c4c52064",
    "f9ed48df-2a22-47cd-a96d-b9a8a5800eec",
    "d914e180-8ea2-4641-99dc-ab71a4f10105",
    "6ffd79d8-0c4f-460b-a699-70d160155cd5"
  ]
}