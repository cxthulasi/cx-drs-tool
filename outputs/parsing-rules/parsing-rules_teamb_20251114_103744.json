{
  "timestamp": "2025-11-14T10:37:44.445893",
  "service": "parsing-rules",
  "team": "teamb",
  "resources": [
    {
      "id": "d44c48e3-98b6-4cb5-83c0-7730701f5195",
      "name": "k8s Opentelemetry parsing",
      "description": "k8s Opentelemetry extension pack",
      "creator": "k8s Opentelemetry extension pack",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "a9aa9bee-8db8-436a-82c4-010fca330fdc",
          "rules": [
            {
              "id": "c00fa58a-b9d7-474a-8e4f-ba089568a3b1",
              "name": "Stringify logRecord",
              "description": "",
              "sourceField": "text.logRecord",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.logRecord_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "6565b4bf-7f03-4319-a70e-0d025e7eeab5",
          "rules": [
            {
              "id": "2d0a5251-ac5c-43a1-8f8f-95225148c2cb",
              "name": "Parse json logRecord_tmp",
              "description": "",
              "sourceField": "text.logRecord_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "15c1c2ba-a047-40a0-bcae-d03d0dcb0a37",
          "rules": [
            {
              "id": "ecc54b6a-8ced-4182-a12e-88f65c0c3a00",
              "name": "Parse json body",
              "description": "",
              "sourceField": "text.body",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        },
        {
          "id": "bf29e9c7-5643-4ac1-84c6-1832223f880a",
          "rules": [
            {
              "id": "0fb4e786-7cae-4524-8151-67e4d712e160",
              "name": "map deprecatedLastTimestamp, eventTime as datetime fields",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"${1}_custom_timestamp\":\"",
                  "rule": "\"(deprecatedLastTimestamp|eventTime)\":\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 4
        },
        {
          "id": "ad63bdc0-d99c-4ba5-95af-b1b4b49dacb7",
          "rules": [
            {
              "id": "59e65a5e-e9b9-409c-9510-08bd99b77006",
              "name": "fix mapping exception for infra collector empty f:annotations",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "${1}\"f:workflow\":{",
                  "rule": "(\"f:annotations\":\\{.*?)\"\\.\":\\{"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 5
        },
        {
          "id": "6595911d-2868-4fbf-a837-c1d674b3565c",
          "rules": [
            {
              "id": "09134ea7-2098-4c50-946e-06ea4e385e0c",
              "name": "Parse common logs from k8s containers",
              "description": "This rule parses containers: kube-apiserver, kube-controller-manager, kube-proxy, kube-scheduler, storage-provisioner.",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"message\":\"$message\"",
                  "rule": "\"body\":\"(?P<level>[A-Z])(?P<timestamp>\\d{4} \\d{2}:\\d{2}:\\d{2}\\.\\d+)\\s*1 (?P<caller>[^\\]]+)\\] (?P<message>(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "6077b51b-1389-4788-a2e9-ffaae94a20c6",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with time",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(time=\\\\\"(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 2
            },
            {
              "id": "b116d5a8-1e65-4d29-a43a-2bc5ffa2c3a3",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with ts",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(ts=\\d{4}(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 3
            },
            {
              "id": "bd7ac93a-1415-4556-8e71-d98f0c5b1a7a",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with level",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(level=(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 4
            }
          ],
          "enabled": true,
          "order": 6
        },
        {
          "id": "60022c7e-5b80-454a-9113-ffb3f029b0ff",
          "rules": [
            {
              "id": "a516d64b-4fc8-4ffa-8cf7-36a912f57664",
              "name": "Extract msg from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "extractParameters": {
                  "rule": "msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 7
        },
        {
          "id": "9f14fd38-9280-451e-aa29-857748fd6307",
          "rules": [
            {
              "id": "2909c01a-4aa4-4318-a4d1-656a1732754f",
              "name": "Remove msg from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\s+msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 8
        },
        {
          "id": "659c4953-17e9-4199-b4a4-7a656ef846a4",
          "rules": [
            {
              "id": "4e8fc93e-8d0d-485b-b9aa-07c1f645dd3e",
              "name": "Extract query from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "extractParameters": {
                  "rule": "query=\\\\\"(?P<query>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "393d9ec1-8085-4e23-a0b1-c5d12631d7e9",
              "name": "Extract query from kvPairs when kvPairs also had msg in it along with query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "extractParameters": {
                  "rule": "query=\\\\\\\\\\\\\"(?P<query>(?:\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 9
        },
        {
          "id": "842eec97-c7f3-4569-b6c2-ea44b9ea8c19",
          "rules": [
            {
              "id": "8f23c12a-3fcb-4bb5-b566-6029325edb61",
              "name": "remove query from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\s+query=\\\\\"(?P<query>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "d68dc05e-3fe6-48bf-9049-c72caf9b8a6c",
              "name": "remove query from kvPairs when kvPairs also had msg in it along with query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\s+query=\\\\\\\\\\\\\"(?P<query>(?:\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 10
        },
        {
          "id": "85ec9124-7a52-4b99-b588-a1252f3617cc",
          "rules": [
            {
              "id": "fe01b722-3dff-4876-8fc0-2c1b41c105e3",
              "name": "prepare all the rest of the fields in a kvPairs field that had both msg and query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                  "rule": "([\\w\\.\\-\\_]+)=\\\\{7}\"((?:\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\+\"|[^\"])+)\\\\{7}\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "5ffca88b-5199-49e1-b480-a03b54d1fa76",
              "name": "prepare all the rest of the fields in a kvPairs field that had either msg or query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                  "rule": "([\\w\\.\\-\\_]+)=\\\\{3}\"((?:\\\\\\\\\\\\\\\\+\"|[^\"])+)\\\\{3}\""
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 11
        },
        {
          "id": "f2b67afe-79a1-441f-90b1-364a593f2cd7",
          "rules": [
            {
              "id": "50416830-4307-4798-b271-dde3df86616a",
              "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had both msg and query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\\\{15,}\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "b6deb752-2dc9-4f3b-a245-dea6be375d3f",
              "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had either msg or query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\\\{7,}\""
                }
              },
              "enabled": true,
              "order": 2
            },
            {
              "id": "e8696fc3-eea4-43c8-8c51-5feb8cd14f45",
              "name": "remove all double quotes if they have more than one consecutive backslash prior to them for kvPairs that had no msg or query",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\\\{3,}\""
                }
              },
              "enabled": true,
              "order": 3
            }
          ],
          "enabled": true,
          "order": 12
        },
        {
          "id": "c2636c86-371a-4f9f-b85d-c4495f2bd432",
          "rules": [
            {
              "id": "fe481bca-1d21-448f-bc32-f3188c3826ff",
              "name": "Replace all remaining occurrences of double quotes with their corresponding backslash with \u00a7",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7",
                  "rule": "\\\\+\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 13
        },
        {
          "id": "91b6fd90-e5ad-48d0-b499-f1bb5aa5b4c9",
          "rules": [
            {
              "id": "8145dd16-dcbb-45da-9091-cff8a8315a97",
              "name": "wrap the keys of the key/val pairs with \u00a7 wrapping the value with \u00a7",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                  "rule": "([\\w\\.\\-]+)=\\xA7([^\\xA7]*)\\xA7"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 14
        },
        {
          "id": "cbaecfa2-87c6-4884-ab6b-c431f433abcd",
          "rules": [
            {
              "id": "dc3debdd-333b-450e-aae5-5f1342a8acb1",
              "name": "Adding to the rest of key/val pairs \u00a7 before and after the keys and values",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7${1}\u00a7:\u00a7${2}\u00a7",
                  "rule": "([\\w\\.\\-\\_]+)=((?:$|[^ ])*)(?: |$)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 15
        },
        {
          "id": "faf1f174-5681-4c70-98d4-46d8bae10891",
          "rules": [
            {
              "id": "492aa885-06f6-46af-a7ad-4275b364750b",
              "name": "Adding commas between key/val pairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "${1}:${2},",
                  "rule": "(\\xA7[^\\xA7]*\\xA7):(\\xA7[^\\xA7]*\\xA7)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 16
        },
        {
          "id": "ff37469a-339a-40d2-9798-052a92512b85",
          "rules": [
            {
              "id": "09b68795-f4a0-4461-9e50-f3da08366304",
              "name": "Remove last comma before jsonizing kvPairs field",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "{$1}",
                  "rule": "(.*),"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 17
        },
        {
          "id": "e5c847a3-7924-4256-a8d9-1999d5977cf9",
          "rules": [
            {
              "id": "b07ee040-af10-4920-aa06-87dce95c766c",
              "name": "Replacing \u00a7 with \" to jsonize kvPairs in order to get a valid JSON",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\"",
                  "rule": "\\xA7"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 18
        },
        {
          "id": "77b5dd56-8824-480f-ba66-0997fe9ce63e",
          "rules": [
            {
              "id": "be24fa98-6132-462f-8e02-7b10cc949207",
              "name": "reformat kvPairs field back to an escaped JSON string format",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.kvPairs_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 19
        },
        {
          "id": "ba3d6100-cc13-4779-bc96-25509d615377",
          "rules": [
            {
              "id": "9f1c33d3-f689-4693-a4c1-067d32684934",
              "name": "Parse kvPairs_tmp as JSON to root",
              "description": "",
              "sourceField": "text.kvPairs_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 20
        }
      ],
      "order": 1
    },
    {
      "id": "e4977f8f-6132-46c4-baa7-7bc33d7fff4c",
      "name": "remove fields",
      "description": "",
      "creator": "thulasiram.toorpu@coralogix.com",
      "enabled": false,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "b5f4f179-965e-428d-b758-51f410db2900",
          "rules": [
            {
              "id": "14204475-7c1f-43ef-b149-e08f873df847",
              "name": "remove fields",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "removeFieldsParameters": {
                  "fields": [
                    "resource.attributes.cloud_provider",
                    "resource.attributes.cloud_account_id",
                    "resource.attributes.cloud_availability_zone",
                    "resource.attributes.cloud_platform"
                  ]
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 3
    },
    {
      "id": "86a34579-e3d8-43ae-86d8-2398e46fdbe5",
      "name": "Severity Rules",
      "description": "",
      "creator": "",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "a68e3f33-6aee-41b5-90a3-9333548fd99f",
          "rules": [
            {
              "id": "3fa94fcf-78b8-4a9d-8b58-2f5d53739f20",
              "name": "Severity Rule",
              "description": "Look for default severity text",
              "sourceField": "text",
              "parameters": {
                "extractParameters": {
                  "rule": "\\b(?P<severity>DEBUG|TRACE|INFO|WARN|ERROR|FATAL|EXCEPTION|[Dd]ebug|[Tt]race|[Ii]nfo|[Ww]arn|[Ee]rror|[Ff]atal|[Ee]xception)\\b"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 4
    }
  ],
  "count": 3,
  "resource_identifiers": [
    "d44c48e3-98b6-4cb5-83c0-7730701f5195",
    "e4977f8f-6132-46c4-baa7-7bc33d7fff4c",
    "86a34579-e3d8-43ae-86d8-2398e46fdbe5"
  ]
}