{
  "timestamp": "2025-11-07T01:05:02.538350",
  "service": "parsing-rules",
  "team": "teamb",
  "resources": [
    {
      "id": "468535f2-a28c-4fe6-be17-bba231c3a173",
      "name": "k8s Opentelemetry parsing",
      "description": "k8s Opentelemetry extension pack",
      "creator": "k8s Opentelemetry extension pack",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "7efe4440-a3a5-42cc-8906-88200987ee57",
          "rules": [
            {
              "id": "ecf9dcea-663e-4b47-935b-bfbcba0ce519",
              "name": "Stringify logRecord",
              "description": "",
              "sourceField": "text.logRecord",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.logRecord_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "b012fd49-0f02-4c1d-9543-349d0caa6900",
          "rules": [
            {
              "id": "98e52aee-e106-417c-adf2-813453d74129",
              "name": "Parse json logRecord_tmp",
              "description": "",
              "sourceField": "text.logRecord_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "2bdc5c4d-7933-426b-a13a-cd6c584ab793",
          "rules": [
            {
              "id": "7d6092aa-adb9-4c67-9dbd-a7568b630913",
              "name": "Stringify body",
              "description": "",
              "sourceField": "text.body",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.body_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        },
        {
          "id": "dcb6aefa-e0f1-49ee-8b5d-063191de3e76",
          "rules": [
            {
              "id": "ef06fe0d-538a-47b0-9b7c-107212539f93",
              "name": "Parse json body",
              "description": "",
              "sourceField": "text.body",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "ef942186-dc10-473e-b631-2d359ca9934f",
              "name": "Parse json body_tmp",
              "description": "",
              "sourceField": "text.body_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 4
        },
        {
          "id": "21c51e02-2399-42f9-9ed3-0fd41c198417",
          "rules": [
            {
              "id": "840912bd-e8e7-4513-8e81-aff227b58ab4",
              "name": "Replacing all dots within field names with underscores",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"${1}_${2}_${3}_${4}_${5}_${6}_${7}_${8}_${9}_${10}\":",
                  "rule": "\"([a-zA-Z\\d\\_]+)\\.([a-zA-Z\\d\\_]+)(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?\":"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 5
        },
        {
          "id": "d0f01713-949d-4fe0-92e8-1188c6867b56",
          "rules": [
            {
              "id": "95e249be-937a-4c7d-986a-6630ce03599c",
              "name": "Remove trailing underscores",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"$1\":",
                  "rule": "\"([^\"]+?)\\_+\":"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 6
        },
        {
          "id": "2672494d-d0e1-43b1-a6aa-be5aa00305b8",
          "rules": [
            {
              "id": "04888ed7-de32-4cf1-89ff-a28051e7d2f2",
              "name": "map deprecatedLastTimestamp, eventTime as datetime fields",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"${1}_custom_timestamp\":\"",
                  "rule": "\"(deprecatedLastTimestamp|eventTime)\":\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 7
        },
        {
          "id": "af6695ea-3253-4b9a-b563-c6352db7d6a1",
          "rules": [
            {
              "id": "4cf04679-063e-4bf8-b32c-5dca1e1752dc",
              "name": "fix mapping exception for infra collector empty f:annotations",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "${1}\"f:workflow\":{",
                  "rule": "(\"f:annotations\":\\{.*?)\"\\.\":\\{"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 8
        },
        {
          "id": "6262fb7a-e37d-4aa1-9131-27eabe940fff",
          "rules": [
            {
              "id": "6855b4cb-e852-492b-8bbc-049e38d729a0",
              "name": "Parse common logs from k8s containers",
              "description": "This rule parses containers: kube-apiserver, kube-controller-manager, kube-proxy, kube-scheduler, storage-provisioner.",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"message\":\"$message\"",
                  "rule": "\"body\":\"(?P<level>[A-Z])(?P<timestamp>\\d{4} \\d{2}:\\d{2}:\\d{2}\\.\\d+)\\s*1 (?P<caller>[^\\]]+)\\] (?P<message>(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "bf9925fa-8744-49ed-ba9a-9771f8596480",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with time",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(time=\\\\\"(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 2
            },
            {
              "id": "6ddef1fa-c150-450d-aa5b-dacc8dcc4109",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with ts",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(ts=\\d{4}(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 3
            }
          ],
          "enabled": true,
          "order": 9
        },
        {
          "id": "c68cbbef-e0d3-49f3-96ca-89c1fab9f517",
          "rules": [
            {
              "id": "d229362b-f995-4393-b3dd-35e6a894c13f",
              "name": "Extract msg from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "extractParameters": {
                  "rule": "msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 10
        },
        {
          "id": "31662eed-a19f-45e7-b016-5dc384aa3b5c",
          "rules": [
            {
              "id": "841e7a16-a7b4-4e31-851f-53302d0eafcb",
              "name": "Remove msg from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\smsg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 11
        },
        {
          "id": "8d765afb-a571-4c23-b07c-bd2f627099df",
          "rules": [
            {
              "id": "50bfdd1b-1f2c-4197-b08d-6adf2295fe61",
              "name": "Jsonizing key/vals when val is enclosed with double quotes",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7$1\u00a7:\u00a7$2\u00a7,",
                  "rule": "([\\w\\.\\-]+)=\\\\\\\\\\\\\"((?:\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 12
        },
        {
          "id": "4dd92f8b-40da-4952-801c-1312ee340a5d",
          "rules": [
            {
              "id": "df0f8b46-b698-4b98-9c03-ee5620dfca99",
              "name": "Remove any remaining backslashes followed by double quotes",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\\\+\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 13
        },
        {
          "id": "d3846b7d-1e91-418f-9bab-875fe4018807",
          "rules": [
            {
              "id": "6b8d0ef9-9b47-4d38-846d-3f3ebe65247f",
              "name": "Jsonizing rest of key/vals",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7$1\u00a7:\u00a7$2\u00a7,",
                  "rule": "([\\w\\.\\-]+)=((?:$|[^ \\xA7])+)?(?: |$)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 14
        },
        {
          "id": "3a8de52f-5bcf-4456-b69a-c91847aa50ec",
          "rules": [
            {
              "id": "abaa71af-e183-436c-b5b0-94cb6b17b542",
              "name": "Removing last Comma and wrapping with curly brackets",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "{$1}",
                  "rule": "(.*),"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 15
        },
        {
          "id": "9d8b4491-cc56-4ca8-96cc-1c5f837c135c",
          "rules": [
            {
              "id": "177af4c8-f58a-4322-a7b0-293cdc0f090a",
              "name": "Replacing \u00a7 with double quotes in order to get a valid JSON",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\"",
                  "rule": "\\xA7"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 16
        },
        {
          "id": "feb000ae-b95a-4602-a49b-69bcc2cf175c",
          "rules": [
            {
              "id": "518bee37-83cc-4b12-807c-0af38a4fb0f5",
              "name": "reformat kvPairs field back to an escaped JSON string format",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.kvPairs_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 17
        },
        {
          "id": "a29cf36c-8c62-451d-9c22-0e5bf2c9d61e",
          "rules": [
            {
              "id": "9a9e5de3-2a4b-4af0-a1ae-aa3c9bce276c",
              "name": "Parse kvPairs_tmp as JSON to root",
              "description": "",
              "sourceField": "text.kvPairs_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 18
        }
      ],
      "order": 1
    },
    {
      "id": "58e02a6d-59f8-487d-92af-ab074c556657",
      "name": "remove fields",
      "description": "",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "9eb93ea2-b2e3-4bb4-a2ce-d4772dd56546",
          "rules": [
            {
              "id": "6b879189-cc9f-4e42-b9d9-75845261b5f0",
              "name": "remove fields",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "removeFieldsParameters": {
                  "fields": [
                    "resource.attributes.cloud_provider",
                    "resource.attributes.cloud_account_id",
                    "resource.attributes.cloud_availability_zone",
                    "resource.attributes.cloud_platform"
                  ]
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 2
    },
    {
      "id": "68fa9e34-9a51-4520-9220-8fec1e7e710f",
      "name": "Severity Rules",
      "description": "",
      "creator": "",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "40bd3db5-49d1-41a5-8892-d2ba621be27e",
          "rules": [
            {
              "id": "fe5186f3-810b-4a4c-aa2c-d86cae60e64c",
              "name": "Severity Rule",
              "description": "Look for default severity text",
              "sourceField": "text",
              "parameters": {
                "extractParameters": {
                  "rule": "\\b(?P<severity>DEBUG|TRACE|INFO|WARN|ERROR|FATAL|EXCEPTION|[Dd]ebug|[Tt]race|[Ii]nfo|[Ww]arn|[Ee]rror|[Ff]atal|[Ee]xception)\\b"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 3
    },
    {
      "id": "dedb61ab-ec01-48bf-a60f-1dea35fe092e",
      "name": "Cloudtrail rules",
      "description": "Cloudtrail extension pack",
      "creator": "Cloudtrail extension pack",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "aws"
          }
        },
        {
          "subsystemName": {
            "value": "lambda.amazonaws.com"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "9c15dcd7-b0fb-4937-9359-95258f0ab079",
          "rules": [
            {
              "id": "b5c904ea-1e5e-462d-8489-c19dc730ea5a",
              "name": "Replace Cloudtrail log severity to error if errorMessage exists",
              "description": "",
              "sourceField": "text.errorMessage",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "severity",
                  "replaceNewVal": "ERROR",
                  "rule": ".*"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 4
    },
    {
      "id": "51f377e2-bd59-42cc-8a91-7348414aa337",
      "name": "topipaddress",
      "description": "topipaddress",
      "creator": "toorfthu@amazon.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "aws"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "fe929d05-2d08-4400-bc18-4135a78bf3ab",
          "rules": [
            {
              "id": "3bb689b8-92c8-49a4-b90c-487d6bd40954",
              "name": "critical errors",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text",
                  "rule": "awsRegion(?P<region>(\\S*))\\s.*sourceIPAddress:(?P<IpAddress>(\\S*))\\s.*errorCode:(?P<error_code>(\\S*))"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 5
    },
    {
      "id": "34628f75-afe8-4b12-bad1-6b8f1b076f90",
      "name": "refined-parsingrule",
      "description": "",
      "creator": "toorfthu@amazon.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "aws"
          }
        },
        {
          "subsystemName": {
            "value": "s3.amazonaws.com"
          }
        },
        {
          "severity": {
            "value": "VALUE_WARNING"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "1415b81d-8408-426b-b0be-b5bd6e88a174",
          "rules": [
            {
              "id": "d618fd2b-de51-4213-bc06-59be6d8706d1",
              "name": "useful-extraction",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text",
                  "rule": "\\b(?P<ip>(?:[0-9]{1,3}\\.){3}[0-9]{1,3})\\b"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 6
    },
    {
      "id": "96489067-655f-43c2-a2f5-223f77282d23",
      "name": "Change Severity of Elb logs",
      "description": "Change Severity of Elb logs",
      "creator": "thulasiram.toorpu@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "26149796-b6f1-4326-82b7-06348d6f4401",
          "rules": [
            {
              "id": "e3dda713-e92f-453b-ba2b-9a590367b804",
              "name": "Change Severity of Elb logs",
              "description": "Change Severity of Elb logs",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "severity",
                  "replaceNewVal": "ERROR",
                  "rule": ".*(target_status_code|elb_status_code)\":\"[5]\\d{2}\".*"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 7
    },
    {
      "id": "e2877f65-03b4-48c4-9a45-0a04c675a329",
      "name": "parsing rule for sample application",
      "description": "parsing rule for sample application",
      "creator": "",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "cs-app"
          }
        },
        {
          "applicationName": {
            "value": "sample"
          }
        },
        {
          "subsystemName": {
            "value": "cs-app"
          }
        },
        {
          "subsystemName": {
            "value": "sample"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "ad8ff703-9fa3-41ce-a55c-d54ee79b3cda",
          "rules": [
            {
              "id": "ca7a6e4e-6071-4980-a83a-e8a2e0580850",
              "name": "extract json log",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "extractParameters": {
                  "rule": "message\\s*:s*(?P<bytes>\\d+)\\s*.*?status\\sis\\s(?P<status>\\[^\"]+)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 8
    }
  ],
  "count": 8,
  "resource_identifiers": [
    "k8s Opentelemetry parsing",
    "remove fields",
    "Severity Rules",
    "Cloudtrail rules",
    "topipaddress",
    "refined-parsingrule",
    "Change Severity of Elb logs",
    "parsing rule for sample application"
  ]
}