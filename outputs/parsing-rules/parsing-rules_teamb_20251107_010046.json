{
  "timestamp": "2025-11-07T01:00:46.578798",
  "service": "parsing-rules",
  "team": "teamb",
  "resources": [
    {
      "id": "a2978599-bf94-4966-927c-bfff21a31803",
      "name": "Cloudtrail rules",
      "description": "Cloudtrail extension pack",
      "creator": "Cloudtrail extension pack",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "aws"
          }
        },
        {
          "subsystemName": {
            "value": "lambda.amazonaws.com"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "5c4db8b4-0f17-46ca-96c8-dcb23bf418e5",
          "rules": [
            {
              "id": "e89ed4fe-43ea-458c-b6e0-ec5e48cb1708",
              "name": "Replace Cloudtrail log severity to error if errorMessage exists",
              "description": "",
              "sourceField": "text.errorMessage",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "severity",
                  "replaceNewVal": "ERROR",
                  "rule": ".*"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 1
    },
    {
      "id": "b250ed7d-d599-4960-8eb6-fbefb370e14c",
      "name": "remove fields",
      "description": "",
      "creator": "bot@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "cbc93d2d-8062-4bd8-bd98-7fd27a29e603",
          "rules": [
            {
              "id": "c9a09fcb-6237-4505-a263-d2acb0c97884",
              "name": "remove fields",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "removeFieldsParameters": {
                  "fields": [
                    "resource.attributes.cloud_provider",
                    "resource.attributes.cloud_account_id",
                    "resource.attributes.cloud_availability_zone",
                    "resource.attributes.cloud_platform"
                  ]
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 2
    },
    {
      "id": "020d0b50-535c-4d4c-a73a-4d13154b56d6",
      "name": "Severity Rules",
      "description": "",
      "creator": "",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "3061b82b-7c32-4fbe-beb8-5a4b3aba2a8e",
          "rules": [
            {
              "id": "6cd41dfc-74b6-4071-8818-67f4695870bb",
              "name": "Severity Rule",
              "description": "Look for default severity text",
              "sourceField": "text",
              "parameters": {
                "extractParameters": {
                  "rule": "\\b(?P<severity>DEBUG|TRACE|INFO|WARN|ERROR|FATAL|EXCEPTION|[Dd]ebug|[Tt]race|[Ii]nfo|[Ww]arn|[Ee]rror|[Ff]atal|[Ee]xception)\\b"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 3
    },
    {
      "id": "02a9271f-1453-4084-84d8-f8397da37de9",
      "name": "k8s Opentelemetry parsing",
      "description": "k8s Opentelemetry extension pack",
      "creator": "k8s Opentelemetry extension pack",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "64356ee5-164d-4cb1-b7b0-2157e909d482",
          "rules": [
            {
              "id": "cae93d86-f63f-4dba-b658-a76947c392b6",
              "name": "Stringify logRecord",
              "description": "",
              "sourceField": "text.logRecord",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.logRecord_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        },
        {
          "id": "a142bd5e-00dd-4cc2-aa64-f1dd157ae9bd",
          "rules": [
            {
              "id": "913ed9a7-3d22-467c-b741-dfa8d9830c6a",
              "name": "Parse json logRecord_tmp",
              "description": "",
              "sourceField": "text.logRecord_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 2
        },
        {
          "id": "c18ff8ea-aff9-4e37-8bdc-659d6e7f065d",
          "rules": [
            {
              "id": "b6a4110c-46be-4b3f-8ab8-d7bd856efca4",
              "name": "Stringify body",
              "description": "",
              "sourceField": "text.body",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.body_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 3
        },
        {
          "id": "4c97ad62-8dfe-46f7-9b1e-6b4adb3095bd",
          "rules": [
            {
              "id": "31ba4330-0fe7-4058-93f9-84e7617ec511",
              "name": "Parse json body",
              "description": "",
              "sourceField": "text.body",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "8a44bf90-fb4a-4664-a120-ea1b62dc9a4b",
              "name": "Parse json body_tmp",
              "description": "",
              "sourceField": "text.body_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 2
            }
          ],
          "enabled": true,
          "order": 4
        },
        {
          "id": "04888b83-c08e-434d-b90e-6c24945b18a9",
          "rules": [
            {
              "id": "ae7f0ae8-cd92-4383-912c-00311527d3a8",
              "name": "Replacing all dots within field names with underscores",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"${1}_${2}_${3}_${4}_${5}_${6}_${7}_${8}_${9}_${10}\":",
                  "rule": "\"([a-zA-Z\\d\\_]+)\\.([a-zA-Z\\d\\_]+)(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?(?:\\.([a-zA-Z\\d\\_]+))?\":"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 5
        },
        {
          "id": "91e930b7-0cf8-4137-90c2-5408185d9872",
          "rules": [
            {
              "id": "388ad1b6-fa52-40ae-a61b-b852616806d9",
              "name": "Remove trailing underscores",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"$1\":",
                  "rule": "\"([^\"]+?)\\_+\":"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 6
        },
        {
          "id": "a4347880-f72d-46c2-97b1-0b50cc074810",
          "rules": [
            {
              "id": "ad80494f-19bf-4e22-b1fc-d1f6fc5483e1",
              "name": "map deprecatedLastTimestamp, eventTime as datetime fields",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"${1}_custom_timestamp\":\"",
                  "rule": "\"(deprecatedLastTimestamp|eventTime)\":\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 7
        },
        {
          "id": "558fc445-8976-41cb-bfdd-a6a087c2d586",
          "rules": [
            {
              "id": "7d0df24f-bc82-4285-a4c8-94ba8b247703",
              "name": "fix mapping exception for infra collector empty f:annotations",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "${1}\"f:workflow\":{",
                  "rule": "(\"f:annotations\":\\{.*?)\"\\.\":\\{"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 8
        },
        {
          "id": "4b68a517-c45a-459c-a55d-9959c3ae48c7",
          "rules": [
            {
              "id": "eaa4fd45-ef3c-47d7-a280-961c8784bab9",
              "name": "Parse common logs from k8s containers",
              "description": "This rule parses containers: kube-apiserver, kube-controller-manager, kube-proxy, kube-scheduler, storage-provisioner.",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"level\":\"$level\",\"timestamp\":\"$timestamp\",\"caller\":\"$caller\",\"message\":\"$message\"",
                  "rule": "\"body\":\"(?P<level>[A-Z])(?P<timestamp>\\d{4} \\d{2}:\\d{2}:\\d{2}\\.\\d+)\\s*1 (?P<caller>[^\\]]+)\\] (?P<message>(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 1
            },
            {
              "id": "c6fe6716-1cfb-4a60-ba9c-7decec637e15",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with time",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(time=\\\\\"(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 2
            },
            {
              "id": "08aa2f9e-ab0e-4a66-8edf-509aabe97a1f",
              "name": "Replace body with kvPairs when body is a kv pairs message starts with ts",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text",
                  "replaceNewVal": "\"kvPairs\":\"${1}\"",
                  "rule": "\"body\":\"(ts=\\d{4}(?:\\\\\"|[^\"])+?)(?:\\\\n)?\""
                }
              },
              "enabled": true,
              "order": 3
            }
          ],
          "enabled": true,
          "order": 9
        },
        {
          "id": "917f8dd2-bf2c-4ba2-a5f9-19b274b29c12",
          "rules": [
            {
              "id": "70793d52-0538-4eb3-9b25-34cf60d2f5ac",
              "name": "Extract msg from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "extractParameters": {
                  "rule": "msg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 10
        },
        {
          "id": "80285c8b-dd93-4375-8f0c-a516ed6c8e72",
          "rules": [
            {
              "id": "0350b0d9-689d-4ff8-8529-0ed10eff72cb",
              "name": "Remove msg from kvPairs",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\smsg=\\\\\"(?P<msg>(?:\\\\\\\\\"|[^\"])+)\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 11
        },
        {
          "id": "2b2fe818-f7c8-4c95-a760-f34caad6d146",
          "rules": [
            {
              "id": "8195198b-8b3d-4067-98cc-f289caf4c44c",
              "name": "Jsonizing key/vals when val is enclosed with double quotes",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7$1\u00a7:\u00a7$2\u00a7,",
                  "rule": "([\\w\\.\\-]+)=\\\\\\\\\\\\\"((?:\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"|[^\"])+)\\\\\\\\\\\\\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 12
        },
        {
          "id": "7921f1fe-a564-4fbb-ae2e-948642ef4619",
          "rules": [
            {
              "id": "006918b7-d00b-4ab3-a09f-e3d2fed448c9",
              "name": "Remove any remaining backslashes followed by double quotes",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "",
                  "rule": "\\\\+\""
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 13
        },
        {
          "id": "124c9d62-0b96-4441-b0c6-45f278e29186",
          "rules": [
            {
              "id": "7e9d9620-f15e-41ef-97fb-e10f695a1e27",
              "name": "Jsonizing rest of key/vals",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\u00a7$1\u00a7:\u00a7$2\u00a7,",
                  "rule": "([\\w\\.\\-]+)=((?:$|[^ \\xA7])+)?(?: |$)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 14
        },
        {
          "id": "89fcee2e-ed1d-4718-9aaa-e8fe87438577",
          "rules": [
            {
              "id": "5cd963dd-b2ae-44c7-8913-54330a45a5e7",
              "name": "Removing last Comma and wrapping with curly brackets",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "{$1}",
                  "rule": "(.*),"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 15
        },
        {
          "id": "8c14b190-d052-4f67-86af-961bf3d76e40",
          "rules": [
            {
              "id": "39b06824-1a33-452b-9e08-6538c2e01e91",
              "name": "Replacing \u00a7 with double quotes in order to get a valid JSON",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "text.kvPairs",
                  "replaceNewVal": "\"",
                  "rule": "\\xA7"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 16
        },
        {
          "id": "073c493d-7c22-4a7f-8947-47c5ec624256",
          "rules": [
            {
              "id": "b27b156e-eed5-4f10-b90a-314659c39fe9",
              "name": "reformat kvPairs field back to an escaped JSON string format",
              "description": "",
              "sourceField": "text.kvPairs",
              "parameters": {
                "jsonStringifyParameters": {
                  "destinationField": "text.kvPairs_tmp",
                  "deleteSource": true
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 17
        },
        {
          "id": "86fe5691-23e8-4c53-a47c-0584f0719830",
          "rules": [
            {
              "id": "15a0332f-09ee-47e0-9488-36c267dccfc9",
              "name": "Parse kvPairs_tmp as JSON to root",
              "description": "",
              "sourceField": "text.kvPairs_tmp",
              "parameters": {
                "jsonParseParameters": {
                  "destinationField": "text",
                  "deleteSource": true,
                  "escapedValue": null,
                  "overrideDest": false
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 18
        }
      ],
      "order": 4
    },
    {
      "id": "b6935286-8d00-43b6-af20-e0119680ca2f",
      "name": "topipaddress",
      "description": "topipaddress",
      "creator": "toorfthu@amazon.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "aws"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "2eda845a-5175-4f5b-a0e1-d91ba74a3546",
          "rules": [
            {
              "id": "52172fce-6389-4655-9c6f-fbda9ecbe3d4",
              "name": "critical errors",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text",
                  "rule": "awsRegion(?P<region>(\\S*))\\s.*sourceIPAddress:(?P<IpAddress>(\\S*))\\s.*errorCode:(?P<error_code>(\\S*))"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 5
    },
    {
      "id": "49578641-7497-4645-a28e-f844177c82bc",
      "name": "refined-parsingrule",
      "description": "",
      "creator": "toorfthu@amazon.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "aws"
          }
        },
        {
          "subsystemName": {
            "value": "s3.amazonaws.com"
          }
        },
        {
          "severity": {
            "value": "VALUE_WARNING"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "8bbf9991-8f0e-4939-a8a4-5c4e3e4cddce",
          "rules": [
            {
              "id": "ecddaf38-eeec-46df-a57e-1ace33a2d5f3",
              "name": "useful-extraction",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "parseParameters": {
                  "destinationField": "text",
                  "rule": "\\b(?P<ip>(?:[0-9]{1,3}\\.){3}[0-9]{1,3})\\b"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 6
    },
    {
      "id": "8ada107e-cfb9-4b63-a64b-b0a86db6bc64",
      "name": "Change Severity of Elb logs",
      "description": "Change Severity of Elb logs",
      "creator": "thulasiram.toorpu@coralogix.com",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [],
      "ruleSubgroups": [
        {
          "id": "c8a81779-502d-4e29-9bec-9d5c2809632a",
          "rules": [
            {
              "id": "d57c3d0a-0821-4220-9670-1eaee0d1f56e",
              "name": "Change Severity of Elb logs",
              "description": "Change Severity of Elb logs",
              "sourceField": "text",
              "parameters": {
                "replaceParameters": {
                  "destinationField": "severity",
                  "replaceNewVal": "ERROR",
                  "rule": ".*(target_status_code|elb_status_code)\":\"[5]\\d{2}\".*"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 7
    },
    {
      "id": "e5dbaec0-f405-4bb7-9235-b34482b6dd26",
      "name": "parsing rule for sample application",
      "description": "parsing rule for sample application",
      "creator": "",
      "enabled": true,
      "hidden": false,
      "ruleMatchers": [
        {
          "applicationName": {
            "value": "cs-app"
          }
        },
        {
          "applicationName": {
            "value": "sample"
          }
        },
        {
          "subsystemName": {
            "value": "cs-app"
          }
        },
        {
          "subsystemName": {
            "value": "sample"
          }
        }
      ],
      "ruleSubgroups": [
        {
          "id": "41f86963-0f00-4666-a8a1-7a212fff9201",
          "rules": [
            {
              "id": "d4010dfb-1b58-4e62-a3e2-7c902c0aa02b",
              "name": "extract json log",
              "description": "",
              "sourceField": "text",
              "parameters": {
                "extractParameters": {
                  "rule": "message\\s*:s*(?P<bytes>\\d+)\\s*.*?status\\sis\\s(?P<status>\\[^\"]+)"
                }
              },
              "enabled": true,
              "order": 1
            }
          ],
          "enabled": true,
          "order": 1
        }
      ],
      "order": 8
    }
  ],
  "count": 8,
  "resource_identifiers": [
    "Cloudtrail rules",
    "remove fields",
    "Severity Rules",
    "k8s Opentelemetry parsing",
    "topipaddress",
    "refined-parsingrule",
    "Change Severity of Elb logs",
    "parsing rule for sample application"
  ]
}